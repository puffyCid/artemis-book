<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title></title>
        <meta name="robots" content="noindex" />


        <!-- Custom HTML head -->
        
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="./theme/catppuccin.css">
        <link rel="stylesheet" href="./theme/catppuccin-highlight.css">

    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="index.html">Introduction</a></li><li class="chapter-item expanded affix "><li class="part-title">Artemis User Guide</li><li class="chapter-item expanded "><a href="artemis/installation.html"><strong aria-hidden="true">1.</strong> Installation</a></li><li class="chapter-item expanded "><a href="artemis/cli.html"><strong aria-hidden="true">2.</strong> CLI</a></li><li class="chapter-item expanded "><a href="artemis/privileges.html"><strong aria-hidden="true">3.</strong> Privileges</a></li><li class="chapter-item expanded affix "><li class="part-title">Collections</li><li class="chapter-item expanded "><a href="collections/overview.html"><strong aria-hidden="true">4.</strong> Overview</a></li><li class="chapter-item expanded "><a href="collections/format.html"><strong aria-hidden="true">5.</strong> Format</a></li><li class="chapter-item expanded "><a href="collections/output.html"><strong aria-hidden="true">6.</strong> Output</a></li><li class="chapter-item expanded "><a href="collections/uploads.html"><strong aria-hidden="true">7.</strong> Uploads</a></li><li class="chapter-item expanded affix "><li class="part-title">Artifacts</li><li class="chapter-item expanded "><a href="artifacts/overview.html"><strong aria-hidden="true">8.</strong> Overview</a></li><li class="chapter-item expanded "><a href="artifacts/windows.html"><strong aria-hidden="true">9.</strong> Windows</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="artifacts/windows/amcache.html"><strong aria-hidden="true">9.1.</strong> Amcache</a></li><li class="chapter-item expanded "><a href="artifacts/windows/bits.html"><strong aria-hidden="true">9.2.</strong> Bits</a></li><li class="chapter-item expanded "><a href="artifacts/windows/eventlogs.html"><strong aria-hidden="true">9.3.</strong> EventLogs</a></li><li class="chapter-item expanded "><a href="artifacts/windows/files.html"><strong aria-hidden="true">9.4.</strong> Files</a></li><li class="chapter-item expanded "><a href="artifacts/windows/jumplists.html"><strong aria-hidden="true">9.5.</strong> Jumplists</a></li><li class="chapter-item expanded "><a href="artifacts/windows/pe.html"><strong aria-hidden="true">9.6.</strong> PE</a></li><li class="chapter-item expanded "><a href="artifacts/windows/prefetch.html"><strong aria-hidden="true">9.7.</strong> Prefetch</a></li><li class="chapter-item expanded "><a href="artifacts/windows/processes.html"><strong aria-hidden="true">9.8.</strong> Processes</a></li><li class="chapter-item expanded "><a href="artifacts/windows/rawfiles.html"><strong aria-hidden="true">9.9.</strong> RawFiles</a></li><li class="chapter-item expanded "><a href="artifacts/windows/recyclebin.html"><strong aria-hidden="true">9.10.</strong> RecycleBin</a></li><li class="chapter-item expanded "><a href="artifacts/windows/registry.html"><strong aria-hidden="true">9.11.</strong> Registry</a></li><li class="chapter-item expanded "><a href="artifacts/windows/tasks.html"><strong aria-hidden="true">9.12.</strong> Scheduled Tasks</a></li><li class="chapter-item expanded "><a href="artifacts/windows/search.html"><strong aria-hidden="true">9.13.</strong> Search</a></li><li class="chapter-item expanded "><a href="artifacts/windows/services.html"><strong aria-hidden="true">9.14.</strong> Services</a></li><li class="chapter-item expanded "><a href="artifacts/windows/shellbags.html"><strong aria-hidden="true">9.15.</strong> Shellbags</a></li><li class="chapter-item expanded "><a href="artifacts/windows/shimcache.html"><strong aria-hidden="true">9.16.</strong> Shimcache</a></li><li class="chapter-item expanded "><a href="artifacts/windows/shimdb.html"><strong aria-hidden="true">9.17.</strong> Shimdb</a></li><li class="chapter-item expanded "><a href="artifacts/windows/shortcuts.html"><strong aria-hidden="true">9.18.</strong> Shortcuts</a></li><li class="chapter-item expanded "><a href="artifacts/windows/srum.html"><strong aria-hidden="true">9.19.</strong> SRUM</a></li><li class="chapter-item expanded "><a href="artifacts/windows/systeminfo.html"><strong aria-hidden="true">9.20.</strong> SystemInfo</a></li><li class="chapter-item expanded "><a href="artifacts/windows/userassist.html"><strong aria-hidden="true">9.21.</strong> Userassist</a></li><li class="chapter-item expanded "><a href="artifacts/windows/users.html"><strong aria-hidden="true">9.22.</strong> Users</a></li><li class="chapter-item expanded "><a href="artifacts/windows/usnjrnl.html"><strong aria-hidden="true">9.23.</strong> UsnJrnl</a></li></ol></li><li class="chapter-item expanded "><a href="artifacts/macos.html"><strong aria-hidden="true">10.</strong> macOS</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="artifacts/macos/cron.html"><strong aria-hidden="true">10.1.</strong> Cron</a></li><li class="chapter-item expanded "><a href="artifacts/macos/emond.html"><strong aria-hidden="true">10.2.</strong> Emond</a></li><li class="chapter-item expanded "><a href="artifacts/macos/execpolicy.html"><strong aria-hidden="true">10.3.</strong> ExecPolicy</a></li><li class="chapter-item expanded "><a href="artifacts/macos/files.html"><strong aria-hidden="true">10.4.</strong> Files</a></li><li class="chapter-item expanded "><a href="artifacts/macos/fsevents.html"><strong aria-hidden="true">10.5.</strong> FsEvents</a></li><li class="chapter-item expanded "><a href="artifacts/macos/groups.html"><strong aria-hidden="true">10.6.</strong> Groups</a></li><li class="chapter-item expanded "><a href="artifacts/macos/launchd.html"><strong aria-hidden="true">10.7.</strong> Launchd</a></li><li class="chapter-item expanded "><a href="artifacts/macos/loginitems.html"><strong aria-hidden="true">10.8.</strong> LoginItems</a></li><li class="chapter-item expanded "><a href="artifacts/macos/macho.html"><strong aria-hidden="true">10.9.</strong> Macho</a></li><li class="chapter-item expanded "><a href="artifacts/macos/plist.html"><strong aria-hidden="true">10.10.</strong> Plist</a></li><li class="chapter-item expanded "><a href="artifacts/macos/processes.html"><strong aria-hidden="true">10.11.</strong> Processes</a></li><li class="chapter-item expanded "><a href="artifacts/macos/shellhistory.html"><strong aria-hidden="true">10.12.</strong> ShellHistory</a></li><li class="chapter-item expanded "><a href="artifacts/macos/sudo.html"><strong aria-hidden="true">10.13.</strong> Sudo</a></li><li class="chapter-item expanded "><a href="artifacts/macos/systeminfo.html"><strong aria-hidden="true">10.14.</strong> SystemInfo</a></li><li class="chapter-item expanded "><a href="artifacts/macos/unifiedlogs.html"><strong aria-hidden="true">10.15.</strong> UnifiedLogs</a></li><li class="chapter-item expanded "><a href="artifacts/macos/users.html"><strong aria-hidden="true">10.16.</strong> Users</a></li></ol></li><li class="chapter-item expanded "><a href="artifacts/linux.html"><strong aria-hidden="true">11.</strong> Linux</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="artifacts/linux/cron.html"><strong aria-hidden="true">11.1.</strong> Cron</a></li><li class="chapter-item expanded "><a href="artifacts/linux/elf.html"><strong aria-hidden="true">11.2.</strong> ELF</a></li><li class="chapter-item expanded "><a href="artifacts/linux/files.html"><strong aria-hidden="true">11.3.</strong> Files</a></li><li class="chapter-item expanded "><a href="artifacts/linux/journals.html"><strong aria-hidden="true">11.4.</strong> Journals</a></li><li class="chapter-item expanded "><a href="artifacts/linux/logons.html"><strong aria-hidden="true">11.5.</strong> Logons</a></li><li class="chapter-item expanded "><a href="artifacts/linux/processes.html"><strong aria-hidden="true">11.6.</strong> Processes</a></li><li class="chapter-item expanded "><a href="artifacts/linux/shellhistory.html"><strong aria-hidden="true">11.7.</strong> ShellHistory</a></li><li class="chapter-item expanded "><a href="artifacts/linux/sudo.html"><strong aria-hidden="true">11.8.</strong> Sudo</a></li><li class="chapter-item expanded "><a href="artifacts/linux/systeminfo.html"><strong aria-hidden="true">11.9.</strong> SystemInfo</a></li></ol></li><li class="chapter-item expanded "><a href="artifacts/applications.html"><strong aria-hidden="true">12.</strong> Applications</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="artifacts/applications/chromium.html"><strong aria-hidden="true">12.1.</strong> Chromium</a></li><li class="chapter-item expanded "><a href="artifacts/applications/firefox.html"><strong aria-hidden="true">12.2.</strong> Firefox</a></li><li class="chapter-item expanded "><a href="artifacts/applications/safari.html"><strong aria-hidden="true">12.3.</strong> Safari</a></li></ol></li><li class="chapter-item expanded "><li class="part-title">Scripting</li><li class="chapter-item expanded "><a href="scripting/deno.html"><strong aria-hidden="true">13.</strong> Deno</a></li><li class="chapter-item expanded "><a href="scripting/typescript.html"><strong aria-hidden="true">14.</strong> TypeScript</a></li><li class="chapter-item expanded "><a href="scripting/bundling.html"><strong aria-hidden="true">15.</strong> Bundling</a></li><li class="chapter-item expanded "><a href="scripting/scripts.html"><strong aria-hidden="true">16.</strong> Scripts</a></li><li class="chapter-item expanded "><a href="scripting/filterscripts.html"><strong aria-hidden="true">17.</strong> Filter Scripts</a></li><li class="chapter-item expanded "><a href="scripting/limitations.html"><strong aria-hidden="true">18.</strong> Limitations</a></li><li class="chapter-item expanded affix "><li class="part-title">Library</li><li class="chapter-item expanded "><a href="core/overview.html"><strong aria-hidden="true">19.</strong> Overview</a></li><li class="chapter-item expanded affix "><li class="part-title">Examples</li><li class="chapter-item expanded "><a href="examples/execution.html"><strong aria-hidden="true">20.</strong> Execution</a></li><li class="chapter-item expanded "><a href="examples/triage.html"><strong aria-hidden="true">21.</strong> Triage</a></li><li class="chapter-item expanded "><a href="examples/live_response.html"><strong aria-hidden="true">22.</strong> Live Response</a></li><li class="chapter-item expanded "><a href="examples/file_listings.html"><strong aria-hidden="true">23.</strong> File Listings</a></li><li class="chapter-item expanded "><a href="examples/scripts.html"><strong aria-hidden="true">24.</strong> Scripts</a></li><li class="chapter-item expanded affix "><li class="part-title">Development</li><li class="chapter-item expanded "><a href="development/overview.html"><strong aria-hidden="true">25.</strong> Overview</a></li><li class="chapter-item expanded "><a href="development/building.html"><strong aria-hidden="true">26.</strong> Building</a></li><li class="chapter-item expanded "><a href="development/adding.html"><strong aria-hidden="true">27.</strong> Adding Features</a></li><li class="chapter-item expanded "><a href="development/testing.html"><strong aria-hidden="true">28.</strong> Testing</a></li><li class="chapter-item expanded "><a href="development/learning.html"><strong aria-hidden="true">29.</strong> Learning</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="latte">Latte</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="frappe">Frappé</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="macchiato">Macchiato</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="mocha">Mocha</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title"></h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="introduction"><a class="header" href="#introduction">Introduction</a></h1>
<p><strong>Artemis</strong> is a powerful command line digital forensic and incident response
(DFIR) tool that collects forensic data from Windows, macOS, and Linux
endpoints. Its primary focus is: speed, ease of use, and low resource usage.<br />
Notable features <em>so far</em>:</p>
<ul>
<li>Setup collections using basic TOML files</li>
<li>Parsing support for large amount of forensic artifacts (25+)</li>
<li>Output to JSON or JSONL file(s)</li>
<li>Can output results to local system or upload to cloud services.</li>
<li>Embedded JavaScript runtime via <a href="https://deno.land/">Deno</a></li>
<li>Can be used as a library via <a href="./core/overview.html">artemis-core</a></li>
<li>MIT license</li>
</ul>
<p>The goal of this book is to provide a comprehensive guide on how to use
<code>artemis</code> and <code>artemis-core</code>.</p>
<h1 id="has-this-been-tested-on-real-incidents"><a class="header" href="#has-this-been-tested-on-real-incidents">Has this been tested on real incidents?</a></h1>
<p><strong>NO</strong></p>
<p><code>artemis</code> is a new forensic tool written from scratch and it has not been tested
in any production environment. It does however have an extensive test suite and
has been carefully developed to make sure the data it produces is accurate.</p>
<p>If you are looking for a free and open-source forensic tool to lead an
investigation, two (2) great options are:</p>
<ul>
<li>The cross platform forensic tool
<a href="https://docs.velociraptor.app/">Velociprator</a></li>
<li>Windows only but still excellent
<a href="https://ericzimmerman.github.io/#!index.md">Zimmerman tools</a></li>
</ul>
<p>During the development of <code>artemis</code> both of these tools were used to provide
verification that the output of <code>artemis</code> is correct.<br />
If you looking are for free and open-source forensic tool to add to your
forensic toolkit or to casually review forensic data or compare the results of
other forensic tools then <code>artemis</code> is a great option.</p>
<p>Over time as <code>artemis</code> matures, bugs are found and fixed, and feeback is given
this statement will be updated when <code>artemis</code> ready to lead real world
investigations.</p>
<h1 id="artemis-vs-artemis-core"><a class="header" href="#artemis-vs-artemis-core">artemis vs artemis-core</a></h1>
<p><code>artemis</code> is an executable that can be executed on Windows, macOS, or Linux
systems.<br />
<code>artemis-core</code> is a library that can be imported to an application to parse
forensic data. <code>artemis</code> imports the <code>artemis-core</code> library to perform all of
its forensic parsing.</p>
<h1 id="contributing"><a class="header" href="#contributing">Contributing</a></h1>
<p>You can find the source code on <a href="https://github.com/puffycid/artemis">GitHub</a>.
If you find a bug feel free to open an issue. If you would like to contribute,
<strong>please</strong> read the
<a href="https://github.com/puffycid/artemis/blob/main/CONTRIBUTING.md">CONTRIBUTING</a>
guide prior to starting.</p>
<h1 id="license"><a class="header" href="#license">License</a></h1>
<p><a href="https://github.com/puffycid/artemis">artemis</a>,
<a href="https://github.com/puffycid/artemis-api">artemis-api</a>,
<a href="https://github.com/puffycid/artemis-scripts">artemis-scripts</a>, and this book
are released under the MIT License</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="installation"><a class="header" href="#installation">Installation</a></h1>
<p>Currently only Windows, macOS, and Linux binaries from
<a href="https://github.com/puffycid/artemis">GitHub Releases</a> are provided. For now
these binaries are unsigned. Any other binaries from 3rd party services
(crates.io, Homebrew, Chocolatey, etc) are unofficial. Support for additional
distribution services may be considered in the future.</p>
<h2 id="supported-systems"><a class="header" href="#supported-systems">Supported Systems</a></h2>
<p>Currently <code>artemis</code> has been tested on the following types of systems:</p>
<ul>
<li>Windows 8.1 and higher. Arch: 64-bit</li>
<li>macOS Catalina and higher. Arch: 64-bit and ARM</li>
<li>Ubuntu, Fedora, Arch Linux. Arch: 64-bit and ARM</li>
</ul>
<p>If you would like support for another OS or architecture please open an issue.</p>
<h2 id="github-releases"><a class="header" href="#github-releases">GitHub Releases</a></h2>
<p>Once downloaded for you platform from GitHub, extract the binary from the
archive and you should be able to start collecting forensic data!</p>
<h2 id="build-from-source"><a class="header" href="#build-from-source">Build from Source</a></h2>
<p>You may also build artemis from <a href="https://github.com/puffycid/artemis">source</a>.
In order build artemis you will need to install the Rust programming langague.<br />
Instructions to install Rust can be found on the
<a href="https://www.rust-lang.org/">Rust Homepage</a>.</p>
<p>Once <code>Rust</code> is installed you can download the source code for artemis using
<code>git</code>:</p>
<pre><code>git clone https://github.com/puffycid/artemis
</code></pre>
<p>Navigate to your downloaded repo and run:</p>
<pre><code>cargo build
</code></pre>
<p>By default cargo builds a <code>debug</code> version of the binary. If you want to build
the <code>release</code> version (<strong>recommended</strong>) of the binary run:</p>
<pre><code>cargo build --release
</code></pre>
<p>The <code>release</code> version will be <strong>much</strong> faster and smaller than the <code>debug</code>
version. The compiled binary will be located at:</p>
<ul>
<li><code>&lt;path to artemis repo&gt;\target\debug\artemis</code> for the debug version</li>
<li><code>&lt;path to artemis repo&gt;\target\release\artemis</code> for the release version</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="cli-options"><a class="header" href="#cli-options">CLI Options</a></h1>
<p><code>artemis</code> is designed to have a very simple CLI menu. Almost all of the code is
in the <code>artemis-core</code> library. In fact the only things the <code>artemis</code> binary does
is:</p>
<ul>
<li>Provide the TOML collection file/data to the <code>artemis-core</code> library.</li>
<li>Provide CLI args</li>
</ul>
<h1 id="running-artemis"><a class="header" href="#running-artemis">Running Artemis</a></h1>
<p>Once you have <a href="artemis/./installation.html">installed</a> <code>artemis</code> you can access its help
menu with the command below:</p>
<pre><code>artemis -h
Usage: artemis [OPTIONS]

Options:
  -t, --toml &lt;TOML&gt;              Full path to TOML collector
  -d, --decode &lt;DECODE&gt;          Base64 encoded TOML file
  -j, --javascript &lt;JAVASCRIPT&gt;  Full path to JavaScript file
  -h, --help                     Print help
  -V, --version                  Print version
</code></pre>
<p>As mentioned, the <code>artemis</code> binary is really just a small wrapper that provides
a TOML collection definition to <code>artemis-core</code>. There are two (2) ways to
provided TOML collections:</p>
<ul>
<li>Provide the full path the TOML file on disk</li>
<li>base64 encode a TOML file and provide that as an argument</li>
</ul>
<p>The <code>artemis</code> source code provides several pre-made TOML collection files that
can used as examples.</p>
<p>For example on <strong>macOS</strong> we downloaded the
<a href="https://github.com/puffycid/artemis/blob/main/artemis-core/tests/test_data/macos/processes.toml">processes.toml</a>
file from the <code>artemis</code> repo to the same directory as the <strong>macOS</strong> <code>artemis</code>
binary and ran using <strong>sudo</strong></p>
<pre><code>sudo ./artemis -t processes.toml
[artemis] Starting artemis collection!
[artemis] Finished artemis collection!
</code></pre>
<p>On <strong>Windows</strong> we downloaded the
<a href="https://github.com/puffycid/artemis/blob/main/artemis-core/tests/test_data/windows/processes.toml">processes.toml</a>
file from the <code>artemis</code> repo to the same directory as the <strong>Windows</strong> <code>artemis</code>
binary and ran using <strong>Administrator</strong> privileges</p>
<pre><code>artemis.exe -t processes.toml
[artemis] Starting artemis collection!
[artemis] Finished artemis collection!
</code></pre>
<p>Both <code>processes.toml</code> files tell <code>artemis</code> to output the results to a directory
called <code>tmp/process_collection</code> in the current directory and output using
<code>jsonl</code> format</p>
<pre><code>./tmp
└── process_collection
    └── d7f89e7b-fcd8-42e8-8769-6fe7eaf58bee.jsonl
</code></pre>
<p>To run the same collection except as a base64 encoded string on <strong>macOS</strong> we can
do the following:</p>
<pre><code>sudo ./artemis -d c3lzdGVtID0gIm1hY29zIgoKW291dHB1dF0KbmFtZSA9ICJwcm9jZXNzX2NvbGxlY3Rpb24iCmRpcmVjdG9yeSA9ICIuL3RtcCIKZm9ybWF0ID0gImpzb25sIgpjb21wcmVzcyA9IGZhbHNlCmVuZHBvaW50X2lkID0gImFiZGMiCmNvbGxlY3Rpb25faWQgPSAxCm91dHB1dCA9ICJsb2NhbCIKCltbYXJ0aWZhY3RzXV0KYXJ0aWZhY3RfbmFtZSA9ICJwcm9jZXNzZXMiICMgTmFtZSBvZiBhcnRpZmFjdApbYXJ0aWZhY3RzLnByb2Nlc3Nlc10KbWV0YWRhdGEgPSB0cnVlICMgR2V0IGV4ZWN1dGFibGUgbWV0YWRhdGEKbWQ1ID0gdHJ1ZSAjIE1ENSBhbGwgZmlsZXMKc2hhMSA9IGZhbHNlICMgU0hBMSBhbGwgZmlsZXMKc2hhMjU2ID0gZmFsc2UgIyBTSEEyNTYgYWxsIGZpbGVz
[artemis] Starting artemis collection!
[artemis] Finished artemis collection!
</code></pre>
<p>On <strong>Windows</strong> it would be (using <strong>Administrator</strong> privileges again):</p>
<pre><code>artemis.exe -d c3lzdGVtID0gIndpbmRvd3MiCgpbb3V0cHV0XQpuYW1lID0gInByb2Nlc3Nlc19jb2xsZWN0aW9uIgpkaXJlY3RvcnkgPSAiLi90bXAiCmZvcm1hdCA9ICJqc29uIgpjb21wcmVzcyA9IGZhbHNlCmVuZHBvaW50X2lkID0gImFiZGMiCmNvbGxlY3Rpb25faWQgPSAxCm91dHB1dCA9ICJsb2NhbCIKCltbYXJ0aWZhY3RzXV0KYXJ0aWZhY3RfbmFtZSA9ICJwcm9jZXNzZXMiICMgTmFtZSBvZiBhcnRpZmFjdApbYXJ0aWZhY3RzLnByb2Nlc3Nlc10KbWV0YWRhdGEgPSB0cnVlICMgR2V0IGV4ZWN1dGFibGUgbWV0YWRhdGEKbWQ1ID0gdHJ1ZSAjIE1ENSBhbGwgZmlsZXMKc2hhMSA9IGZhbHNlICMgU0hBMSBhbGwgZmlsZXMKc2hhMjU2ID0gZmFsc2UgIyBTSEEyNTYgYWxsIGZpbGVz
[artemis] Starting artemis collection!
[artemis] Finished artemis collection!
</code></pre>
<h1 id="javascript"><a class="header" href="#javascript">JavaScript</a></h1>
<p>You can also execute JavaScript code using <code>artemis</code>.</p>
<pre><code class="language-javascript">// https://raw.githubusercontent.com/puffycid/artemis-api/master/src/windows/processes.ts
function getWinProcesses(md5, sha1, sha256, pe_info) {
  const hashes = {
    md5,
    sha1,
    sha256,
  };
  const data = Deno.core.ops.get_processes(
    JSON.stringify(hashes),
    pe_info,
  );
  const results = JSON.parse(data);
  return results;
}

// main.ts
function main() {
  const md5 = false;
  const sha1 = false;
  const sha256 = false;
  const pe_info = false;
  const proc_list = getWinProcesses(md5, sha1, sha256, pe_info);
  console.log(proc_list[0].full_path);
  return proc_list;
}
main();
</code></pre>
<p>Executing the above code</p>
<pre><code>sudo ./artemis -j ../../artemis-core/tests/test_data/deno_scripts/vanilla.js
[artemis] Starting artemis collection!
[runtime]: &quot;/usr/libexec/nesessionmanager&quot;
[artemis] Finished artemis collection!
</code></pre>
<p>See section on <a href="artemis/../scripting/deno.html">Scripting</a> to learn more!</p>
<div style="break-before: page; page-break-before: always;"></div><h2 id="why-does-artemis-need-elevated-privileges"><a class="header" href="#why-does-artemis-need-elevated-privileges">Why does artemis need elevated privileges?</a></h2>
<p>The goal for <code>artemis</code> is to parse endpoint forensic artifacts. Many of these
artifacts can only be accessed with elevated privileges. If you try running
<code>artemis</code> as a standard user, depending on what you want to collect you will
encounter permission errors.</p>
<p>The <code>artemis-core</code> library <strong>does not</strong> and <strong>will never</strong>
<em>directly</em><sup>*</sup> modify anything on disk. It only writes results to a file
if specified in the TOML collection.</p>
<h2 id="-modifying-data"><a class="header" href="#-modifying-data"><sup>*</sup> Modifying data</a></h2>
<p>The main goal of most endpoint based live forensic tools is to collect data and
not change anything on the endpoint. By not directly modifying files on disk we
can accomplish most of this goal.</p>
<p><em>However</em>, simply running a program on a computer can cause indirect changes to
the OS that are outside of our control. Some of these indirect changes can
include:</p>
<ul>
<li>Allocating and deallocting memory</li>
<li>Logs generated by the OS when an application is executed</li>
<li>Analytics generated by the OS when an application is executed</li>
<li>Access timestamps are changed when opening a file for reading</li>
</ul>
<p>Despite these indirect changes we should still be comfortable that the endpoint
data collected by the <code>artemis-core</code> library was not directly modified by
<code>artemis-core</code> and if we run a different program that program should get the
same results as <code>artemis-core</code> (disregarding any changes made by the OS)</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="collection-overview"><a class="header" href="#collection-overview">Collection Overview</a></h1>
<p>In order to collect forensic data <code>artemis</code> needs a <a href="https://toml.io/en/">TOML</a>
collection that defines what data should be collected. This TOML collection can
either be a file or a base64 encoded TOML file.</p>
<p>The core parts of a TOML collection are:</p>
<ul>
<li>The target OS (Windows, macOS, or Linux)</li>
<li>The output configuration such as output and format type</li>
<li>A list of artifacts to collect</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="format"><a class="header" href="#format">Format</a></h1>
<p>An example TOML collection is provided below:</p>
<pre><code class="language-toml">system = &quot;windows&quot;

[output]
name = &quot;amcache_collection&quot;
directory = &quot;./tmp&quot;
format = &quot;json&quot;
compress = false
endpoint_id = &quot;6c51b123-1522-4572-9f2a-0bd5abd81b82&quot;
collection_id = 1
output = &quot;local&quot;
url = &quot;&quot;
api_key = &quot;&quot;
filter_name = &quot;&quot;
filter_script = &quot;&quot;
logging = &quot;warn&quot;

[[artifacts]]
artifact_name = &quot;amcache&quot;
filter = true
[artifacts.amcache]
# Optional
# alt_drive = 'C'
</code></pre>
<ul>
<li><code>system</code> Defines what OS this collection targets. This example targets
<code>windows</code> systems. This collection will only run with the Windows version of
<code>artemis</code></li>
<li><code>[output]</code> Defines the output configuration
<ul>
<li><code>name</code> The output name. This can be any string value</li>
<li><code>directory</code> The directory where the output should be written. This example
outputs to a directory called <code>tmp</code> in the current working directory</li>
<li><code>format</code> The output format can be either <code>json</code> or <code>jsonl</code></li>
<li><code>compress</code> Whether to compress the output with <code>gzip</code> compression. Once the
collection is complete the output directory will be compressed with <code>zip</code>
compression.</li>
<li><code>endpoint_id</code> An ID assigned to the endpoint. This can be any string value</li>
<li><code>collection_id</code> A number assigned to the collection. This can be any postive
number</li>
<li><code>output</code> The output type. Supports: <code>local, gcp, aws, or azure</code></li>
<li><code>url</code> The URL associated with either <code>gcp, aws, or azure</code>. This is required
only if using <strong>remote upload</strong> output</li>
<li><code>api_key</code> The API key associated with either <code>gcp, aws, or azure</code>. This is
required only if using <strong>remote upload</strong> output</li>
<li><code>filter_name</code> The name of the provided <code>filter_script</code>. This is <strong>optional</strong>
but if you are using a <code>filter_script</code> you should provide a name. Otherwise
the default name <code>UnknownFilterName</code> is used</li>
<li><code>filter_script</code> An advanced <strong>optional</strong> output option, will pass the
results of each <code>[[artifacts]]</code> entry into a script. See
<a href="collections/../scripting/deno.html">scripting</a> section for detailed overview of this
option.</li>
<li><code>logging</code> Set the logging level for artemis. This is <strong>optional</strong> by default
<code>artemis</code> will log errors and warnings. Valid options are:
<code>warn, error, debug, or info</code></li>
</ul>
</li>
<li><code>[[artifacts]]</code> A list of artifacts to collect
<ul>
<li><code>artifact_name</code> Name of aritfact</li>
<li><code>filter</code> Whether to filter the artifact data through the <code>filter_script</code>.
This is <strong>optional</strong> by default nothing is filtered</li>
<li><code>[aritfacts.amcache]</code> Artifact configuration parameters
<ul>
<li><code>alt_drive</code> Use an alternative drive when collecting data. This parameter
is optional</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>The example above collects one (1) artifact (<code>Amcache</code>) on a Windows system and
outputs the results the local system at the path <code>./tmp/amcache_collection</code></p>
<p>If we wanted to collect more than one (1) artifact we could use a collection
like the one below:</p>
<pre><code class="language-toml">system = &quot;windows&quot;

[output]
name = &quot;execution_collection&quot;
directory = &quot;./tmp&quot;
format = &quot;jsonl&quot;
compress = false
endpoint_id = &quot;6c51b123-1522-4572-9f2a-0bd5abd81b82&quot;
collection_id = 1
output = &quot;local&quot;

[[artifacts]]
artifact_name = &quot;amcache&quot;
[artifacts.amcache]

[[artifacts]]
artifact_name = &quot;shortcuts&quot;
[artifacts.shortcuts]
path = &quot;C:\\ProgramData\\Microsoft\\Windows\\Start Menu\\Programs\\Startup&quot;
</code></pre>
<p>The TOML collection above collects both <code>amcache</code> and <code>shortcuts</code> data on a
Windows system and outputs the results to the local system at the path
<code>./tmp/execution_collection</code>.<br />
Notable changes:<br />
<code>name</code> our collection is now named <code>execution_collection</code></p>
<pre><code class="language-toml">[[artifacts]]
artifact_name = &quot;amcache&quot;
[artifacts.amcache]
</code></pre>
<p>Since the <code>alt_drive</code> parameter is optional for <code>amcache</code> we do not need to
specifiy it</p>
<pre><code class="language-toml">[[artifacts]]
artifact_name = &quot;shortcuts&quot;
[artifacts.shortcuts]
path = &quot;C:\\ProgramData\\Microsoft\\Windows\\Start Menu\\Programs\\Startup&quot;
</code></pre>
<ul>
<li><code>[[artifacts]]</code> The second entry in our list of artifacts to collect
<ul>
<li><code>artifact_name</code> Name of aritfact</li>
<li><code>[aritfacts.shortcuts]</code> Artifact configuration parameters
<ul>
<li><code>path</code> Use the provided path to collect <code>shortcuts</code> data. This parameter
is <strong>required</strong></li>
</ul>
</li>
</ul>
</li>
</ul>
<p>Since <code>[[artifacts]]</code> is a list we can even provide the same artifact multiple
times:</p>
<pre><code class="language-toml">[[artifacts]]
artifact_name = &quot;shortcuts&quot;
[artifacts.shortcuts]
path = &quot;C:\\ProgramData\\Microsoft\\Windows\\Start Menu\\Programs\\Startup&quot;

[[artifacts]]
artifact_name = &quot;shortcuts&quot;
[artifacts.shortcuts]
path = &quot;D:\\ProgramData\\Microsoft\\Windows\\Start Menu\\Programs\\Startup&quot;

[[artifacts]]
artifact_name = &quot;shortcuts&quot;
[artifacts.shortcuts]
path = &quot;E:\\Users\\rust\\Downloads&quot;
</code></pre>
<p>However, providing the same artifact mutliple times can be repetitive. See the
chapter on <a href="collections/../scripting/deno.html">scripting</a> to see how we can automate and
enhance artifact collection using <code>artemis</code> and a tiny amount of <code>JavaScript</code>!</p>
<p>Finally you can review the full list of all supported artifacts and their
configuration under the <a href="collections/../artifacts/overview.html">artifact</a> chapter</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="artemis-output-formats"><a class="header" href="#artemis-output-formats">Artemis Output Formats</a></h1>
<p><code>artemis</code> supports two (2) types of output formats:
<a href="https://jsonlines.org/"><code>jsonl</code></a> and <code>json</code>. Both types will output the results
using a random uuid for the filename such as
<code>68330d32-c35e-4d43-8655-1cb5e9d90b83.json</code></p>
<p>When you run <code>artemis</code> three (3) types of files will be generated:</p>
<ul>
<li><code>&lt;uuuid&gt;.{json or jsonl}</code> a unique filename dependent on the format selected.
These files contain the artifact data output. Depending on the collection
multiple <code>&lt;uuuid&gt;.{json or jsonl}</code> files will be created</li>
<li><code>&lt;uuid&gt;.log</code> a log file containing any errors or warnings generated by
<code>artemis</code> during the collection. Only one (1) per collection will exist</li>
<li><code>status.log</code> a log file that maps the <code>&lt;uuuid&gt;.{json or jsonl}</code> to an artifact
name. <code>&lt;uuuid&gt;.{json or jsonl}</code> also contains the artifact name. The
<code>status.log</code> provides a quick way to see what files contain a specific
artifact. Only one (1) per collection will exist</li>
</ul>
<p>The <code>json</code> output from the <code>amcache</code> TOML collection from the previous page
would look like the following:</p>
<pre><code class="language-json">{
  &quot;metadata&quot;: {
    &quot;endpoint_id&quot;: &quot;6c51b123-1522-4572-9f2a-0bd5abd81b82&quot;,
    &quot;id&quot;: 1,
    &quot;uuid&quot;: &quot;41bc55e4-bc7b-4798-8808-4351092595a5&quot;,
    &quot;artifact_name&quot;: &quot;amcache&quot;,
    &quot;complete_time&quot;: 1680466070,
    &quot;start_time&quot;: 1680466065,
    &quot;hostname&quot;: &quot;DESKTOP-UQQDFT8&quot;,
    &quot;os_version&quot;: &quot;11 (22000)&quot;,
    &quot;platform&quot;: &quot;Windows&quot;,
    &quot;kernel_version&quot;: &quot;22000&quot;,
    &quot;load_performance&quot;: {
      &quot;avg_one_min&quot;: 0.0,
      &quot;avg_five_min&quot;: 0.0,
      &quot;avg_fifteen_min&quot;: 0.0
    }
  },
  &quot;data&quot;: [
    {
      &quot;first_execution&quot;: 1641252583,
      &quot;path&quot;: &quot;c:\\program files (x86)\\windows kits\\10\\debuggers\\x86\\1394\\1394kdbg.sys&quot;,
      &quot;name&quot;: &quot;1394kdbg.sys&quot;,
      &quot;original_name&quot;: &quot;1394dbg.sys&quot;,
      &quot;version&quot;: &quot;10.0.19041.685 (winbuild.160101.0800)&quot;,
      &quot;binary_type&quot;: &quot;pe32_i386&quot;,
      &quot;product_version&quot;: &quot;10.0.19041.685&quot;,
      &quot;product_name&quot;: &quot;microsoft® windows® operating system&quot;,
      &quot;language&quot;: &quot;&quot;,
      &quot;file_id&quot;: &quot;&quot;,
      &quot;link_date&quot;: &quot;10/28/2087 21:21:59&quot;,
      &quot;path_hash&quot;: &quot;1394kdbg.sys|2912931c5988cc06&quot;,
      &quot;program_id&quot;: &quot;00a68cd0bda5b35cd2f03e8556cad622f00000904&quot;,
      &quot;size&quot;: &quot;38352&quot;,
      &quot;publisher&quot;: &quot;microsoft corporation&quot;,
      &quot;usn&quot;: &quot;4010442296&quot;,
      &quot;sha1&quot;: &quot;&quot;,
      &quot;reg_path&quot;: &quot;{11517B7C-E79D-4e20-961B-75A811715ADD}\\Root\\InventoryApplicationFile\\1394kdbg.sys|2912931c5988cc06&quot;
    }
  ]
}
</code></pre>
<p>All artifacts parsed by <code>artemis</code> will be formatted similar to the output above.</p>
<ul>
<li><code>metadata</code> object that contains metadata about the system. All artifacts will
contain a metadata object
<ul>
<li><code>endpoint_id</code> The ID associated with the endpoint. This is from the <code>TOML</code>
input</li>
<li><code>id</code> The ID associated with the collection. This is from the <code>TOML</code> input</li>
<li><code>uuid</code> Unique ID associated with the output</li>
<li><code>artifact_name</code> The name of the artifact collected. This is from the <code>TOML</code>
input</li>
<li><code>complete_time</code> The time <code>artemis</code> completed parsing the data</li>
<li><code>start_time</code> The time <code>artemis</code> started parsing the data</li>
<li><code>hostname</code> The hostname of the endpoint</li>
<li><code>os_version</code> Thes OS version of the endpoint</li>
<li><code>platform</code> The platform of the endpoint. Ex: Windows or macOS</li>
<li><code>kernel_version</code> The kernel version of the endpoint</li>
<li><code>load_performance</code> The endpoint performance for one, five, and fifteen
minutes. On Windows these values are always zero
<ul>
<li><code>avg_one_min</code> Average load performance for one minute</li>
<li><code>avg_five_mine</code> Average load performance for five minutes</li>
<li><code>avg_fifteen_min</code> Average load performance for fifteen minutes</li>
</ul>
</li>
</ul>
</li>
<li><code>data</code> object that contains the artifact specific data. See the
<a href="collections/../artifacts/overview.html">artifact</a> chapter for output structure for each
artifact. If you execute <code>JavaScript</code> you can control what the <code>data</code> value
is. For example you can return a string instead of an object. <code>artemis</code> uses
serde to serialize the final output</li>
</ul>
<p>This data would be saved in a <code>&lt;uuid&gt;.json</code> file</p>
<p>The <code>jsonl</code> output from the <code>amcache</code> TOML collection from the previous page
would look like the following:</p>
<pre><code class="language-jsonl">{&quot;metadata&quot;:{&quot;endpoint_id&quot;:&quot;6c51b123-1522-4572-9f2a-0bd5abd81b82&quot;,&quot;id&quot;:1,&quot;artifact_name&quot;:&quot;amcache&quot;,&quot;complete_time&quot;:1680467122,&quot;start_time&quot;:1680467120,&quot;hostname&quot;:&quot;DESKTOP-UQQDFT8&quot;,&quot;os_version&quot;:&quot;11 (22000)&quot;,&quot;platform&quot;:&quot;Windows&quot;,&quot;kernel_version&quot;:&quot;22000&quot;,&quot;load_performance&quot;:{&quot;avg_one_min&quot;:0.0,&quot;avg_five_min&quot;:0.0,&quot;avg_fifteen_min&quot;:0.0},&quot;uuid&quot;:&quot;64702816-0f24-4e6e-a72a-118cb51c55b4&quot;},&quot;data&quot;:{&quot;first_execution&quot;:1641252583,&quot;path&quot;:&quot;c:\\program files (x86)\\windows kits\\10\\debuggers\\x86\\1394\\1394kdbg.sys&quot;,&quot;name&quot;:&quot;1394kdbg.sys&quot;,&quot;original_name&quot;:&quot;1394dbg.sys&quot;,&quot;version&quot;:&quot;10.0.19041.685 (winbuild.160101.0800)&quot;,&quot;binary_type&quot;:&quot;pe32_i386&quot;,&quot;product_version&quot;:&quot;10.0.19041.685&quot;,&quot;product_name&quot;:&quot;microsoft® windows® operating system&quot;,&quot;language&quot;:&quot;&quot;,&quot;file_id&quot;:&quot;&quot;,&quot;link_date&quot;:&quot;10/28/2087 21:21:59&quot;,&quot;path_hash&quot;:&quot;1394kdbg.sys|2912931c5988cc06&quot;,&quot;program_id&quot;:&quot;00a68cd0bda5b35cd2f03e8556cad622f00000904&quot;,&quot;size&quot;:&quot;38352&quot;,&quot;publisher&quot;:&quot;microsoft corporation&quot;,&quot;usn&quot;:&quot;4010442296&quot;,&quot;sha1&quot;:&quot;&quot;,&quot;reg_path&quot;:&quot;{11517B7C-E79D-4e20-961B-75A811715ADD}\\Root\\InventoryApplicationFile\\1394kdbg.sys|2912931c5988cc06&quot;}}
{&quot;metadata&quot;:{&quot;endpoint_id&quot;:&quot;6c51b123-1522-4572-9f2a-0bd5abd81b82&quot;,&quot;id&quot;:1,&quot;artifact_name&quot;:&quot;amcache&quot;,&quot;complete_time&quot;:1680467122,&quot;start_time&quot;:1680467120,&quot;hostname&quot;:&quot;DESKTOP-UQQDFT8&quot;,&quot;os_version&quot;:&quot;11 (22000)&quot;,&quot;platform&quot;:&quot;Windows&quot;,&quot;kernel_version&quot;:&quot;22000&quot;,&quot;load_performance&quot;:{&quot;avg_one_min&quot;:0.0,&quot;avg_five_min&quot;:0.0,&quot;avg_fifteen_min&quot;:0.0},&quot;uuid&quot;:&quot;5afa02eb-1e11-48a0-993e-3bb852667db7&quot;},&quot;data&quot;:{&quot;first_execution&quot;:1641252583,&quot;path&quot;:&quot;c:\\program files (x86)\\windows kits\\10\\debuggers\\x64\\1394\\1394kdbg.sys&quot;,&quot;name&quot;:&quot;1394kdbg.sys&quot;,&quot;original_name&quot;:&quot;1394dbg.sys&quot;,&quot;version&quot;:&quot;10.0.19041.685 (winbuild.160101.0800)&quot;,&quot;binary_type&quot;:&quot;pe64_amd64&quot;,&quot;product_version&quot;:&quot;10.0.19041.685&quot;,&quot;product_name&quot;:&quot;microsoft® windows® operating system&quot;,&quot;language&quot;:&quot;&quot;,&quot;file_id&quot;:&quot;&quot;,&quot;link_date&quot;:&quot;11/30/2005 17:06:22&quot;,&quot;path_hash&quot;:&quot;1394kdbg.sys|7e05880d5bf9d27b&quot;,&quot;program_id&quot;:&quot;00a68cd0bda5b35cd2f03e8556cad622f00000904&quot;,&quot;size&quot;:&quot;47568&quot;,&quot;publisher&quot;:&quot;microsoft corporation&quot;,&quot;usn&quot;:&quot;4010568800&quot;,&quot;sha1&quot;:&quot;&quot;,&quot;reg_path&quot;:&quot;{11517B7C-E79D-4e20-961B-75A811715ADD}\\Root\\InventoryApplicationFile\\1394kdbg.sys|7e05880d5bf9d27b&quot;}}
...
{&quot;metadata&quot;:{&quot;endpoint_id&quot;:&quot;6c51b123-1522-4572-9f2a-0bd5abd81b82&quot;,&quot;id&quot;:1,&quot;artifact_name&quot;:&quot;amcache&quot;,&quot;complete_time&quot;:1680467122,&quot;start_time&quot;:1680467120,&quot;hostname&quot;:&quot;DESKTOP-UQQDFT8&quot;,&quot;os_version&quot;:&quot;11 (22000)&quot;,&quot;platform&quot;:&quot;Windows&quot;,&quot;kernel_version&quot;:&quot;22000&quot;,&quot;load_performance&quot;:{&quot;avg_one_min&quot;:0.0,&quot;avg_five_min&quot;:0.0,&quot;avg_fifteen_min&quot;:0.0},&quot;uuid&quot;:&quot;bce5fccc-9f13-40cd-bebd-95a32ead119a&quot;},&quot;data&quot;:{&quot;first_execution&quot;:1641252542,&quot;path&quot;:&quot;c:\\program files\\git\\mingw64\\bin\\ziptool.exe&quot;,&quot;name&quot;:&quot;ziptool.exe&quot;,&quot;original_name&quot;:&quot;&quot;,&quot;version&quot;:&quot;&quot;,&quot;binary_type&quot;:&quot;pe64_amd64&quot;,&quot;product_version&quot;:&quot;&quot;,&quot;product_name&quot;:&quot;&quot;,&quot;language&quot;:&quot;&quot;,&quot;file_id&quot;:&quot;&quot;,&quot;link_date&quot;:&quot;01/01/1970 00:00:00&quot;,&quot;path_hash&quot;:&quot;ziptool.exe|7269435f129e6e01&quot;,&quot;program_id&quot;:&quot;01286cf3cc5f1d161abf355f10fee583c0000ffff&quot;,&quot;size&quot;:&quot;162258&quot;,&quot;publisher&quot;:&quot;&quot;,&quot;usn&quot;:&quot;3869400664&quot;,&quot;sha1&quot;:&quot;&quot;,&quot;reg_path&quot;:&quot;{11517B7C-E79D-4e20-961B-75A811715ADD}\\Root\\InventoryApplicationFile\\ziptool.exe|7269435f129e6e01&quot;}}
{&quot;metadata&quot;:{&quot;endpoint_id&quot;:&quot;6c51b123-1522-4572-9f2a-0bd5abd81b82&quot;,&quot;id&quot;:1,&quot;artifact_name&quot;:&quot;amcache&quot;,&quot;complete_time&quot;:1680467122,&quot;start_time&quot;:1680467120,&quot;hostname&quot;:&quot;DESKTOP-UQQDFT8&quot;,&quot;os_version&quot;:&quot;11 (22000)&quot;,&quot;platform&quot;:&quot;Windows&quot;,&quot;kernel_version&quot;:&quot;22000&quot;,&quot;load_performance&quot;:{&quot;avg_one_min&quot;:0.0,&quot;avg_five_min&quot;:0.0,&quot;avg_fifteen_min&quot;:0.0},&quot;uuid&quot;:&quot;8437907f-53a4-43a2-8ff4-22acb3d06d72&quot;},&quot;data&quot;:{&quot;first_execution&quot;:1641252542,&quot;path&quot;:&quot;c:\\program files\\git\\usr\\bin\\[.exe&quot;,&quot;name&quot;:&quot;[.exe&quot;,&quot;original_name&quot;:&quot;&quot;,&quot;version&quot;:&quot;&quot;,&quot;binary_type&quot;:&quot;pe64_amd64&quot;,&quot;product_version&quot;:&quot;&quot;,&quot;product_name&quot;:&quot;&quot;,&quot;language&quot;:&quot;&quot;,&quot;file_id&quot;:&quot;&quot;,&quot;link_date&quot;:&quot;01/01/1970 00:00:00&quot;,&quot;path_hash&quot;:&quot;[.exe|b6eac39997c90239&quot;,&quot;program_id&quot;:&quot;01286cf3cc5f1d161abf355f10fee583c0000ffff&quot;,&quot;size&quot;:&quot;68322&quot;,&quot;publisher&quot;:&quot;&quot;,&quot;usn&quot;:&quot;3870610520&quot;,&quot;sha1&quot;:&quot;&quot;,&quot;reg_path&quot;:&quot;{11517B7C-E79D-4e20-961B-75A811715ADD}\\Root\\InventoryApplicationFile\\[.exe|b6eac39997c90239&quot;}}
</code></pre>
<p>The <code>jsonl</code> output is identical to <code>json</code> with the following differences:</p>
<ul>
<li>The values in <code>data</code> are split into separate lines instead of an array</li>
<li>The <code>uuid</code> is unique for each <code>json</code> line</li>
</ul>
<p>This data would be saved in a <code>&lt;uuid&gt;.jsonl</code> file</p>
<p>The <code>&lt;uuid&gt;.log</code> output from a collection contains any errors or warnings
encountered during the collection. </p>
<p>The <code>status.log</code> output from a collection maps the <code>&lt;uuuid&gt;.{json or jsonl}</code> to
an artifact name. A possible example from the macOS <code>UnifiedLogs</code></p>
<pre><code>unifiedlogs:d45221df-349b-4467-b726-a9446865b259.json
unifiedlogs:eccd7b5b-4941-4134-a790-b073eb992188.json
</code></pre>
<p>As mentioned and seen above you can also check the actual
<code>&lt;uuid&gt;.{json or jsonl}</code> files to find the <code>artifact_name</code></p>
<h1 id="compression"><a class="header" href="#compression">Compression</a></h1>
<p>If you choose to enable compression for the output <code>artemis</code> will compress each
<code>&lt;uuid&gt;.{json or jsonl}</code> using <code>gzip</code> compression. The files will be saved as
<code>&lt;uuid&gt;.{json or jsonl}.gz</code>. The log files are not compressed.</p>
<p>Once the collection is complete <code>artemis</code> will compress the whole output
directory into a <code>zip</code> file and remove the output directory. Leaving only the
<code>zip</code> file.</p>
<p>Since <code>artemis</code> is running using elevated privileges it uses a cautious approach
to deleting its data:</p>
<ul>
<li>It gets a list of files in its output directory and deletes files one at a
time that end in: json, jsonl, gz, or log</li>
<li>Once all output files are deleted, it will delete the empty directory.</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="remote-uploads"><a class="header" href="#remote-uploads">Remote Uploads</a></h1>
<p><code>artemis</code> has basic support for uploading collections to three (3) external
cloud services:</p>
<ol>
<li>Google Cloud Platform (GCP)</li>
<li>Microsoft Azure</li>
<li>Amazon Web Services (AWS)</li>
</ol>
<p>Uploading collections to a remote serivce requires three (3) steps:</p>
<ol>
<li>Name of remote service. Valid options are: <code>&quot;gcp&quot;, &quot;azure&quot;, &quot;aws&quot;</code></li>
<li>URL to the remote service</li>
<li>A base64 encoded API key formatted based on the remote service select in
step 1.</li>
</ol>
<p>An example TOML Collection is below:</p>
<pre><code class="language-toml">system = &quot;windows&quot;

[output]
name = &quot;shimcache_collection&quot;
directory = &quot;hostname&quot;
format = &quot;json&quot;
compress = true
endpoint_id = &quot;6c51b123-1522-4572-9f2a-0bd5abd81b82&quot;
collection_id = 1
output = &quot;gcp&quot;
url = &quot;https://storage.googleapis.com/upload/storage/v1/b/&lt;INSERT BUCKET NAME&gt;&quot; # Make sure to include GCP Bucket name
api_key = &quot;ewogICJ0eXBlIjogInNlcnZpY2VfYWNjb3VudCIsCiAgInByb2plY3RfaWQiOiAiZmFrZW1lIiwKICAicHJpdmF0ZV9rZXlfaWQiOiAiZmFrZW1lIiwKICAicHJpdmF0ZV9rZXkiOiAiLS0tLS1CRUdJTiBQUklWQVRFIEtFWS0tLS0tXG5NSUlFdndJQkFEQU5CZ2txaGtpRzl3MEJBUUVGQUFTQ0JLa3dnZ1NsQWdFQUFvSUJBUUM3VkpUVXQ5VXM4Y0tqTXpFZll5amlXQTRSNC9NMmJTMUdCNHQ3TlhwOThDM1NDNmRWTXZEdWljdEdldXJUOGpOYnZKWkh0Q1N1WUV2dU5Nb1NmbTc2b3FGdkFwOEd5MGl6NXN4alptU25YeUNkUEVvdkdoTGEwVnpNYVE4cytDTE95UzU2WXlDRkdlSlpxZ3R6SjZHUjNlcW9ZU1c5YjlVTXZrQnBaT0RTY3RXU05HajNQN2pSRkRPNVZvVHdDUUFXYkZuT2pEZkg1VWxncDJQS1NRblNKUDNBSkxRTkZOZTdicjFYYnJoVi8vZU8rdDUxbUlwR1NEQ1V2M0UwRERGY1dEVEg5Y1hEVFRsUlpWRWlSMkJ3cFpPT2tFL1owL0JWbmhaWUw3MW9aVjM0YktmV2pRSXQ2Vi9pc1NNYWhkc0FBU0FDcDRaVEd0d2lWdU5kOXR5YkFnTUJBQUVDZ2dFQkFLVG1qYVM2dGtLOEJsUFhDbFRRMnZwei9ONnV4RGVTMzVtWHBxYXNxc2tWbGFBaWRnZy9zV3FwalhEYlhyOTNvdElNTGxXc00rWDBDcU1EZ1NYS2VqTFMyang0R0RqSTFaVFhnKyswQU1KOHNKNzRwV3pWRE9mbUNFUS83d1hzMytjYm5YaEtyaU84WjAzNnE5MlFjMStOODdTSTM4bmtHYTBBQkg5Q044M0htUXF0NGZCN1VkSHp1SVJlL21lMlBHaElxNVpCemo2aDNCcG9QR3pFUCt4M2w5WW1LOHQvMWNOMHBxSStkUXdZZGdmR2phY2tMdS8ycUg4ME1DRjdJeVFhc2VaVU9KeUtyQ0x0U0QvSWl4di9oekRFVVBmT0NqRkRnVHB6ZjNjd3RhOCtvRTR3SENvMWlJMS80VGxQa3dtWHg0cVNYdG13NGFRUHo3SURRdkVDZ1lFQThLTlRoQ08yZ3NDMkk5UFFETS84Q3cwTzk4M1dDRFkrb2krN0pQaU5BSnd2NURZQnFFWkIxUVlkajA2WUQxNlhsQy9IQVpNc01rdTFuYTJUTjBkcml3ZW5RUVd6b2V2M2cyUzdnUkRvUy9GQ0pTSTNqSitramd0YUE3UW16bGdrMVR4T0ROK0cxSDkxSFc3dDBsN1ZuTDI3SVd5WW8ycVJSSzNqenhxVWlQVUNnWUVBeDBvUXMycmVCUUdNVlpuQXBEMWplcTduNE12TkxjUHZ0OGIvZVU5aVV2Nlk0TWowU3VvL0FVOGxZWlhtOHViYnFBbHd6MlZTVnVuRDJ0T3BsSHlNVXJ0Q3RPYkFmVkRVQWhDbmRLYUE5Z0FwZ2ZiM3h3MUlLYnVRMXU0SUYxRkpsM1Z0dW1mUW4vL0xpSDFCM3JYaGNkeW8zL3ZJdHRFazQ4UmFrVUtDbFU4Q2dZRUF6VjdXM0NPT2xERGNRZDkzNURkdEtCRlJBUFJQQWxzcFFVbnpNaTVlU0hNRC9JU0xEWTVJaVFIYklIODNENGJ2WHEwWDdxUW9TQlNOUDdEdnYzSFl1cU1oZjBEYWVncmxCdUpsbEZWVnE5cVBWUm5LeHQxSWwySGd4T0J2YmhPVCs5aW4xQnpBK1lKOTlVekM4NU8wUXowNkErQ210SEV5NGFaMmtqNWhIakVDZ1lFQW1OUzQrQThGa3NzOEpzMVJpZUsyTG5pQnhNZ21ZbWwzcGZWTEtHbnptbmc3SDIrY3dQTGhQSXpJdXd5dFh5d2gyYnpic1lFZll4M0VvRVZnTUVwUGhvYXJRbllQdWtySk80Z3dFMm81VGU2VDVtSlNaR2xRSlFqOXE0WkIyRGZ6ZXQ2SU5zSzBvRzhYVkdYU3BRdlFoM1JVWWVrQ1pRa0JCRmNwcVdwYklFc0NnWUFuTTNEUWYzRkpvU25YYU1oclZCSW92aWM1bDB4RmtFSHNrQWpGVGV2Tzg2RnN6MUMyYVNlUktTcUdGb09RMHRtSnpCRXMxUjZLcW5ISW5pY0RUUXJLaEFyZ0xYWDR2M0NkZGpmVFJKa0ZXRGJFL0NrdktaTk9yY2YxbmhhR0NQc3BSSmoyS1VrajFGaGw5Q25jZG4vUnNZRU9OYndRU2pJZk1Qa3Z4Ris4SFE9PVxuLS0tLS1FTkQgUFJJVkFURSBLRVktLS0tLVxuIiwKICAiY2xpZW50X2VtYWlsIjogImZha2VAZ3NlcnZpY2VhY2NvdW50LmNvbSIsCiAgImNsaWVudF9pZCI6ICJmYWtlbWUiLAogICJhdXRoX3VyaSI6ICJodHRwczovL2FjY291bnRzLmdvb2dsZS5jb20vby9vYXV0aDIvYXV0aCIsCiAgInRva2VuX3VyaSI6ICJodHRwczovL29hdXRoMi5nb29nbGVhcGlzLmNvbS90b2tlbiIsCiAgImF1dGhfcHJvdmlkZXJfeDUwOV9jZXJ0X3VybCI6ICJodHRwczovL3d3dy5nb29nbGVhcGlzLmNvbS9vYXV0aDIvdjEvY2VydHMiLAogICJjbGllbnRfeDUwOV9jZXJ0X3VybCI6ICJodHRwczovL3d3dy5nb29nbGVhcGlzLmNvbS9yb2JvdC92MS9tZXRhZGF0YS94NTA5L2Zha2VtZSIsCiAgInVuaXZlcnNlX2RvbWFpbiI6ICJnb29nbGVhcGlzLmNvbSIKfQo=&quot;

[[artifacts]]
artifact_name = &quot;shimcache&quot;
[artifacts.shimcache]
</code></pre>
<h1 id="warning"><a class="header" href="#warning">WARNING</a></h1>
<p>Currently <code>artemis</code> does not securely protect the remote API key. Make sure the
account associated with the API has only permissions needed by <code>artemis</code>. The
only permission(s) <code>artemis</code> requires is the ability create/write data to a
bucket.<br />
In addition, make sure the account only has access to a dedicated bucket for
<code>artemis</code>.<br />
For example:</p>
<ol>
<li>Create a bucket called <code>artemis-uploads</code></li>
<li>Create an an account called <code>artemis-uploader</code> and generate an API key</li>
<li>Only allow the account <code>artemis-uploader</code> to upload data to
<code>artemis-uploads</code>. It has no other access.</li>
</ol>
<p>If you do not want to expose the remote API key, you can output the data to a
local directory, network share, or external drive. Then upload the data using an
alternative tool.</p>
<h1 id="gcp"><a class="header" href="#gcp">GCP</a></h1>
<p>The GCP upload process is based on the upload process Velociraptor uses
<a href="https://velociraptor.velocidex.com/triage-with-velociraptor-pt-3-d6f63215f579">https://velociraptor.velocidex.com/triage-with-velociraptor-pt-3-d6f63215f579</a>.</p>
<p>High Level Steps:</p>
<ol>
<li>Create a bucket. Make sure the bucket is <strong>not</strong> public. This bucket will
hold the data uploaded by <code>artemis</code>.</li>
<li>Create a service account with no permissions.</li>
<li>Create and download the service account key. This should be a JSON file.</li>
<li>Assign the service account access to the newly created bucket. The service
account should only need <strong>Storage Object Creator</strong></li>
<li>Base64 encode the service account JSON file</li>
<li>Create TOML collection and use
<code>https://storage.googleapis.com/upload/storage/v1/b/&lt;BUCKETNAME&gt;</code> for your
<code>url</code>. Use the base64 encoded string from step 5 as your <code>api_key</code></li>
<li>Execute <code>artemis</code> and provide TOML collection as either file or base64
encoded argument</li>
<li>Delete the service account key once you are done collecting data using
<code>artemis</code></li>
</ol>
<p>An example TOML Collection is below:</p>
<pre><code class="language-toml">system = &quot;windows&quot;

[output]
name = &quot;shimcache_collection&quot;
directory = &quot;dev-workstations&quot;
format = &quot;jsonl&quot;
compress = true
endpoint_id = &quot;6c51b123-1522-4572-9f2a-0bd5abd81b82&quot;
collection_id = 1
output = &quot;gcp&quot;
url = &quot;https://storage.googleapis.com/upload/storage/v1/b/shimcache-gcp-bucket&quot; # Make sure to include GCP Bucket name
api_key = &quot;ewogICJ0eXBlIjogInNlcnZpY2VfYWNjb3VudCIsCiAgInByb2plY3RfaWQiOiAiZmFrZW1lIiwKICAicHJpdmF0ZV9rZXlfaWQiOiAiZmFrZW1lIiwKICAicHJpdmF0ZV9rZXkiOiAiLS0tLS1CRUdJTiBQUklWQVRFIEtFWS0tLS0tXG5NSUlFdndJQkFEQU5CZ2txaGtpRzl3MEJBUUVGQUFTQ0JLa3dnZ1NsQWdFQUFvSUJBUUM3VkpUVXQ5VXM4Y0tqTXpFZll5amlXQTRSNC9NMmJTMUdCNHQ3TlhwOThDM1NDNmRWTXZEdWljdEdldXJUOGpOYnZKWkh0Q1N1WUV2dU5Nb1NmbTc2b3FGdkFwOEd5MGl6NXN4alptU25YeUNkUEVvdkdoTGEwVnpNYVE4cytDTE95UzU2WXlDRkdlSlpxZ3R6SjZHUjNlcW9ZU1c5YjlVTXZrQnBaT0RTY3RXU05HajNQN2pSRkRPNVZvVHdDUUFXYkZuT2pEZkg1VWxncDJQS1NRblNKUDNBSkxRTkZOZTdicjFYYnJoVi8vZU8rdDUxbUlwR1NEQ1V2M0UwRERGY1dEVEg5Y1hEVFRsUlpWRWlSMkJ3cFpPT2tFL1owL0JWbmhaWUw3MW9aVjM0YktmV2pRSXQ2Vi9pc1NNYWhkc0FBU0FDcDRaVEd0d2lWdU5kOXR5YkFnTUJBQUVDZ2dFQkFLVG1qYVM2dGtLOEJsUFhDbFRRMnZwei9ONnV4RGVTMzVtWHBxYXNxc2tWbGFBaWRnZy9zV3FwalhEYlhyOTNvdElNTGxXc00rWDBDcU1EZ1NYS2VqTFMyang0R0RqSTFaVFhnKyswQU1KOHNKNzRwV3pWRE9mbUNFUS83d1hzMytjYm5YaEtyaU84WjAzNnE5MlFjMStOODdTSTM4bmtHYTBBQkg5Q044M0htUXF0NGZCN1VkSHp1SVJlL21lMlBHaElxNVpCemo2aDNCcG9QR3pFUCt4M2w5WW1LOHQvMWNOMHBxSStkUXdZZGdmR2phY2tMdS8ycUg4ME1DRjdJeVFhc2VaVU9KeUtyQ0x0U0QvSWl4di9oekRFVVBmT0NqRkRnVHB6ZjNjd3RhOCtvRTR3SENvMWlJMS80VGxQa3dtWHg0cVNYdG13NGFRUHo3SURRdkVDZ1lFQThLTlRoQ08yZ3NDMkk5UFFETS84Q3cwTzk4M1dDRFkrb2krN0pQaU5BSnd2NURZQnFFWkIxUVlkajA2WUQxNlhsQy9IQVpNc01rdTFuYTJUTjBkcml3ZW5RUVd6b2V2M2cyUzdnUkRvUy9GQ0pTSTNqSitramd0YUE3UW16bGdrMVR4T0ROK0cxSDkxSFc3dDBsN1ZuTDI3SVd5WW8ycVJSSzNqenhxVWlQVUNnWUVBeDBvUXMycmVCUUdNVlpuQXBEMWplcTduNE12TkxjUHZ0OGIvZVU5aVV2Nlk0TWowU3VvL0FVOGxZWlhtOHViYnFBbHd6MlZTVnVuRDJ0T3BsSHlNVXJ0Q3RPYkFmVkRVQWhDbmRLYUE5Z0FwZ2ZiM3h3MUlLYnVRMXU0SUYxRkpsM1Z0dW1mUW4vL0xpSDFCM3JYaGNkeW8zL3ZJdHRFazQ4UmFrVUtDbFU4Q2dZRUF6VjdXM0NPT2xERGNRZDkzNURkdEtCRlJBUFJQQWxzcFFVbnpNaTVlU0hNRC9JU0xEWTVJaVFIYklIODNENGJ2WHEwWDdxUW9TQlNOUDdEdnYzSFl1cU1oZjBEYWVncmxCdUpsbEZWVnE5cVBWUm5LeHQxSWwySGd4T0J2YmhPVCs5aW4xQnpBK1lKOTlVekM4NU8wUXowNkErQ210SEV5NGFaMmtqNWhIakVDZ1lFQW1OUzQrQThGa3NzOEpzMVJpZUsyTG5pQnhNZ21ZbWwzcGZWTEtHbnptbmc3SDIrY3dQTGhQSXpJdXd5dFh5d2gyYnpic1lFZll4M0VvRVZnTUVwUGhvYXJRbllQdWtySk80Z3dFMm81VGU2VDVtSlNaR2xRSlFqOXE0WkIyRGZ6ZXQ2SU5zSzBvRzhYVkdYU3BRdlFoM1JVWWVrQ1pRa0JCRmNwcVdwYklFc0NnWUFuTTNEUWYzRkpvU25YYU1oclZCSW92aWM1bDB4RmtFSHNrQWpGVGV2Tzg2RnN6MUMyYVNlUktTcUdGb09RMHRtSnpCRXMxUjZLcW5ISW5pY0RUUXJLaEFyZ0xYWDR2M0NkZGpmVFJKa0ZXRGJFL0NrdktaTk9yY2YxbmhhR0NQc3BSSmoyS1VrajFGaGw5Q25jZG4vUnNZRU9OYndRU2pJZk1Qa3Z4Ris4SFE9PVxuLS0tLS1FTkQgUFJJVkFURSBLRVktLS0tLVxuIiwKICAiY2xpZW50X2VtYWlsIjogImZha2VAZ3NlcnZpY2VhY2NvdW50LmNvbSIsCiAgImNsaWVudF9pZCI6ICJmYWtlbWUiLAogICJhdXRoX3VyaSI6ICJodHRwczovL2FjY291bnRzLmdvb2dsZS5jb20vby9vYXV0aDIvYXV0aCIsCiAgInRva2VuX3VyaSI6ICJodHRwczovL29hdXRoMi5nb29nbGVhcGlzLmNvbS90b2tlbiIsCiAgImF1dGhfcHJvdmlkZXJfeDUwOV9jZXJ0X3VybCI6ICJodHRwczovL3d3dy5nb29nbGVhcGlzLmNvbS9vYXV0aDIvdjEvY2VydHMiLAogICJjbGllbnRfeDUwOV9jZXJ0X3VybCI6ICJodHRwczovL3d3dy5nb29nbGVhcGlzLmNvbS9yb2JvdC92MS9tZXRhZGF0YS94NTA5L2Zha2VtZSIsCiAgInVuaXZlcnNlX2RvbWFpbiI6ICJnb29nbGVhcGlzLmNvbSIKfQo=&quot;

[[artifacts]]
artifact_name = &quot;shimcache&quot;
[artifacts.shimcache]
</code></pre>
<h1 id="azure"><a class="header" href="#azure">Azure</a></h1>
<p>The Azure upload process is based on the Azure Blob upload process Velociraptor
uses
<a href="https://docs.velociraptor.app/docs/offline_triage/remote_uploads/">https://docs.velociraptor.app/docs/offline_triage/remote_uploads</a>.</p>
<p>High level steps:</p>
<ol>
<li>Create a Storage Account</li>
<li>Create a Container under the new Storage Account</li>
<li>Add a Role Assignment to the Storage Account</li>
<li>Generate a Shared Access Signature (SAS) Policy for the created Container in
step 2. Make sure to only allow create and write access</li>
<li>Copy the Blob SAS URL</li>
<li>Create a TOML collection and use the Blob SAS URL for the <code>url</code> option</li>
<li>Execute <code>artemis</code> and provide TOML collection as either file or base64
encoded argument</li>
</ol>
<p>An example TOML Collection is below:</p>
<pre><code class="language-toml">system = &quot;windows&quot;

[output]
name = &quot;shimcache_collection&quot;
directory = &quot;dev-workstations&quot;
format = &quot;jsonl&quot;
compress = true
endpoint_id = &quot;6c51b123-1522-4572-9f2a-0bd5abd81b82&quot;
collection_id = 1
output = &quot;gcp&quot;
url = &quot;https://uploadertest.blob.core.windows.net/uploads?sp=cw.....&quot; # Make sure to you copied the Blob SAS URL

[[artifacts]]
artifact_name = &quot;shimcache&quot;
[artifacts.shimcache]
</code></pre>
<h1 id="aws"><a class="header" href="#aws">AWS</a></h1>
<p>The AWS upload is based on the upload process Velociraptor uses
<a href="https://docs.velociraptor.app/blog/2020/2020-07-14-triage-with-velociraptor-pt-4-cf0e60810d1e/">https://docs.velociraptor.app/blog/2020/2020-07-14-triage-with-velociraptor-pt-4-cf0e60810d1e</a></p>
<p>High level steps:</p>
<ol>
<li>Create a S3 bucket. Make sure the bucket is <strong>not</strong> public. This bucket will
hold the data uploaded by <code>artemis</code>.</li>
<li>Create a new user. This user does <strong>not</strong> need access to the AWS Console</li>
<li>Create a new policy.
<ul>
<li>Only S3 PutObject permission is required</li>
<li>Limit the policy to only apply to the created bucket in step 1.</li>
</ul>
</li>
<li>Create a new User Group. Add user created in step 2. Apply policy created in
Step 3.</li>
<li>Create Access Keys for the user created in step 2. Create a JSON blob
formatted like below:</li>
</ol>
<pre><code class="language-json">{
  &quot;bucket&quot;: &quot;yourbucketname&quot;,
  &quot;secret&quot;: &quot;yoursecretfromyouraccount&quot;,
  &quot;key&quot;: &quot;yourkeyfromyouraccount&quot;,
  &quot;region&quot;: &quot;yourbucketregion&quot;
}
</code></pre>
<ol start="6">
<li>Create TOML collection and use <code>https://s3.amazonaws.com</code> for your <code>url</code>.
Base64 encode the JSON blob from step 5 as your <code>api_key</code></li>
<li>Execute <code>artemis</code> and provide TOML collection as either file or base64
encoded argument</li>
<li>Delete the API key once you are done collecting data using <code>artemis</code></li>
</ol>
<p>An example TOML Collection is below:</p>
<pre><code class="language-toml">system = &quot;windows&quot;

[output]
name = &quot;shimcache_collection&quot;
directory = &quot;dev-workstations&quot;
format = &quot;jsonl&quot;
compress = true
endpoint_id = &quot;6c51b123-1522-4572-9f2a-0bd5abd81b82&quot;
collection_id = 1
output = &quot;aws&quot;
url = &quot;https://s3.amazonaws.com&quot;
api_key = &quot;ewogICAgImJ1Y2tldCI6ICJibGFoIiwKICAgICJzZWNyZXQiOiAicGtsNkFpQWFrL2JQcEdPenlGVW9DTC96SW1hSEoyTzVtR3ZzVWxSTCIsCiAgICAia2V5IjogIkFLSUEyT0dZQkFINlRPSUFVSk1SIiwKICAgICJyZWdpb24iOiAidXMtZWFzdC0yIgp9&quot;

[[artifacts]]
artifact_name = &quot;shimcache&quot;
[artifacts.shimcache]
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="artifacts-overview"><a class="header" href="#artifacts-overview">Artifacts Overview</a></h1>
<p><code>artemis</code> supports over 20 different types of artifacts. All of these artifacts
can be collected from a TOML collection or from a simple <code>JavaScript</code> script</p>
<p>A breakdown of artifacts by OS is below.</p>
<div class="table-wrapper"><table><thead><tr><th>OS</th><th>Number of Artifacts</th></tr></thead><tbody>
<tr><td><a href="artifacts/./windows.html">Windows</a></td><td>25</td></tr>
<tr><td><a href="artifacts/./macos.html">macOS</a></td><td>19</td></tr>
<tr><td><a href="artifacts/./linux.html">Linux</a></td><td>11</td></tr>
</tbody></table>
</div><div style="break-before: page; page-break-before: always;"></div><h1 id="windows"><a class="header" href="#windows">Windows</a></h1>
<p>Currently <code>artemis</code> has been tested on Windows 8.1 and higher. <code>artemis</code>
supports multiple complex binary artifacts on Windows such as:</p>
<ul>
<li><code>NTFS</code> - <code>artemis</code> can parse the raw <code>NTFS</code> disk using the
<a href="https://github.com/ColinFinck/ntfs">ntfs</a> crate</li>
<li><code>Registry</code> - <code>artemis</code> can parse <code>Registry</code> files on disk</li>
<li><code>ESE</code> - <code>artemis</code> can parse <code>ESE</code> database files on disk</li>
<li><code>Event Logs</code> - <code>artemis</code> can parse <code>Event Logs</code> using the
<a href="https://github.com/omerbenamram/evtx">evtx</a> crate</li>
</ul>
<p>A main focus point of the library <code>artemis-core</code> is to make a best effort to not
rely on the Windows APIs. Since <code>artemis-core</code> is a forensic focused library, we
do not want to rely on APIs from a potentially compromised system.<br />
However, <code>artemis-core</code> does use the Windows API for a handful of artifacts:</p>
<ul>
<li><code>Processes</code> - The <a href="https://github.com/GuillaumeGomez/sysinfo">sysinfo</a> crate
is used to pull a process listing using Windows APIs</li>
<li><code>Systeminfo</code> - The <a href="https://github.com/GuillaumeGomez/sysinfo">sysinfo</a> crate
is also to get system information using Winodws APIs</li>
<li>The Windows API is also used to decompress proprietary Windows compression
algorithms.
<ul>
<li>Both <code>Prefetch</code> and some <code>NTFS</code> files may be compressed, <code>artemis-core</code> will
attempt to use Windows API to decompress these files</li>
</ul>
</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="amcache"><a class="header" href="#amcache">Amcache</a></h1>
<p>Windows <code>Amcache</code> stores metadata related to execution of Windows applications.
Data is stored in the <code>C:\Windows\appcompat\Programs\Amcache.hve</code> Registry file.
This Registry file also contains other metadata such as OS, hardware, and
application info. However, <code>artemis</code> will only collect data related to the
execution of Windows applications.<br />
The <code>Registry</code> artifact may be used if you want to collect the full <code>Registry</code>
data from <code>Amcache.hve</code>.</p>
<p>Other Parsers:</p>
<ul>
<li><a href="https://docs.velociraptor.app/artifact_references/pages/windows.detection.amcache/">Velociraptor</a></li>
<li><a href="https://ericzimmerman.github.io/#!index.md">AmcacheParser</a></li>
</ul>
<p>References:</p>
<ul>
<li><a href="https://github.com/libyal/dtformats/blob/main/documentation/AMCache%20file%20(AMCache.hve)%20format.asciidoc">Libyal</a></li>
<li><a href="https://www.ssi.gouv.fr/uploads/2019/01/anssi-coriin_2019-analysis_amcache.pdf">ANSSI</a></li>
</ul>
<h1 id="toml-collection"><a class="header" href="#toml-collection">TOML Collection</a></h1>
<pre><code class="language-toml">system = &quot;windows&quot;

[output]
name = &quot;amcache_collection&quot;
directory = &quot;./tmp&quot;
format = &quot;json&quot;
compress = false
endpoint_id = &quot;6c51b123-1522-4572-9f2a-0bd5abd81b82&quot;
collection_id = 1
output = &quot;local&quot;

[[artifacts]]
artifact_name = &quot;amcache&quot;
[artifacts.amcache]
# Optional
# alt_drive = 'D'
</code></pre>
<h1 id="collection-options"><a class="header" href="#collection-options">Collection Options</a></h1>
<ul>
<li><code>alt_drive</code> Expects a single character value. Will use an alternative drive
letter when parsing <code>Amcache</code>. This configuration is <strong>optional</strong>. By default
<code>artemis</code> will use the <code>%systemdrive%</code> value (typically <code>C</code>)</li>
</ul>
<h1 id="output-structure"><a class="header" href="#output-structure">Output Structure</a></h1>
<p>An array of <code>Amcache</code> entries</p>
<pre><code class="language-typescript">export interface Amcache {
  /**Timestamp when the application was first executed in UNIXEPOCH seconds */
  first_execution: number;
  /**Path to application */
  path: string;
  /**Name of application */
  name: string;
  /**Original name of application from PE metadata */
  original_name: string;
  /**Version of application from PE metadata */
  version: string;
  /**Executable type and arch information */
  binary_type: string;
  /**Application product version from PE metadata */
  product_version: string;
  /**Application product name from PE metadata */
  product_name: string;
  /**Application language */
  language: string;
  /**Application file ID. This is also the SHA1 hash */
  file_id: string;
  /**Application linking timestamp as MM/DD/YYYY HH:mm:ss*/
  link_date: string;
  /**Hash of application path */
  path_hash: string;
  /**Program ID associated with the application */
  program_id: string;
  /**Size of application */
  size: string;
  /**Application publisher from PE metadata */
  publisher: string;
  /**Application Update Seqeuence Number (USN) */
  usn: string;
  /**SHA1 hash of the first ~31MBs of the application */
  sha1: string;
  /**Path in the Amcache.hve file */
  reg_path: string;
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="bits"><a class="header" href="#bits">BITS</a></h1>
<p>Windows Background Intelligent Transfer Service (<code>BITS</code>) is a service that
allows applications and users to register jobs to upload/download file(s).<br />
It is commonly used by applications to download updates. Starting on Windows 10
BITS data is stored in an ESE database. Pre-Windows 10 it is stored in a
proprietary binary format<br />
<code>BITS</code> data is stored at <code>C:\ProgramData\Microsoft\Network\Downloader\qmgr.db</code></p>
<p>Other Parsers:</p>
<ul>
<li><a href="https://github.com/fireeye/BitsParser">BitsParser</a></li>
<li><a href="https://github.com/ANSSI-FR/bits_parser">Bits_Parser</a> (Only supports
pre-Windows 10 BITS files)</li>
</ul>
<p>References:</p>
<ul>
<li><a href="https://ss64.com/nt/bitsadmin.html">BitsAdmin</a></li>
<li><a href="https://en.wikipedia.org/wiki/Background_Intelligent_Transfer_Service">Background Intelligrent Transfer Service</a></li>
<li><a href="https://www.mandiant.com/resources/blog/attacker-use-of-windows-background-intelligent-transfer-service">BITS</a></li>
</ul>
<h1 id="toml-collection-1"><a class="header" href="#toml-collection-1">TOML Collection</a></h1>
<pre><code class="language-toml">system = &quot;windows&quot;

[output]
name = &quot;bits_collection&quot;
directory = &quot;./tmp&quot;
format = &quot;json&quot;
compress = false
endpoint_id = &quot;6c51b123-1522-4572-9f2a-0bd5abd81b82&quot;
collection_id = 1
output = &quot;local&quot;

[[artifacts]]
artifact_name = &quot;bits&quot;
[artifacts.bits]
carve = true
# Optional
# alt_path = &quot;D:\\ProgramData\\Microsoft\\Network\\Downloader\\qmgr.db&quot;
</code></pre>
<h1 id="collection-options-1"><a class="header" href="#collection-options-1">Collection Options</a></h1>
<ul>
<li><code>carve</code> Boolean value to carve deleted <code>BITS</code> jobs and files from <code>qmgr.db</code></li>
<li><code>alt_path</code> Use an alternative path to the <code>qmgr.db</code> file. This configuration
is <strong>optional</strong>. By default <code>artemis</code> will use
<code>%systemdrive%\ProgramData\Microsoft\Network\Downloader\qmgr.db</code></li>
</ul>
<h1 id="output-structure-1"><a class="header" href="#output-structure-1">Output Structure</a></h1>
<p>A <code>Bits</code> object that contains an array of jobs and carved jobs and files</p>
<pre><code class="language-typescript">export interface Bits {
  /**Array of data containing BITS info */
  bits: BitsInfo[];
  /**Array of carved jobs */
  carved_jobs: Jobs[];
  /**Array of carved files */
  carved_files: Files[];
}

/**
 * Combination of parsed Jobs and File info from BITS
 */
export interface BitsInfo {
  /**ID for the Job */
  job_id: string;
  /**ID for the File */
  file_id: string;
  /**SID associated with the Job */
  owner_sid: string;
  /**Timestamp when the Job was created in UNIXEPOCH seconds */
  created: number;
  /**Timestamp when the Job was modified in UNIXEPOCH seconds */
  modified: number;
  /**Timestamp when the Job was completed in UNIXEPOCH seconds */
  completed: number;
  /**Timestamp when the Job was expired in UNIXEPOCH seconds */
  expiration: number;
  /**Files associated with the Job */
  files_total: number;
  /**Number of bytes downloaded */
  bytes_downloaded: number;
  /**Number of bytes transferred */
  bytes_transferred: number;
  /**Name associated with Job */
  job_name: string;
  /**Description associated with Job */
  job_description: string;
  /**Commands associated with Job */
  job_command: string;
  /**Arguments associated with Job */
  job_arguments: string;
  /**Error count with the Job */
  error_count: number;
  /**BITS Job type */
  job_type: string;
  /**BITS Job state */
  job_state: string;
  /**Job priority */
  priority: string;
  /**BITS Job flags */
  flags: string;
  /**HTTP Method associated with Job */
  http_method: string;
  /**Full file path associated with Job */
  full_path: string;
  /**Filename associated with Job */
  filename: string;
  /**Target file path associated with Job */
  target_path: string;
  /**TMP file path associated with the JOb */
  tmp_file: string;
  /**Volume path associated with the file */
  volume: string;
  /**URL associated with the Job */
  url: string;
  /**If the BITS info was carved */
  carved: boolean;
  /**Transient error count with Job */
  transient_error_count: number;
  /**Permissions associated with the Job */
  acls: AccessControl[];
  /**Job timeout in seconds */
  timeout: number;
  /**Job retry delay in seconds */
  retry_delay: number;
  /**Additional SIDs associated with Job */
  additional_sids: string[];
}

/**
 * Jobs from BITS
 */
export interface Jobs {
  /**ID for the Job */
  job_id: string;
  /**ID for the File */
  file_id: string;
  /**SID associated with the Job */
  owner_sid: string;
  /**Timestamp when the Job was created in UNIXEPOCH seconds */
  created: number;
  /**Timestamp when the Job was modified in UNIXEPOCH seconds */
  modified: number;
  /**Timestamp when the Job was completed in UNIXEPOCH seconds */
  completed: number;
  /**Timestamp when the Job was expired in UNIXEPOCH seconds */
  expiration: number;
  /**Name associated with Job */
  job_name: string;
  /**Description associated with Job */
  job_description: string;
  /**Commands associated with Job */
  job_command: string;
  /**Arguments associated with Job */
  job_arguments: string;
  /**Error count with the Job */
  error_count: number;
  /**BITS Job type */
  job_type: string;
  /**BITS Job state */
  job_state: string;
  /**Job priority */
  priority: string;
  /**BITS Job flags */
  flags: string;
  /**HTTP Method associated with Job */
  http_method: string;
  /**Transient error count with Job */
  transient_error_count: number;
  /**Permissions associated with the Job */
  acls: AccessControl[];
  /**Job timeout in seconds */
  timeout: number;
  /**Job retry delay in seconds */
  retry_delay: number;
}

/**
 * File(s) associated with Jobs
 */
export interface Files {
  /**ID for the File */
  file_id: string;
  /**Files associated with the JOb */
  files_transferred: number;
  /**Number of bytes downloaded */
  download_bytes_size: number;
  /**Number of bytes transferred */
  trasfer_bytes_size: number;
  /**Fulll file path associated with Job */
  full_path: string;
  /**Filename associated with Job */
  filename: string;
  /**Target file path associated with Job */
  target_path: string;
  /**TMP file path associated with the JOb */
  tmp_file: string;
  /**Volume path associated with the file */
  volume: string;
  /**URL associated with the Job */
  url: string;
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="event-logs"><a class="header" href="#event-logs">Event Logs</a></h1>
<p>Windows <code>Event Logs</code> are the primary files associated with logging system
activity. They are stored in a binary format, typically at
<code>C:\Windows\System32\winevt\Logs</code></p>
<p>Other Parsers:</p>
<ul>
<li><a href="https://docs.velociraptor.app/artifact_references/pages/windows.eventlogs.evtx/">Velociraptor</a></li>
</ul>
<p>References:</p>
<ul>
<li><a href="https://github.com/libyal/libevtx/blob/main/documentation/Windows%20XML%20Event%20Log%20(EVTX).asciidoc">Libyal</a></li>
</ul>
<h1 id="toml-collection-2"><a class="header" href="#toml-collection-2">TOML Collection</a></h1>
<pre><code class="language-toml">system = &quot;windows&quot;

[output]
name = &quot;eventlog_collection&quot;
directory = &quot;./tmp&quot;
format = &quot;json&quot;
compress = false
endpoint_id = &quot;6c51b123-1522-4572-9f2a-0bd5abd81b82&quot;
collection_id = 1
output = &quot;local&quot;

[[artifacts]]
artifact_name = &quot;eventlogs&quot;
[artifacts.eventlogs]
# Optional
# alt_drive = 'C'
</code></pre>
<h1 id="collection-options-2"><a class="header" href="#collection-options-2">Collection Options</a></h1>
<ul>
<li><code>alt_drive</code> Expects a single character value. Will use an alternative drive
letter when parsing <code>Event Logs</code>. This configuration is <strong>optional</strong>. By
default <code>artemis</code> will use the <code>%systemdrive%</code> value (typically <code>C</code>)</li>
</ul>
<h1 id="output-structure-2"><a class="header" href="#output-structure-2">Output Structure</a></h1>
<p>An array of <code>EventLogRecord</code> entries</p>
<pre><code class="language-typescript">export interface EventLogRecord {
  /**Event record number */
  record_id: number;
  /**Timestamp of eventlog message in UNIXEPOCH nanoseconds */
  timestamp: number;
  /**
   * JSON object representation of the Eventlog message
   * Depending on the log the JSON object may have different types of keys
   * Example entry:
   * ```
   * &quot;data&quot;: {
   *     &quot;Event&quot;: {
   *         &quot;#attributes&quot;: {
   *             &quot;xmlns&quot;: &quot;http://schemas.microsoft.com/win/2004/08/events/event&quot;
   *         },
   *         &quot;System&quot;: {
   *            &quot;Provider&quot;: {
   *               &quot;#attributes&quot;: {
   *                   &quot;Name&quot;: &quot;Microsoft-Windows-Bits-Client&quot;,
   *                   &quot;Guid&quot;: &quot;EF1CC15B-46C1-414E-BB95-E76B077BD51E&quot;
   *                 }
   *             },
   *             &quot;EventID&quot;: 3,
   *             &quot;Version&quot;: 3,
   *             &quot;Level&quot;: 4,
   *             &quot;Task&quot;: 0,
   *             &quot;Opcode&quot;: 0,
   *             &quot;Keywords&quot;: &quot;0x4000000000000000&quot;,
   *             &quot;TimeCreated&quot;: {
   *                 &quot;#attributes&quot;: {
   *                   &quot;SystemTime&quot;: &quot;2022-10-31T04:24:19.946430Z&quot;
   *                  }
   *              },
   *             &quot;EventRecordID&quot;: 2,
   *             &quot;Correlation&quot;: null,
   *             &quot;Execution&quot;: {
   *                 &quot;#attributes&quot;: {
   *                     &quot;ProcessID&quot;: 1332,
   *                     &quot;ThreadID&quot;: 780
   *                 }
   *             },
   *             &quot;Channel&quot;: &quot;Microsoft-Windows-Bits-Client/Operational&quot;,
   *             &quot;Computer&quot;: &quot;DESKTOP-EIS938N&quot;,
   *             &quot;Security&quot;: {
   *                 &quot;#attributes&quot;: {
   *                     &quot;UserID&quot;: &quot;S-1-5-18&quot;
   *                 }
   *             }
   *         },
   *         &quot;EventData&quot;: {
   *             &quot;jobTitle&quot;: &quot;Font Download&quot;,
   *             &quot;jobId&quot;: &quot;174718A5-F630-43D9-B378-728240ECE152&quot;,
   *             &quot;jobOwner&quot;: &quot;NT AUTHORITY\\LOCAL SERVICE&quot;,
   *             &quot;processPath&quot;: &quot;C:\\Windows\\System32\\svchost.exe&quot;,
   *             &quot;processId&quot;: 1456,
   *             &quot;ClientProcessStartKey&quot;: 844424930132016
   *         }
   *     }
   * }
   * ```
   */
  data: Record&lt;string, unknown&gt;;
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="files"><a class="header" href="#files">Files</a></h1>
<p>A regular Windows filelisting. <code>artemis</code> uses the
<a href="https://crates.io/crates/walkdir">walkdir</a> crate to recursively walk the files
and directories on the system. If hashing or <code>PE</code> parsing is enabled this will
update the <code>Last Accessed</code> timestamps on files since the native OS APIs are used
to access the files and it will fail on any locked files. Use
<a href="artifacts/windows/./rawfiles.html">RawFiles</a> to bypass locked files.<br />
The standard Rust API does not support getting <code>Changed/Entry Modified</code>
timestamp on Windows. Use <a href="artifacts/windows/./rawfiles.html">RawFiles</a> to include the
<code>Changed/Entry Modified</code> timestamp.<br />
Since a filelisting can be extremely large every 100k entries <code>artemis</code> will
output the data and then continue.</p>
<p>Other Parsers:</p>
<ul>
<li>Any tool that can recursively list files and directories</li>
</ul>
<p>References:</p>
<ul>
<li>N/A</li>
</ul>
<h1 id="toml-collection-3"><a class="header" href="#toml-collection-3">TOML Collection</a></h1>
<pre><code class="language-toml">system = &quot;windows&quot;

[output]
name = &quot;files_collection&quot;
directory = &quot;./tmp&quot;
format = &quot;json&quot;
compress = false
endpoint_id = &quot;abdc&quot;
collection_id = 1
output = &quot;local&quot;

[[artifacts]]
artifact_name = &quot;files&quot; # Name of artifact
[artifacts.files]
start_path = &quot;C:\\Windows&quot; # Where to start the listing
# Optional
depth = 1 # How many sub directories to descend
# Optional
metadata = true # Get PE metadata
# Optional
md5 = true # MD5 all files
# Optional
sha1 = false # SHA1 all files
# Optional
sha256 = false # SHA256 all files
# Optional
path_regex = &quot;&quot; # Regex for paths
# Optional
file_regex = &quot;&quot; # Regex for files
</code></pre>
<h1 id="collection-options-3"><a class="header" href="#collection-options-3">Collection Options</a></h1>
<ul>
<li><code>start_path</code> Where to start the file listing. Must exist on the endpoint. To
start at root use <code>C:\\</code>. This configuration is <strong>required</strong></li>
<li><code>depth</code> Specify how many directories to descend from the <code>start_path</code>. Default
is one (1). Must be a postive number. Max value is 255. This configuration is
<strong>optional</strong></li>
<li><code>metadata</code> Get <a href="artifacts/windows/pe.html">PE</a> data from <code>PE</code> files. This configuration is
<strong>optional</strong>. Default is <strong>false</strong></li>
<li><code>md5</code> Boolean value to enable MD5 hashing on all files. This configuration is
<strong>optional</strong>. Default is <strong>false</strong></li>
<li><code>sha1</code> Boolean value to enable SHA1 hashing on all files. This configuration
is <strong>optional</strong>. Default is <strong>false</strong></li>
<li><code>sha256</code> Boolean value to enable SHA256 hashing on all files. This
configuration is <strong>optional</strong>. Default is <strong>false</strong></li>
<li><code>path_regex</code> Only descend into paths (directories) that match the provided
regex. This configuration is <strong>optional</strong>. Default is no Regex</li>
<li><code>file_regex</code> Only return entres that match the provided regex. This
configuration is <strong>optional</strong>. Default is no Regex</li>
</ul>
<h1 id="output-structure-3"><a class="header" href="#output-structure-3">Output Structure</a></h1>
<p>An array of <code>WindowsFileInfo</code> entries</p>
<pre><code class="language-typescript">export interface WindowsFileInfo {
  /**Full path to file or directory */
  full_path: string;
  /**Directory path */
  directory: string;
  /**Filename */
  filename: string;
  /**Extension of file if any */
  extension: string;
  /**Created timestamp in UNIXEPOCH seconds */
  created: number;
  /**Modified timestamp in UNIXEPOCH seconds */
  modified: number;
  /**Changed timestamp in UNIXEPOCH seconds */
  changed: number;
  /**Accessed timestamp in UNIXEPOCH seconds */
  accessed: number;
  /**Size of file in bytes */
  size: number;
  /**Inode associated with entry */
  inode: number;
  /**Mode of file entry */
  mode: number;
  /**User ID associated with file */
  uid: number;
  /**Group ID associated with file */
  gid: number;
  /**MD5 of file */
  md5: string;
  /**SHA1 of file */
  sha1: string;
  /**SHA256 of file */
  sha256: string;
  /**Is the entry a file */
  is_file: boolean;
  /**Is the entry a directory */
  is_directory: boolean;
  /**Is the entry a symbolic links */
  is_symlink: boolean;
  /**Depth the file from provided start poin */
  depth: number;
  /**PE binary metadata */
  binary_info: PeInfo[];
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="jumplists"><a class="header" href="#jumplists">Jumplists</a></h1>
<p>Windows <code>Jumplists</code> files track opened files via applications in the Taskbar or
Start Menu. Jumplists are actually a collection of embedded
<a href="artifacts/windows/./shortcuts.html">Shortcut</a> files and therefore can show evidence of file
interaction.</p>
<p>There are two (2) types of Jumplist files:</p>
<ul>
<li>Custom - Files that are pinned to Taskbar applications</li>
<li>Automatic - Files that are not pinned to Taskbar applications</li>
</ul>
<p>Other parsers:</p>
<ul>
<li><a href="https://ericzimmerman.github.io/">Jumplist Explorer</a></li>
</ul>
<p>References:</p>
<ul>
<li><a href="https://github.com/libyal/dtformats/blob/main/documentation/Jump%20lists%20format.asciidoc">Libyal</a></li>
<li><a href="https://binaryforay.blogspot.com/2016/02/jump-lists-in-depth-understand-format.html">Zimmerman blog</a></li>
</ul>
<h1 id="toml-collection-4"><a class="header" href="#toml-collection-4">TOML Collection</a></h1>
<pre><code class="language-toml">system = &quot;windows&quot;

[output]
name = &quot;jumplists_collection&quot;
directory = &quot;./tmp&quot;
format = &quot;jsonl&quot;
compress = false
endpoint_id = &quot;6c51b123-1522-4572-9f2a-0bd5abd81b82&quot;
collection_id = 1
output = &quot;local&quot;

[[artifacts]]
artifact_name = &quot;jumplists&quot;
[artifacts.jumplists]
# Optional
# alt_drive = 'C'
</code></pre>
<h1 id="collection-options-4"><a class="header" href="#collection-options-4">Collection Options</a></h1>
<ul>
<li><code>alt_drive</code> Expects a single character value. Will use an alternative drive
letter when parsing <code>Jumplists</code>. This configuration is <strong>optional</strong>. By
default <code>artemis</code> will use the <code>%systemdrive%</code> value (typically <code>C</code>)</li>
</ul>
<h1 id="output-structure-4"><a class="header" href="#output-structure-4">Output Structure</a></h1>
<p>An array of <code>Jumplists</code> entries</p>
<pre><code class="language-typescript">export interface Jumplists {
  /**Path to Jumplist file */
  path: string;
  /**Jupmlist type. Custom or Automatic */
  jumplist_type: string;
  /**Application ID for Jumplist file */
  app_id: string;
  /**Metadata associated with Jumplist entry */
  jumplist_metadata: DestEntries;
  /**Shortcut information for Jumplist entry */
  lnk_info: Shortcut;
}

/**
 * Metadata associated with Jumplist entry
 */
interface DestEntries {
  /**
   * Digital Record Object Identification (DROID) used to track lnk file
   */
  droid_volume_id: string;
  /**
   * Digital Record Object Identification (DROID) used to track lnk file
   */
  droid_file_id: string;
  /**
   * Digital Record Object Identification (DROID) used to track lnk file
   */
  birth_droid_volume_id: string;
  /**
   * Digital Record Object Identification (DROID) used to track lnk file
   */
  birth_droid_file_id: string;
  /**Hostname associated with Jumplist entry */
  hostname: string;
  /**Jumplist entry number */
  entry: number;
  /**Modified timestamp of Jumplist entry in UNIXEPOCH seconds */
  modified: number;
  /**Status if Jumplist entry is pinned. `Pinned` or `NotPinned` */
  pin_status: string;
  /**Path associated with Jumplist entry */
  path: string;
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="portable-executable"><a class="header" href="#portable-executable">Portable Executable</a></h1>
<p>Windows Portable Executable (<code>PE</code>) is executable format for applications on
Windows. <code>artemis</code> is able to parse basic metadata from <code>PE</code> files using the
<a href="https://crates.io/crates/pelite">pelite</a> crate.</p>
<p>Other Parsers:</p>
<ul>
<li><a href="https://rada.re/n/">radare2</a></li>
<li><a href="https://github.com/horsicq/XPEViewer">XPEViewer</a></li>
<li><a href="https://lief-project.github.io/">LIEF</a></li>
</ul>
<p>References:</p>
<ul>
<li><a href="https://lief-project.github.io/">LIEF</a></li>
<li><a href="https://github.com/libyal/libexe/blob/main/documentation/Executable%20(EXE)%20file%20format.asciidoc">libyal</a></li>
</ul>
<h1 id="toml-collection-5"><a class="header" href="#toml-collection-5">TOML Collection</a></h1>
<p>There is no way to collect just <code>PE</code> data with <code>artemis</code> instead it is an
optional feature for the Windows <code>filelisting</code>, <code>rawfilelisting</code>, and
<code>processes</code> artifacts.<br />
However, it is possible to directly parse <code>PE</code> files by using <code>JavaScript</code>. See
the <a href="artifacts/windows/../../examples/scripts.html">scripts</a> chapter for examples.</p>
<h1 id="collection-optaions"><a class="header" href="#collection-optaions">Collection Optaions</a></h1>
<p>N/A</p>
<h1 id="output-structure-5"><a class="header" href="#output-structure-5">Output Structure</a></h1>
<p>An object containing <code>PE</code> info</p>
<pre><code class="language-typescript">export interface PeInfo {
  /**Array of imported DLLs */
  imports: string[];
  /**Array of section names */
  sections: string[];
  /**Base64 encoded certificate information */
  cert: string;
  /**Path to PDB file */
  pdb: string;
  /**PE product version */
  product_version: string;
  /**PE file version */
  file_version: string;
  /**PE product name */
  product_name: string;
  /**PE company name */
  company_name: string;
  /**PE file description */
  file_description: string;
  /**PE internal name */
  internal_name: string;
  /**PE copyright */
  legal_copyright: string;
  /**PE original filename */
  original_filename: string;
  /**PE manifest info */
  manifest: string;
  /**Array of base64 icons */
  icons: string[];
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="prefetch"><a class="header" href="#prefetch">Prefetch</a></h1>
<p>Windows <code>Prefetch</code> data tracks execution of applications on Windows
Workstations. <code>Prefetch</code> files are typically located at <code>C:\Windows\Prefetch</code>.
On Windows servers <code>Prefetch</code> is disabled and may also be disabled on systems
with SSDs. Starting on Windows 10, the <code>Prefetch</code> files are compressed using
<code>LZXPRESS Huffman</code>. <code>artemis</code> uses the Windows API to decompress the data before
parsing <code>Prefetch</code> fiels</p>
<p>Other Parsers:</p>
<ul>
<li><a href="https://docs.velociraptor.app/artifact_references/pages/windows.forensics.prefetch/">Velociraptor</a></li>
<li><a href="https://ericzimmerman.github.io/">PECmd</a></li>
</ul>
<p>References:
<a href="https://github.com/libyal/libscca/blob/main/documentation/Windows%20Prefetch%20File%20(PF)%20format.asciidoc">Libyal</a></p>
<h1 id="toml-collection-6"><a class="header" href="#toml-collection-6">TOML Collection</a></h1>
<pre><code class="language-toml">system = &quot;windows&quot;

[output]
name = &quot;prefetch_collection&quot;
directory = &quot;./tmp&quot;
format = &quot;json&quot;
compress = false
endpoint_id = &quot;6c51b123-1522-4572-9f2a-0bd5abd81b82&quot;
collection_id = 1
output = &quot;local&quot;

[[artifacts]]
artifact_name = &quot;prefetch&quot;
[artifacts.prefetch]
# Optional
# alt_drive = 'D'
</code></pre>
<h1 id="collection-options-5"><a class="header" href="#collection-options-5">Collection Options</a></h1>
<ul>
<li><code>alt_drive</code> Expects a single character value. Will use an alternative drive
letter when parsing <code>Prefetch</code>. This configuration is <strong>optional</strong>. By default
<code>artemis</code> will use the <code>%systemdrive%</code> value (typically <code>C</code>)</li>
</ul>
<h1 id="output-structure-6"><a class="header" href="#output-structure-6">Output Structure</a></h1>
<p>An array of <code>Prefetch</code> entries</p>
<pre><code class="language-typescript">export interface Prefetch {
  /**Path to prefetch file */
  path: string;
  /**Name of executed file */
  filename: string;
  /**Prefetch hash */
  hash: string;
  /**Most recent execution timestamp in UNIXEPOCH seconds */
  last_run_time: number;
  /**Array of up to eight (8) execution timestamps in UNIXEPOCH seconds */
  all_run_times: number[];
  /**Number of executions */
  run_count: number;
  /**Size of executed file */
  size: number;
  /**Array of volume serial numbers associated with accessed files/directories */
  volume_serial: string[];
  /**Array of volume creation timestamps in UNIXEPOCH seconds associated with accessed files/directories */
  volume_creation: number[];
  /**Array of volumes associated accessed files/directories */
  volume_path: string[];
  /**Number of files accessed by executed file */
  accessed_file_count: number;
  /**Number of directories accessed by executed file */
  accessed_directories_count: number;
  /**Array of accessed files by executed file */
  accessed_files: string[];
  /**Array of accessed directories by executed file */
  accessed_directories: string[];
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="processes"><a class="header" href="#processes">Processes</a></h1>
<p>Gets a standard process listing using the Windows API</p>
<p>Other Parsers:</p>
<ul>
<li>Any tool that calls the Windows API or can parse the raw Windows memory</li>
</ul>
<p>References:</p>
<ul>
<li>N/A</li>
</ul>
<h1 id="toml-collection-7"><a class="header" href="#toml-collection-7">TOML Collection</a></h1>
<pre><code class="language-toml">system = &quot;windows&quot;

[output]
name = &quot;processes_collection&quot;
directory = &quot;./tmp&quot;
format = &quot;json&quot;
compress = false
endpoint_id = &quot;abdc&quot;
collection_id = 1
output = &quot;local&quot;

[[artifacts]]
artifact_name = &quot;processes&quot;
[artifacts.processes]
metadata = true 
# MD5 hash process binary
md5 = true
# SHA1 hash process binary
sha1 = false
# SHA256 hash process binary
sha256 = false
</code></pre>
<h1 id="collection-options-6"><a class="header" href="#collection-options-6">Collection Options</a></h1>
<ul>
<li><code>metadata</code> Get <a href="artifacts/windows/pe.html">PE</a> data from process binary.</li>
<li><code>md5</code> Boolean value to MD5 hash process binary</li>
<li><code>sha1</code> Boolean value to SHA1 hash process binary</li>
<li><code>sha256</code> Boolean value to SHA256 hash process binary</li>
</ul>
<h1 id="output-structure-7"><a class="header" href="#output-structure-7">Output Structure</a></h1>
<p>An array of <code>WindowsProcessInfo</code> entries</p>
<pre><code class="language-typescript">export interface WindowsProcessInfo {
  /**Full path to the process binary */
  full_path: string;
  /**Name of process */
  name: string;
  /**Path to process binary */
  path: string;
  /** Process ID */
  pid: number;
  /** Parent Process ID */
  ppid: number;
  /**Environment variables associated with process */
  environment: string;
  /**Status of the process */
  status: string;
  /**Process arguments */
  arguments: string;
  /**Process memory usage */
  memory_usage: number;
  /**Process virtual memory usage */
  virtual_memory_usage: number;
  /**Process start time in UNIXEPOCH seconds*/
  start_time: number;
  /** User ID associated with process */
  uid: string;
  /**Group ID associated with process */
  gid: string;
  /**MD5 hash of process binary */
  md5: string;
  /**SHA1 hash of process binary */
  sha1: string;
  /**SHA256 hash of process binary */
  sha256: string;
  /**PE metadata asssociated with process binary */
  binary_info: PeInfo[];
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="raw-files"><a class="header" href="#raw-files">Raw Files</a></h1>
<p>A raw Windows filelisting by parsing the <code>NTFS</code> file system using the
<a href="https://github.com/ColinFinck/ntfs">ntfs</a> crate to recursively walk the files
and directories on the system. If hashing or <code>PE</code> parsing is enabled this will
also read the file contents. <code>Raw Files</code> also supports decompressing compressed
files with the <code>WofCompression</code> alternative data stream (ADS) attribute.<br />
Since a filelisting can be extremely large every 100k entries <code>artemis</code> will
output the data and then continue.</p>
<p>Other Parsers:</p>
<ul>
<li>Any tool that parse the NTFS file system</li>
</ul>
<p>References:</p>
<ul>
<li><a href="https://github.com/libyal/libfsntfs/blob/main/documentation/New%20Technologies%20File%20System%20(NTFS).asciidoc">Libyal</a></li>
</ul>
<h1 id="toml-collection-8"><a class="header" href="#toml-collection-8">TOML Collection</a></h1>
<pre><code class="language-toml">system = &quot;windows&quot;

[output]
name = &quot;ntfs_collection&quot;
directory = &quot;./tmp&quot;
format = &quot;json&quot;
compress = false
endpoint_id = &quot;6c51b123-1522-4572-9f2a-0bd5abd81b82&quot;
collection_id = 1
output = &quot;local&quot;

[[artifacts]]
artifact_name = &quot;rawfiles&quot;
[artifacts.rawfiles]
drive_letter = 'C'
start_path = &quot;C:\\&quot;
depth = 20
recover_indx = false
# Optional
metadata = true # Get PE metadata
# Optional
md5 = false
# Optional
sha1 = false
# Optional
sha256 = false
# Optional
metadata = false
# Optional
path_regex = &quot;&quot;
# Optional
filename_regex = &quot;&quot;
</code></pre>
<h1 id="collection-options-7"><a class="header" href="#collection-options-7">Collection Options</a></h1>
<ul>
<li><code>drive_letter</code> Drive letter to use to parse the NTFS file system. This
configuration is <strong>required</strong></li>
<li><code>start_path</code> Directory to start walking the filesystem. This configuration is
<strong>required</strong></li>
<li><code>depth</code> How many directories to descend from the <code>start_path</code>. Must be a
postive number. Max value is 255. This configuration is <strong>required</strong></li>
<li><code>recover_indx</code> Boolean value to carve deleted entries from the <code>$INDX</code>
attribute. Can show evidence of deleted files</li>
<li><code>metadata</code> Get <a href="artifacts/windows/pe.html">PE</a> data from <code>PE</code> files. This configuration is
<strong>optional</strong>. Default is <strong>false</strong></li>
<li><code>md5</code> Boolean value to enable MD5 hashing on all files. This configuration is
<strong>optional</strong>. Default is <strong>false</strong></li>
<li><code>sha1</code> Boolean value to enable SHA1 hashing on all files. This configuration
is <strong>optional</strong>. Default is <strong>false</strong></li>
<li><code>sha256</code> Boolean value to enable SHA256 hashing on all files. This
configuration is <strong>optional</strong>. Default is <strong>false</strong></li>
<li><code>path_regex</code> Only descend into paths (directories) that match the provided
regex. This configuration is <strong>optional</strong>. Default is no Regex</li>
<li><code>file_regex</code> Only return entres that match the provided regex. This
configuration is <strong>optional</strong>. Default is no Regex</li>
</ul>
<h1 id="output-structure-8"><a class="header" href="#output-structure-8">Output Structure</a></h1>
<p>An array of <code>WindowsRawFileInfo</code> entries</p>
<pre><code class="language-typescript">export interface RawFileInfo {
  /**Full path to file or directory */
  full_path: string;
  /**Directory path */
  directory: string;
  /**Filename */
  filename: string;
  /**Extension of file if any */
  extension: string;
  /**Created timestamp in UNIXEPOCH seconds */
  created: number;
  /**Modified timestamp in UNIXEPOCH seconds */
  modified: number;
  /**Changed timestamp in UNIXEPOCH seconds */
  changed: number;
  /**Accessed timestamp in UNIXEPOCH seconds */
  accessed: number;
  /**Filename created timestamp in UNIXEPOCH seconds */
  filename_created: number;
  /**Filename modified timestamp in UNIXEPOCH seconds */
  filename_modified: number;
  /**Filename accessed timestamp in UNIXEPOCH seconds */
  filename_accessed: number;
  /**Filename changed timestamp in UNIXEPOCH seconds */
  filename_changed: number;
  /**Size of file in bytes */
  size: number;
  /**Size of file if compressed */
  compressed_size: number;
  /**Compression type used on file */
  compression_type: string;
  /**Inode entry */
  inode: number;
  /**Sequence number for entry */
  sequence_number: number;
  /**Parent MFT reference for entry */
  parent_mft_references: number;
  /**Attributes associated with entry */
  attributess: string[];
  /**MD5 of file. Optional */
  md5: string;
  /**SHA1 of file. Optional */
  sha1: string;
  /**SHA256 of file. Optional */
  sha256: string;
  /**Is the entry a file */
  is_file: boolean;
  /**Is the entry a directory */
  is_directory: boolean;
  /** Is the entry carved from $INDX */
  is_indx: boolean;
  /**USN entry */
  usn: number;
  /**SID number associated with entry */
  sid: number;
  /**SID  string associated with entry*/
  user_sid: string;
  /**Group SID associated with enry */
  group_sid: string;
  /**Drive letter */
  drive: string;
  /**ADS info associated with entry */
  ads_info: AdsInfo[];
  /**Depth the file from provided start point*/
  depth: number;
  /**PE binary metadata. Optional */
  binary_info: PeInfo[];
}

/**
 * Alternative Data Streams (ADS) are a NTFS feature to embed data in another data stream
 */
export interface AdsInfo {
  /**Name of the ADS entry */
  name: string;
  /**Size of the ADS entry */
  size: number;
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="recyclebin"><a class="header" href="#recyclebin">RecycleBin</a></h1>
<p>Windows <code>RecycleBin</code> is a special folder on Windows that stores files deleted
using the Explorer GUI. When a file is deleted (via Explorer) two types files
are generated in the <code>RecycleBin</code>:</p>
<ul>
<li>Files that begin with <code>$I&lt;number&gt;.&lt;original extension&gt;</code>. Contains metadata
about deleted file</li>
<li>Files that begin with <code>$R&lt;number&gt;.&lt;original extension&gt;</code>. Contents of deleted
file</li>
</ul>
<p>Currently <code>artemis</code> supports parsing the <code>$I</code> based files using the standard
Windows APIs to read the file for parsing. It does not try to recover files that
have been deleted/emptied from the <code>RecycleBin</code></p>
<p>Other parsers:</p>
<ul>
<li><a href="https://docs.velociraptor.app/artifact_references/pages/windows.forensics.recyclebin/">Velociraptor</a></li>
</ul>
<p>References:</p>
<ul>
<li><a href="https://github.com/libyal/dtformats/blob/main/documentation/Windows%20Recycle.Bin%20file%20formats.asciidoc">libyal</a></li>
<li><a href="https://cybersecurity.att.com/blogs/security-essentials/digital-dumpster-diving-exploring-the-intricacies-of-recycle-bin-forensics">RecycleBin</a></li>
</ul>
<h1 id="toml-collection-9"><a class="header" href="#toml-collection-9">TOML Collection</a></h1>
<pre><code class="language-toml">system = &quot;windows&quot;

[output]
name = &quot;recyclebin_collection&quot;
directory = &quot;./tmp&quot;
format = &quot;jsonl&quot;
compress = false
endpoint_id = &quot;6c51b123-1522-4572-9f2a-0bd5abd81b82&quot;
collection_id = 1
output = &quot;local&quot;

[[artifacts]]
artifact_name = &quot;recyclebin&quot;
[artifacts.recyclebin]
# alt_drive = 'C'
</code></pre>
<h1 id="collection-options-8"><a class="header" href="#collection-options-8">Collection Options</a></h1>
<ul>
<li><code>alt_drive</code> Expects a single character value. Will use an alternative drive
letter when parsing <code>RecycleBin</code>. This configuration is <strong>optional</strong>. By
default <code>artemis</code> will use the <code>%systemdrive%</code> value (typically <code>C</code>)</li>
</ul>
<h1 id="output-structure-9"><a class="header" href="#output-structure-9">Output Structure</a></h1>
<p>An array of <code>RecycleBin</code> entries</p>
<pre><code class="language-typescript">export interface RecycleBin {
  /**Size of deleted file */
  size: number;
  /**Deleted timestamp of file in UNIXEPOCH seconds */
  deleted: number;
  /**Name of deleted file */
  filename: string;
  /**Full path to the deleted file */
  full_path: string;
  /**Directory associated with deleted file */
  directory: string;
  /**SID associated with the deleted file */
  sid: string;
  /**Path to the file in the Recycle Bin */
  recycle_path: string;
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="registry"><a class="header" href="#registry">Registry</a></h1>
<p>Windows <code>Registry</code> is a collection of binary files that store Windows
configuration settings and OS information. There are multiple <code>Registry</code> files
on a system such as:</p>
<ul>
<li><code>C:\Windows\System32\config\SYSTEM</code></li>
<li><code>C:\Windows\System32\config\SOFTWARE</code></li>
<li><code>C:\Windows\System32\config\SAM</code></li>
<li><code>C:\Windows\System32\config\SECURITY</code></li>
<li><code>C:\Users\%\NTUSER.DAT</code></li>
<li><code>C:\Users\%\AppData\Local\Microsoft\Windows\UsrClass.dat</code></li>
</ul>
<p>Other Parser:</p>
<ul>
<li><a href="https://docs.velociraptor.app/artifact_references/pages/windows.registry.ntuser/">Velociraptor</a></li>
<li><a href="https://ericzimmerman.github.io/#!index.md">RegistryExplorer</a></li>
</ul>
<p>References:</p>
<ul>
<li><a href="https://github.com/libyal/libregf">Libyal</a></li>
<li><a href="https://github.com/msuhanov/regf/blob/master/Windows%20registry%20file%20format%20specification.md">Registry Format</a></li>
</ul>
<h1 id="toml-collection-10"><a class="header" href="#toml-collection-10">TOML Collection</a></h1>
<pre><code class="language-toml">system = &quot;windows&quot;

[output]
name = &quot;registry_collection&quot;
directory = &quot;./tmp&quot;
format = &quot;json&quot;
compress = false
endpoint_id = &quot;6c51b123-1522-4572-9f2a-0bd5abd81b82&quot;
collection_id = 1
output = &quot;local&quot;

[[artifacts]]
artifact_name = &quot;registry&quot; # Parses the whole Registry file
[artifacts.registry]
user_hives = true # All NTUSER.DAT and UsrClass.dat
system_hives = true # SYSTEM, SOFTWARE, SAM, SECURITY
# Optional
# alt_drive = 'D'
# Optional
# path_regex = &quot;&quot; # Registry is converted to lowercase before all comparison operations. So any regex input will also be converted to lowercase
</code></pre>
<h1 id="collection-options-9"><a class="header" href="#collection-options-9">Collection Options</a></h1>
<ul>
<li><code>user_hives</code> Parse all user <code>Registry</code> files <code>NTUSER.DAT</code> and <code>UsrClass.dat</code>.
This configuration is <strong>required</strong></li>
<li><code>system_hives</code> Parse all system <code>Registry</code> files <code>SYSTEM</code>, <code>SAM</code>, <code>SOFTWARE</code>,
<code>SECURITY</code>. This configuration is <strong>required</strong></li>
<li><code>alt_drive</code> Use an alternative driver. This configuration is <strong>optional</strong>. By
default <code>artemis</code> will use the <code>%systemdrive%</code> value (typically <code>C</code>)</li>
<li><code>path_regex</code> Only return <code>Registry</code> keys that match provided <code>path_regex</code>. All
comparisons are first converted to lowercase. This configuration is
<strong>optional</strong>. Default is no Regex</li>
</ul>
<h1 id="output-structure-10"><a class="header" href="#output-structure-10">Output Structure</a></h1>
<p>An array of <code>RegistryData</code> entries for each parsed <code>Registry</code> file</p>
<pre><code class="language-typescript">export interface RegistryData {
  /**Path to Registry file */
  registry_path: string;
  /**Registry file name */
  registry_file: string;
  /**Array of Registry entries */
  registry_entries: Registry[];
}

/**
 * Inteface representing the parsed `Registry` structure
 */
export interface Registry {
  /**
   * Full path to `Registry` key and name.
   * Ex: ` ROOT\...\CurrentVersion\Run`
   */
  path: string;
  /**
   * Path to Key
   * Ex: ` ROOT\...\CurrentVersion`
   */
  key: string;
  /**
   * Key name
   * Ex: `Run`
   */
  name: string;
  /**
   * Values associated with key name
   * Ex: `Run =&gt; Vmware`. Where Run is the `key` name and `Vmware` is the value name
   */
  values: Value[];
  /**Timestamp of when the path was last modified */
  last_modified: number;
  /**Depth of key name */
  depth: number;
}

/**
 * The value data associated with Registry key
 * References:
 *   https://github.com/libyal/libregf
 *   https://github.com/msuhanov/regf/blob/master/Windows%20registry%20file%20format%20specification.md
 */
export interface Value {
  /**Name of Value */
  value: string;
  /**
   * Data associated with value. All types are strings by default. The real type can be determined by `data_type`.
   * `REG_BINARY` is a base64 encoded string
   */
  data: string;
  /**
   * Value type.
   * Full list of types at: https://learn.microsoft.com/en-us/windows/win32/sysinfo/registry-value-types
   */
  data_type: string;
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="scheduled-tasks"><a class="header" href="#scheduled-tasks">Scheduled Tasks</a></h1>
<p>Windows <code>Scheduled Tasks</code> are a common form of persistence on Windows systems.
There are two (2) types of <code>Scheduled Task</code> files:</p>
<ul>
<li>XML based files</li>
<li>Job based files</li>
</ul>
<p><code>artemis</code> supports both formats. Starting on Windows Vista and higher XML files
are used for <code>Scheduled Tasks</code>.</p>
<p>Other Parsers:</p>
<ul>
<li>Any XML reader</li>
<li><a href="https://docs.velociraptor.app/artifact_references/pages/windows.system.taskscheduler/">Velociraptor</a>
(Only supports XML <code>Scheduled Tasks</code>)</li>
</ul>
<p>References:</p>
<ul>
<li><a href="https://github.com/libyal/dtformats/blob/main/documentation/Job%20file%20format.asciidoc">Libyal</a></li>
<li><a href="https://learn.microsoft.com/en-us/openspecs/windows_protocols/ms-tsch/0d6383e4-de92-43e7-b0bb-a60cfa36379f">Microsoft</a></li>
</ul>
<h1 id="toml-collection-11"><a class="header" href="#toml-collection-11">TOML Collection</a></h1>
<pre><code class="language-toml">system = &quot;windows&quot;

[output]
name = &quot;tasks_collection&quot;
directory = &quot;./tmp&quot;
format = &quot;jsonl&quot;
compress = false
endpoint_id = &quot;6c51b123-1522-4572-9f2a-0bd5abd81b82&quot;
collection_id = 1
output = &quot;local&quot;

[[artifacts]]
artifact_name = &quot;tasks&quot;
[artifacts.tasks]
# Optional
# alt_drive = 'C'
</code></pre>
<h1 id="collection-options-10"><a class="header" href="#collection-options-10">Collection Options</a></h1>
<ul>
<li><code>alt_drive</code> Expects a single character value. Will use an alternative drive
letter when parsing <code>Scheduled Tasks</code>. This configuration is <strong>optional</strong>. By
default <code>artemis</code> will use the <code>%systemdrive%</code> value (typically <code>C</code>)</li>
</ul>
<h1 id="output-structure-11"><a class="header" href="#output-structure-11">Output Structure</a></h1>
<p>Collection of <code>TaskData</code></p>
<pre><code class="language-typescript">export interface TaskData {
  /**Array of `TaskXml` parsed XML files */
  tasks: TaskXml[];
  /**Array of `TaskJob` parsed Job files */
  jobs: TaskJob[];
}

/**
 * JSON representation of the Task XML schema.
 * Most of the schema is Optional. Only `Actions` is required
 */
export interface TaskXml {
  /**Registration Info about the Task */
  registrationInfo?: RegistrationInfo;
  /**Triggers that start the Task */
  triggers?: Triggers;
  /**Settings for the Task */
  settings?: Settings;
  /**Base64 encoded raw binary data associated with the Task */
  data?: string;
  /**Principal user information related to the Task */
  principals?: Principals;
  /**Actions executed by the Task */
  actions: Actions;
  /**Path to the XML file */
  path: string;
}

/**
 * Parsed information about the Job file
 */
export interface TaskJob {
  /**ID associated with the Task */
  job_id: string;
  /**Error retry count for the Task */
  error_retry_count: number;
  /**Error retry interval for the Task */
  error_retry_interval: number;
  /**Idle deadlin for Task */
  idle_deadline: number;
  /**Idle wait for Task */
  idle_wait: number;
  /**Task Priority */
  priority: string;
  /**Max run time for Task */
  max_run_time: number;
  /**Task Exit code */
  exit_code: number;
  /**Task Status */
  status: string;
  /**Flags associated with Task */
  flags: string[];
  /**Last run time for Task in LOCALTIME */
  system_time: string;
  /**Running count for Task */
  running_instance_count: number;
  /**Application name associated with Task */
  application_name: string;
  /**Parameters for application */
  parameters: string;
  /**Working directory associated with Task */
  working_directory: string;
  /**Creator of Task */
  author: string;
  /**Comments associated with Task */
  comments: string;
  /**Base64 encoded User data associatd with Task */
  user_data: string;
  /**Start Error associated with Task */
  start_error: number;
  /**Triggers that start the Task */
  triggers: JobTriggers[];
  /**Path to Job file */
  path: string;
}

/**
 * Triggers associated with Job file
 */
interface JobTriggers {
  /**Task start date */
  start_date: string;
  /**Task end date */
  end_date: string;
  /**Task start time */
  start_time: string;
  /**Task duration */
  duration: number;
  /**Task interval */
  interval_mins: number;
  /**Array of trigger flags */
  flags: string[];
  /**Array of trigger types */
  types: string[];
}

/**
 * Registration Info related to Task XML
 */
interface RegistrationInfo {
  /**URI associated with  */
  uri?: string;
  /**SID associated with Task */
  sid?: string;
  /**Source of Task */
  source?: string;
  /**Creation OR Modification of Task */
  date?: string;
  /**Creator of Task */
  author?: string;
  /**Version level of Task */
  version?: string;
  /**User-friendly description of Task */
  description?: string;
  /**URI of external documentation for Task */
  documentation?: string;
}

/**
 * Triggers that active the Task
 */
interface Triggers {
  /**Boot triggers for Task */
  boot: BootTrigger[];
  /**Regirstration triggers for Task. Format is exactly same as BootTriger*/
  registration: BootTrigger[];
  /**Idle triggers for Task */
  idle: IdleTrigger[];
  /**Time triggers for Task */
  time: TimeTrigger[];
  /**Event triggers for Task */
  event: EventTrigger[];
  /**Logon triggers for Task */
  logon: LogonTrigger[];
  /**Session triggers for Task */
  session: SessionTrigger[];
  /**Calendar triggers for Task */
  calendar: CalendarTrigger[];
  /**Windows Notifications triggers for Trask */
  wnf: WnfTrigger[];
}

/**
 * Most Triggers have a collection of common options
 */
interface BaseTriggers {
  /**ID for trigger */
  id?: string;
  /**Start date for Task */
  start_boundary?: string;
  /**End date for Task */
  end_boundary?: string;
  /**Bool value to activate Trigger */
  enabled?: boolean;
  /**Time limit for Task */
  execution_time_limit?: string;
  /**Repetition for Task */
  repetition?: Repetition;
}

/**
 * Repetition Options for Triggers
 */
interface Repetition {
  /**Trigger restart intervals */
  interval: string;
  /**Repetition can stop after duration has elapsed */
  duration?: string;
  /**Task can stop at end of duration */
  stop_at_duration_end?: boolean;
}

/**
 * Boot options to Trigger Task
 */
interface BootTrigger {
  /**Base Triggers associated with Boot */
  common?: BaseTriggers;
  /**Task delayed after boot */
  delay?: string;
}

/**
 * Idle options to Trigger Task
 */
interface IdleTrigger {
  /**Base Triggers associated with Idle */
  common?: BaseTriggers;
}

/**
 * Time options to Trigger Task
 */
interface TimeTrigger {
  /**Base Triggers associated with Time */
  common?: BaseTriggers;
  /**Delay time for `start_boundary` */
  random_delay?: string;
}

/**
 * Event options to Trigger Task
 */
interface EventTrigger {
  /**Base Triggers associated with Event */
  common?: BaseTriggers;
  /**Array of subscriptions that can Trigger the Task */
  subscription: string[];
  /**Delay to Trigger the Task */
  delay?: string;
  /**Trigger can start Task after `number_of_occurrences` */
  number_of_occurrences?: number;
  /**Trigger can start Task after `period_of_occurrence` */
  period_of_occurrence?: string;
  /**Specifies XML field name */
  matching_element?: string;
  /**Specifies set of XML elements */
  value_queries?: string[];
}

/**
 * Logon options to Trigger Task
 */
interface LogonTrigger {
  /**Base Triggers associated with Logon */
  common?: BaseTriggers;
  /**Account name associated with Logon Trigger */
  user_id?: string;
  /**Delay Logon Task Trigger */
  delay?: string;
}

/**
 * Session options to Trigger Task
 */
interface SessionTrigger {
  /**Base Triggers associated with Session */
  common?: BaseTriggers;
  /**Account name associated with Session Trigger */
  user_id?: string;
  /**Delay Session Task Trigger */
  delay?: string;
  /**Session change that Triggers Task */
  state_change?: string;
}

/**
 * Windows Notification options to Trigger Task
 */
interface WnfTrigger {
  /**Base Triggers associated with Windows Notification */
  common?: BaseTriggers;
  /**Notification State name */
  state_name: string;
  /**Delay Notification Trigger Task */
  delay?: string;
  /**Data associated with Notification Trigger */
  data?: string;
  /**Offset associated with Notification Trigger */
  data_offset?: string;
}

/**
 * Calendar Options to Trigger Task
 */
interface CalendarTrigger {
  /**Base Triggers associated with Calendar */
  common?: BaseTriggers;
  /**Delay Calendar Trigger Task */
  random_delay?: string;
  /**Run Task on every X number of days */
  schedule_by_day?: ByDay;
  /**Run Task on every X number of weeks */
  schedule_by_week?: ByWeek;
  /**Run Task on specific days of month */
  schedule_by_month?: ByMonth;
  /**Run Task on specific weeks on specific days */
  schedule_by_month_day_of_week?: ByMonthDayWeek;
}

/**
 * How often to run Task by days
 */
interface ByDay {
  /**Run Task on X number of days. Ex: Two (2) means every other day */
  days_interval?: number;
}

/**
 * How often to run Task by Weeks
 */
interface ByWeek {
  /**Run Task on X number of weeks. Ex: Two (2) means every other week */
  weeks_interval?: number;
  /**Runs on specified days of the week. Ex: Monday, Tuesday */
  days_of_week?: string[];
}

/**
 * How often to run Task by Months
 */
interface ByMonth {
  /**Days of month to run Task */
  days_of_month?: string[];
  /**Months to run Task. Ex: July, August */
  months?: string[];
}

/**How often to run Tasks by Months and Weeks */
interface ByMonthDayWeek {
  /**Weeks of month to run Task */
  weeks?: string[];
  /**Days of month to run Task */
  days_of_week?: string[];
  /**Months to run Task */
  months?: string[];
}

/**
 * Settings determine how to run Task Actions
 */
interface Settings {
  /**Start Task on demans */
  allow_start_on_demand?: boolean;
  /**Restart if fails */
  restart_on_failure?: RestartType;
  /**Determines how Windows handles multiple Task executions */
  multiple_instances_policy?: string;
  /**Disable Task on battery power */
  disallow_start_if_on_batteries?: boolean;
  /**Stop Task if going on battery power */
  stop_if_going_on_batteries?: boolean;
  /**Task can be terminated if time limts exceeded */
  allow_hard_terminate?: boolean;
  /**If scheduled time is missed, Task may be started */
  start_when_available?: boolean;
  /**Run based on network profile name */
  newtork_profile_name?: string;
  /**Run only if network connection available */
  run_only_if_network_available?: boolean;
  /**Wake system from standby or hibernate to run */
  wake_to_run?: boolean;
  /**Task is enabled */
  enabled?: boolean;
  /**Task is hidden from console or GUI */
  hidden?: boolean;
  /**Delete Task after specified duration and no future run times */
  delete_expired_tasks_after?: string;
  /**Options to run when Idle */
  idle_settings?: IdleSettings;
  /**Network settings to run */
  network_settings?: NetworkSettings;
  /**Taks execution time limit */
  execution_time_limit?: string;
  /**Task Priority. Lowest is 1. Highest is 10 */
  priority?: number;
  /**Only run if system is Idle */
  run_only_if_idle?: boolean;
  /**Use unified scheduling engine to handle Task execution */
  use_unified_scheduling_engine?: boolean;
  /**Task is disabled on Remote App Sessions */
  disallow_start_on_remote_app_session?: boolean;
  /**Options to run Task during system maintence periods */
  maintence_settings?: MaintenceSettings;
  /**Task disabled on next OS startup */
  volatile?: boolean;
}

/**
 * Restart on failure options
 */
interface RestartType {
  /**Duration between restarts */
  interval: string;
  /**Number of restart attempts */
  count: number;
}

/**
 * Idle options
 */
interface IdleSettings {
  /**Task may be delayed up until specified duration */
  duration?: string;
  /**Task will wait for system to become idle */
  wait_timeout?: string;
  /**Task stops if system is no longer Idle */
  stop_on_idle_end?: boolean;
  /**Task restarts when system returns to Idle */
  restart_on_idle?: boolean;
}

/**
 * Network options
 */
interface NetworkSettings {
  /**Task runs only on specified network name */
  name?: string;
  /**GUID associated with `NetworkSettings` */
  id?: string;
}

/**
 * Maintence options
 */
interface MaintenceSettings {
  /**Duration of maintence */
  period: string;
  /**Deadline for Task to run */
  deadline?: string;
  /**Task can run idependently of other Tasks with `MaintenceSettings` */
  exclusive?: boolean;
}

/**
 * SID data associated with Task
 */
interface Principals {
  /**Principal name for running the Task */
  user_id?: string;
  /**Determines if Task run on logon */
  logon_type?: string;
  /**Group ID associated with Task. Task can be triggered by anyone in Group ID */
  group_id?: string;
  /**Friendly name of the principal */
  display_name?: string;
  /**Privilege level of Task */
  run_level?: string;
  /**Process Token SID associated with Task */
  process_token_sid_type?: string;
  /**Array of privlege value */
  required_privileges?: string[];
  /**Unique user selected ID */
  id_attribute?: string;
}

/**
 * Actions run by the Task
 */
interface Actions {
  /**Executes one or more commands */
  exec: ExecType[];
  /**COM handler to execute */
  com_handler: ComHandlerType[];
  /**Send an email */
  send_email: SendEmail[];
  /**Display a message */
  show_message: Message[];
}

/**
 * Command options
 */
interface ExecType {
  /**Command to execute */
  command: string;
  /**Arguements for command */
  arguments?: string;
  /**Path to a directory */
  working_directory?: string;
}

/**
 * COM options
 */
interface ComHandlerType {
  /**COM GUID */
  class_id: string;
  /**XML data for COM */
  data?: string;
}

/**
 * SendEmail options
 */
interface SendEmail {
  /**Email server domain */
  server?: string;
  /**Subject of email */
  subject?: string;
  /**Who should received email */
  to?: string;
  /**Who should be CC'd */
  cc?: string;
  /**Who should be BCC'd */
  bcc?: string;
  /**Reply to email address */
  reply_to?: string;
  /**The sender email address */
  from: string;
  /**Custom header fields to include in email */
  header_fields?: Record&lt;string, string&gt;;
  /**Email message body */
  body?: string;
  /**List of files to be attached */
  attachment?: string[];
}

/**
 * Message options
 */
interface Message {
  /**Title of message */
  title?: string;
  /**Message body */
  body: string;
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="search"><a class="header" href="#search">Search</a></h1>
<p>Windows <code>Search</code> is an indexing service for tracking files and content on
Windows.<br />
<code>Search</code> can parse a large amount of metadata (properties) for each entry it
indexes. It has almost 600 different types of properties it can parse. It can
even index part of the contents of a file.</p>
<p><code>Search</code> can index large parts of the file system, so parsing the <code>Search</code>
database can provide a partial file listing of the system. <code>Search</code> is disabled
on Windows Servers and starting on newer versions of Windows 11 it can be stored
in three (3) SQLITE databases (previously was a single ESE database)<br />
The <code>Search</code> database can get extremely large (4GB+ sizes have been seen). The
larger the ESE database the more resources <code>artemis</code> needs to parse the data.<br />
Similar to the filelisting artifact, every 100k entries <code>artemis</code> will output
the data and then continue.</p>
<p>Other parsers:</p>
<ul>
<li><a href="https://github.com/strozfriedberg/sidr">sidr</a></li>
<li><a href="https://github.com/moaistory/WinSearchDBAnalyzer">WinSearchDBAnalyzer</a></li>
<li><a href="https://github.com/libyal/libesedb">libesedb</a></li>
</ul>
<p>References:</p>
<ul>
<li><a href="https://github.com/libyal/esedb-kb/blob/main/documentation/Windows%20Search.asciidoc">libyal</a></li>
<li><a href="https://en.wikipedia.org/wiki/Windows_Search">Windows Search</a></li>
</ul>
<h1 id="toml-collection-12"><a class="header" href="#toml-collection-12">TOML Collection</a></h1>
<pre><code class="language-toml">system = &quot;windows&quot;

[output]
name = &quot;search_collection&quot;
directory = &quot;./tmp&quot;
format = &quot;json&quot;
compress = false
endpoint_id = &quot;6c51b123-1522-4572-9f2a-0bd5abd81b82&quot;
collection_id = 1
output = &quot;local&quot;

[[artifacts]]
artifact_name = &quot;search&quot;
[artifacts.search]
# Optional
# alt_path = &quot;C:\ProgramData\Microsoft\Search\Data\Applications\Windows\Windows.edb&quot;
</code></pre>
<h1 id="collection-options-11"><a class="header" href="#collection-options-11">Collection Options</a></h1>
<ul>
<li><code>alt_path</code> An alternative path to the <code>Search</code> ESE or SQLITE database. This
configuration is <strong>optional</strong>. By default <code>artemis</code> will use
<code>%systemdrive%\ProgramData\Microsoft\Search\Data\Applications\Windows\Windows.edb</code></li>
</ul>
<h1 id="output-structure-12"><a class="header" href="#output-structure-12">Output Structure</a></h1>
<p>An array of <code>SearchEntry</code> entries</p>
<pre><code class="language-typescript">export interface SearchEntry {
  /**Index ID for row */
  document_id: number;
  /**Search entry name */
  entry: string;
  /**Search entry last modified in UNIXEPOCH seconds */
  last_modified: number;
  /**
   * JSON object representing the properties associated with the entry
   *
   * Example:
   * ```
   * &quot;properties&quot;: {
            &quot;3-System_ItemFolderNameDisplay&quot;: &quot;Programs&quot;,
            &quot;4429-System_IsAttachment&quot;: &quot;0&quot;,
            &quot;4624-System_Search_AccessCount&quot;: &quot;0&quot;,
            &quot;4702-System_VolumeId&quot;: &quot;08542f90-0000-0000-0000-501f00000000&quot;,
            &quot;17F-System_DateAccessed&quot;: &quot;k8DVxD162QE=&quot;,
            &quot;4392-System_FileExtension&quot;: &quot;.lnk&quot;,
            &quot;4631F-System_Search_GatherTime&quot;: &quot;7B6taj962QE=&quot;,
            &quot;5-System_ItemTypeText&quot;: &quot;Shortcut&quot;,
            &quot;4184-System_ComputerName&quot;: &quot;DESKTOP-EIS938N&quot;,
            &quot;15F-System_DateModified&quot;: &quot;EVHzDyR22QE=&quot;,
            &quot;4434-System_IsFolder&quot;: &quot;0&quot;,
            &quot;4365-System_DateImported&quot;: &quot;ABKRqWyI1QE=&quot;,
            &quot;4637-System_Search_Store&quot;: &quot;file&quot;,
            &quot;4373-System_Document_DateSaved&quot;: &quot;EVHzDyR22QE=&quot;,
            &quot;4448-System_ItemPathDisplayNarrow&quot;: &quot;Firefox (C:\\ProgramData\\Microsoft\\Windows\\Start Menu\\Programs)&quot;,
            &quot;4559-System_NotUserContent&quot;: &quot;0&quot;,
            &quot;33-System_ItemUrl&quot;: &quot;file:C:/ProgramData/Microsoft/Windows/Start Menu/Programs/Firefox.lnk&quot;,
            &quot;4447-System_ItemPathDisplay&quot;: &quot;C:\\ProgramData\\Microsoft\\Windows\\Start Menu\\Programs\\Firefox.lnk&quot;,
            &quot;13F-System_Size&quot;: &quot;7QMAAAAAAAA=&quot;,
            &quot;4441-System_ItemFolderPathDisplayNarrow&quot;: &quot;Programs (C:\\ProgramData\\Microsoft\\Windows\\Start Menu)&quot;,
            &quot;0-InvertedOnlyPids&quot;: &quot;cBFzESgSZRI=&quot;,
            &quot;4443-System_ItemNameDisplay&quot;: &quot;Firefox.lnk&quot;,
            &quot;4442-System_ItemName&quot;: &quot;Firefox.lnk&quot;,
            &quot;14F-System_FileAttributes&quot;: &quot;32&quot;,
            &quot;4403-System_FolderNameDisplay&quot;: &quot;Cygwin&quot;,
            &quot;4565-System_ParsingName&quot;: &quot;Firefox.lnk&quot;,
            &quot;4456-System_Kind&quot;: &quot;bGluawBwcm9ncmFt&quot;,
            &quot;27F-System_Search_Rank&quot;: &quot;707406378&quot;,
            &quot;16F-System_DateCreated&quot;: &quot;UUZNqWyI1QE=&quot;,
            &quot;4440-System_ItemFolderPathDisplay&quot;: &quot;C:\\ProgramData\\Microsoft\\Windows\\Start Menu\\Programs&quot;,
            &quot;4397-System_FilePlaceholderStatus&quot;: &quot;6&quot;,
            &quot;4465-System_Link_TargetParsingPath&quot;: &quot;C:\\Program Files\\Mozilla Firefox\\firefox.exe&quot;,
            &quot;4431-System_IsEncrypted&quot;: &quot;0&quot;,
            &quot;4457-System_KindText&quot;: &quot;Link; Program&quot;,
            &quot;4444-System_ItemNameDisplayWithoutExtension&quot;: &quot;Firefox&quot;,
            &quot;11-System_FileName&quot;: &quot;Firefox.lnk&quot;,
            &quot;4623-System_SFGAOFlags&quot;: &quot;1078002039&quot;,
            &quot;0F-InvertedOnlyMD5&quot;: &quot;z1gPcor92OaNVyAAzRdOsw==&quot;,
            &quot;4371-System_Document_DateCreated&quot;: &quot;ABKRqWyI1QE=&quot;,
            &quot;4633-System_Search_LastIndexedTotalTime&quot;: &quot;0.03125&quot;,
            &quot;4396-System_FileOwner&quot;: &quot;Administrators&quot;,
            &quot;4438-System_ItemDate&quot;: &quot;ABKRqWyI1QE=&quot;,
            &quot;4466-System_Link_TargetSFGAOFlags&quot;: &quot;1077936503&quot;,
            &quot;4450-System_ItemType&quot;: &quot;.lnk&quot;,
            &quot;4678-System_ThumbnailCacheId&quot;: &quot;DzpSS6gn5yg=&quot;
        }
   * ```
   */
  properties: Record&lt;string, string&gt;;
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="services"><a class="header" href="#services">Services</a></h1>
<p>Windows <code>Services</code> are a common form of persistence and privilege escalation on
Windows systems. Service data is stored in the SYSTEM Registry file.<br />
<code>Services</code> run with SYSTEM level privileges.</p>
<p>Other Parsers:</p>
<ul>
<li>Any tool that can read the Registry</li>
<li><a href="https://docs.velociraptor.app/artifact_references/pages/windows.system.services/">Velociraptor</a></li>
</ul>
<p>References:</p>
<ul>
<li><a href="https://forensafe.com/blogs/windowsservices.html">Services</a></li>
<li><a href="https://github.com/Velocidex/velociraptor/blob/master/artifacts/definitions/Windows/System/Services.yaml">Velociraptor</a></li>
<li><a href="https://winreg-kb.readthedocs.io/en/latest/sources/system-keys/Services-and-drivers.html">Libyal</a></li>
</ul>
<h1 id="toml-collection-13"><a class="header" href="#toml-collection-13">TOML Collection</a></h1>
<pre><code class="language-toml">system = &quot;windows&quot;

[output]
name = &quot;services_collection&quot;
directory = &quot;./tmp&quot;
format = &quot;jsonl&quot;
compress = false
endpoint_id = &quot;6c51b123-1522-4572-9f2a-0bd5abd81b82&quot;
collection_id = 1
output = &quot;local&quot;

[[artifacts]]
artifact_name = &quot;services&quot;
[artifacts.services]
alt_drive = 'C'
</code></pre>
<h1 id="collection-options-12"><a class="header" href="#collection-options-12">Collection Options</a></h1>
<ul>
<li><code>alt_drive</code> Expects a single character value. Will use an alternative drive
letter when parsing <code>Services</code>. This configuration is <strong>optional</strong>. By default
<code>artemis</code> will use the <code>%systemdrive%</code> value (typically <code>C</code>)</li>
</ul>
<h1 id="output-structure-13"><a class="header" href="#output-structure-13">Output Structure</a></h1>
<p>An array of <code>Services</code> entries</p>
<pre><code class="language-typescript">export interface Services {
  /**Current State of the Service */
  state: string;
  /**Name of Service */
  name: string;
  /**Display name of Service */
  display_name: string;
  /**Service description */
  description: string;
  /**Start mode of Service */
  start_mode: string;
  /**Path to executable for Service */
  path: string;
  /**Service types. Ex: KernelDriver */
  service_type: string[];
  /**Account associated with Service */
  account: string;
  /**Registry modified timestamp in UNIXEPOCH seconds. May be used to determine when the Service was created */
  modified: number;
  /**DLL associated with Service */
  service_dll: string;
  /**Service command upon failure */
  failure_command: string;
  /**Reset period associated with Service */
  reset_period: number;
  /**Service actions upon failure */
  failure_actions: FailureActions[];
  /**Privileges associated with Service */
  required_privileges: string[];
  /**Error associated with Service */
  error_control: string;
  /**Registry path associated with Service */
  reg_path: string;
}

/**
 * Failure actions executed when Service fails
 */
interface FailureActions {
  /**Action executed upon failure */
  action: string;
  /**Delay in seconds on failure */
  delay: number;
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="shellbags"><a class="header" href="#shellbags">Shellbags</a></h1>
<p>Windows <code>Shellbags</code> are <code>Registry</code> entries that track what directories a user
has browsed via Explorer GUI. These entries are stored in the undocumented
<code>ShellItem</code> binary format.<br />
<code>artemis</code> supports parsing the most common types of <code>shellitems</code>, but if you
encounter a <code>shellitem</code> entry that is not supported please open an issue!</p>
<p>Other parsers:</p>
<ul>
<li><a href="https://ericzimmerman.github.io/">ShllBagsExplorer</a></li>
<li><a href="https://docs.velociraptor.app/artifact_references/pages/windows.forensics.shellbags/">Velociraptor</a></li>
</ul>
<p>References:</p>
<ul>
<li><a href="https://github.com/libyal/libfwsi/blob/main/documentation/Windows%20Shell%20Item%20format.asciidoc">Libyal</a></li>
</ul>
<h1 id="toml-collection-14"><a class="header" href="#toml-collection-14">TOML Collection</a></h1>
<pre><code class="language-toml">system = &quot;windows&quot;

[output]
name = &quot;shellbags_collection&quot;
directory = &quot;./tmp&quot;
format = &quot;json&quot;
compress = false
endpoint_id = &quot;6c51b123-1522-4572-9f2a-0bd5abd81b82&quot;
collection_id = 1
output = &quot;local&quot;

[[artifacts]]
artifact_name = &quot;shellbags&quot;
[artifacts.shellbags]
resolve_guids = true
# Optional
# alt_drive = 'C'
</code></pre>
<h1 id="collection-options-13"><a class="header" href="#collection-options-13">Collection Options</a></h1>
<ul>
<li><code>alt_drive</code> Expects a single character value. Will use an alternative drive
letter when parsing <code>Shellbags</code>. This configuration is <strong>optional</strong>. By
default <code>artemis</code> will use the <code>%systemdrive%</code> value (typically <code>C</code>)</li>
<li><code>resolve_guids</code> Boolean value whether to try to resolve GUIDS found when
parsing <code>Shellbags</code>.
<ul>
<li>If <strong>false</strong>:
<code>&quot;resolve_path&quot;: &quot;20d04fe0-3aea-1069-a2d8-08002b30309d\C:\Program Files (x86)\Microsoft Visual Studio\2019\Community\MSBuild\Current&quot;,</code></li>
<li>If <strong>true</strong>:
<code>&quot;resolve_path&quot;: &quot;This PC\C:\Program Files (x86)\Microsoft Visual Studio\2019\Community\MSBuild\Current&quot;,</code></li>
</ul>
</li>
</ul>
<h1 id="output-structure-14"><a class="header" href="#output-structure-14">Output Structure</a></h1>
<p>An array of <code>Shellbag</code> entries</p>
<pre><code class="language-typescript">export interface Shellbags {
  /**Reconstructed directory path */
  path: string;
  /**FAT created timestamp. Only applicable for Directory `shell_type` */
  created: number;
  /**FAT modified timestamp. Only applicable for Directory `shell_type` */
  modified: number;
  /**FAT modified timestamp. Only applicable for Directory `shell_type` */
  accessed: number;
  /**Entry number in MFT. Only applicable for Directory `shell_type` */
  mft_entry: number;
  /**Sequence number in MFT. Only applicable for Directory `shell_type` */
  mft_sequence: number;
  /**
   * Type of shellitem
   *
   * Can be:
   *   `Directory, URI, RootFolder, Network, Volume, ControlPanel, UserPropertyView, Delegate, Variable, MTP, Unknown, History`
   *
   *  Most common is typically `Directory`
   */
  shell_type: string;
  /**
   * Reconstructed directory with any GUIDs resolved
   * Ex: `20d04fe0-3aea-1069-a2d8-08002b30309d` to `This PC`
   */
  resolve_path: string;
  /**User Registry file associated with `Shellbags` */
  reg_file: string;
  /**Registry key path to `Shellbags` data */
  reg_path: string;
  /**Full file path to the User Registry file */
  reg_file_path: string;
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="shimcache"><a class="header" href="#shimcache">Shimcache</a></h1>
<p>Windows <code>Shimcache</code> (also called: <code>AppCompatCache</code>,
<code>Application Compatability Cache</code>, or <code>AppCompat</code>) are <code>Registry</code> entries that
may<sup>*</sup> indicate application execution. These entries are only written
when the system is shutdown or restarted.</p>
<p><sup>*</sup> While an entry in <code>Shimcache</code> often implies the application was
executed, Windows may pre-populate <code>Shimcache</code> with entries based on a user
browsing to a directory that contains an application.</p>
<p>Other parsers:</p>
<ul>
<li><a href="https://docs.velociraptor.app/artifact_references/pages/windows.registry.appcompatcache/">Velociraptor</a></li>
<li><a href="https://ericzimmerman.github.io">RegistryExplorer</a></li>
</ul>
<p>References:</p>
<ul>
<li><a href="https://www.mandiant.com/resources/blog/caching-out-the-val">Shimcache</a></li>
<li><a href="https://github.com/libyal/winreg-kb/blob/main/docs/sources/system-keys/Application-compatibility-cache.md">Libyal</a></li>
</ul>
<h1 id="toml-collection-15"><a class="header" href="#toml-collection-15">TOML Collection</a></h1>
<pre><code class="language-toml">system = &quot;windows&quot;

[output]
name = &quot;shimcache_collection&quot;
directory = &quot;./tmp&quot;
format = &quot;json&quot;
compress = false
endpoint_id = &quot;6c51b123-1522-4572-9f2a-0bd5abd81b82&quot;
collection_id = 1
output = &quot;local&quot;

[[artifacts]]
artifact_name = &quot;shimcache&quot;
[artifacts.shimcache]
# Optional
# alt_drive = 'D'
</code></pre>
<h1 id="collection-options-14"><a class="header" href="#collection-options-14">Collection Options</a></h1>
<ul>
<li><code>alt_drive</code> Expects a single character value. Will use an alternative drive
letter when parsing <code>Shimcache</code>. This configuration is <strong>optional</strong>. By
default <code>artemis</code> will use the <code>%systemdrive%</code> value (typically <code>C</code>)</li>
</ul>
<h1 id="output-structure-15"><a class="header" href="#output-structure-15">Output Structure</a></h1>
<p>An array of <code>Shimcache</code> entries</p>
<pre><code class="language-typescript">export interface Shimcache {
  /**Entry number for shimcache. Entry zero (0) is most recent execution */
  entry: number;
  /**Full path to application file */
  path: string;
  /**Standard Information Modified timestamp in UNIXEPOCH seconds */
  last_modified: number;
  /**Full path to the Registry key */
  key_path: string;
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="shimdb"><a class="header" href="#shimdb">ShimDB</a></h1>
<p>Windows Shimdatabase (<code>ShimDB</code>) can be used by Windows applications to provided
compatability between Windows versions.<br />
It does this via <code>shims</code> that are inserted into the application that modifies
function calls. Malicious custom shims can be created as a form of persistence.</p>
<p>OtherParsers:</p>
<ul>
<li><a href="https://ericzimmerman.github.io/">SDBExplorer</a></li>
</ul>
<p>References:</p>
<ul>
<li><a href="https://www.geoffchappell.com/studies/windows/win32/apphelp/sdb/index.htm">ShimDB</a></li>
<li><a href="https://www.mandiant.com/resources/blog/fin7-shim-databases-persistence">ShimDB Persistence</a></li>
</ul>
<h1 id="toml-collection-16"><a class="header" href="#toml-collection-16">TOML Collection</a></h1>
<pre><code class="language-toml">system = &quot;windows&quot;

[output]
name = &quot;sdb_collection&quot;
directory = &quot;./tmp&quot;
format = &quot;json&quot;
compress = false
endpoint_id = &quot;6c51b123-1522-4572-9f2a-0bd5abd81b82&quot;
collection_id = 1
output = &quot;local&quot;

[[artifacts]]
artifact_name = &quot;shimdb&quot;
[artifacts.shimdb]
# Optional
# alt_drive = 'D'
</code></pre>
<h1 id="collection-options-15"><a class="header" href="#collection-options-15">Collection Options</a></h1>
<ul>
<li><code>alt_drive</code> Expects a single character value. Will use an alternative drive
letter when parsing <code>ShimDB</code>. This configuration is <strong>optional</strong>. By default
<code>artemis</code> will use the <code>%systemdrive%</code> value (typically <code>C</code>)</li>
</ul>
<h1 id="output-structure-16"><a class="header" href="#output-structure-16">Output Structure</a></h1>
<p>An array of <code>ShimDB</code> entries</p>
<pre><code class="language-typescript">export interface Shimdb {
  /**Array of `TAGS` associated with the index tag*/
  indexes: TagData[];
  /**Data associated with the Shimdb */
  db_data: DatabaseData;
  /**Path to parsed sdb file */
  sdb_path: string;
}

/**
 * SDB files are composed of `TAGS`. There are multiple types of `TAGS`
 * `data` have `TAGS` that can be represented via a JSON object
 * `list_data` have `TAGS` that can be rerpesented as an array of JSON objects
 *
 * Example:
 * ```
 * &quot;data&quot;: {
 *    &quot;TAG_FIX_ID&quot;: &quot;4aeea7ee-44f1-4085-abc2-6070eb2b6618&quot;,
 *    &quot;TAG_RUNTIME_PLATFORM&quot;: &quot;37&quot;,
 *    &quot;TAG_NAME&quot;: &quot;256Color&quot;
 * },
 * &quot;list_data&quot;: [
 *   {
 *      &quot;TAG_NAME&quot;: &quot;Force8BitColor&quot;,
 *      &quot;TAG_SHIM_TAGID&quot;: &quot;169608&quot;
 *    },
 *    {
 *      &quot;TAG_SHIM_TAGID&quot;: &quot;163700&quot;,
 *      &quot;TAG_NAME&quot;: &quot;DisableThemes&quot;
 *    }
 * ]
 * ```
 *
 * See https://www.geoffchappell.com/studies/windows/win32/apphelp/sdb/index.htm for complete list of `TAGS`
 */
export interface TagData {
  /**TAGs represented as a JSON object */
  data: Record&lt;string, string&gt;;
  /**Array of TAGS represented as a JSON objects */
  list_data: Record&lt;string, string&gt;[];
}

/**
 * Metadata related to the SDB file
 */
export interface DatabaseData {
  /**SDB version info */
  sdb_version: string;
  /**Compile timestamp of the SDB file in UNIXEPOCH seconds */
  compile_time: number;
  /**Compiler version info */
  compiler_version: string;
  /**Name of SDB */
  name: string;
  /**Platform ID */
  platform: number;
  /**ID associated with SDB */
  database_id: string;
  /**
   * The SDB file may contain additional metadata information
   * May include additional `TAGS`
   */
  additional_metdata: Record&lt;string, string&gt;;
  /**Array of `TAGS` associated with the SDB file */
  list_data: TagData[];
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="shortcuts"><a class="header" href="#shortcuts">Shortcuts</a></h1>
<p>Windows <code>Shotcut</code> files (<code>.lnk</code>) are files that point to another file. They
often contain a large amount of metadata related to the target file. <code>Shortcut</code>
files can be used to distribute malware and can also provide evidence of file
interaction. The directory at
<code>C:\Users\%\AppData\Roaming\Microsoft\Windows\Recent</code> contains multiple
<code>Shortcuts</code> that point to files recently opened by the user.</p>
<p>Other Parsers:</p>
<ul>
<li><a href="https://ericzimmerman.github.io/">LECmd</a></li>
<li><a href="https://docs.velociraptor.app/artifact_references/pages/windows.forensics.lnk/">Velociraptor</a></li>
</ul>
<p>References:</p>
<ul>
<li><a href="https://github.com/libyal/liblnk/blob/main/documentation/Windows%20Shortcut%20File%20(LNK)%20format.asciidoc">Libyal</a></li>
</ul>
<h1 id="toml-collection-17"><a class="header" href="#toml-collection-17">TOML Collection</a></h1>
<pre><code class="language-toml">system = &quot;windows&quot;

[output]
name = &quot;shortcuts_collection&quot;
directory = &quot;./tmp&quot;
format = &quot;json&quot;
compress = false
endpoint_id = &quot;6c51b123-1522-4572-9f2a-0bd5abd81b82&quot;
collection_id = 1
output = &quot;local&quot;

[[artifacts]]
artifact_name = &quot;shortcuts&quot;
[artifacts.shortcuts]
path = &quot;C:\\ProgramData\\Microsoft\\Windows\\Start Menu\\Programs\\Startup&quot;
</code></pre>
<h1 id="collection-options-16"><a class="header" href="#collection-options-16">Collection Options</a></h1>
<ul>
<li><code>path</code> Target path where <code>artemis</code> should parse <code>Shortcut</code> files. This
configuration is <strong>required</strong></li>
</ul>
<h1 id="output-structure-17"><a class="header" href="#output-structure-17">Output Structure</a></h1>
<p>A <code>Shortcut</code> object structure</p>
<pre><code class="language-typescript">export interface Shortcut {
  /**Path to `shortcut (lnk)` file */
  source_path: string;
  /**Flags that specify what data structures are in the `lnk` file */
  data_flags: string[];
  /**File attributes of target file */
  attribute_flags: string[];
  /**Standard Information created timestamp of target file */
  created: number;
  /**Standard Information accessed timestamp of target file */
  accessed: number;
  /**Standard Information modified timestamp of target file */
  modified: number;
  /**Size in bytes of target file */
  file_size: number;
  /**Flag associated where target file is located. On volume or network share */
  location_flags: string;
  /**Path to target file */
  path: string;
  /**Serial associated with volume if target file is on drive */
  drive_serial: string;
  /**Drive type associated with volume if target file is on drive */
  drive_type: string;
  /**Name of volume if target file is on drive */
  volume_label: string;
  /**Network type if target file is on network share */
  network_provider: string;
  /**Network share name if target file is on network share */
  network_share_name: string;
  /**Network share device name if target file is on network share */
  network_device_name: string;
  /**Description of shortcut (lnk) file */
  description: string;
  /**Relative path to target file */
  relative_path: string;
  /**Directory of target file */
  working_directory: string;
  /**Command args associated with target file */
  command_line_args: string;
  /**Icon path associated with shortcut (lnk) file */
  icon_location: string;
  /**Hostname of target file */
  hostname: string;
  /**
   * Digital Record Object Identification (DROID) used to track lnk file
   */
  droid_volume_id: string;
  /**
   * Digital Record Object Identification (DROID) used to track lnk file
   */
  droid_file_id: string;
  /**
   * Digital Record Object Identification (DROID) used to track lnk file
   */
  birth_droid_volume_id: string;
  /**
   * Digital Record Object Identification (DROID) used to track lnk file
   */
  birth_droid_file_id: string;
  /**Shellitems associated with shortcut (lnk) file */
  shellitems: ShellItems[];
  /**Array of property stores */
  properties: Record&lt;string, string | number | boolean | null&gt;[];
  /**Environmental variable data in shortcut */
  environment_variable: string;
  /**Console metadata in shortcut */
  console: Console[];
  /**Windows Codepage in shortcut */
  codepage: number;
  /**Special folder ID in shortcut */
  special_folder_id: number;
  /**macOS Darwin ID in shortcut */
  darwin_id: string;
  /**Shim layer entry in shortcut */
  shim_layer: string;
  /**Known folder GUID in shortcut */
  known_folder: string;
}

/**
 * Console metadata embeded in Shortcut file
 */
interface Console {
  /**Colors for Console */
  color_flags: string[];
  /**Additional colors for Console */
  pop_fill_attributes: string[];
  /**Console width buffer size */
  screen_width_buffer_size: number;
  /**Console height buffer size */
  screen_height_buffer_size: number;
  /**Console window width */
  window_width: number;
  /**Console window height */
  window_height: number;
  /**Console X coordinate */
  window_x_coordinate: number;
  /**Console Y coordinate */
  window_y_coordinate: number;
  /**Console font size */
  font_size: number;
  /**Console font family */
  font_family: string;
  /**Conesole font weight */
  font_weight: string;
  /**Console font name */
  face_name: string;
  /**Console cursor size */
  cursor_size: string;
  /**Is full screen set (boolean) */
  full_screen: number;
  /**Insert mode */
  insert_mode: number;
  /**Automatic position set (boolean) */
  automatic_position: number;
  /**Console history buffer size */
  history_buffer_size: number;
  /**Console number of bufffers */
  number_history_buffers: number;
  /**Duplicates allowed in history */
  duplicates_allowed_history: number;
  /**Base64 encoded color table. */
  color_table: string;
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="srum"><a class="header" href="#srum">SRUM</a></h1>
<p>Windows System Resource Utilization Monitor (<code>SRUM</code>) is a service that tracks
application resource usage. The service tracks application data such as time
running, bytes sent, bytes received, energy usage, and lots more.<br />
This service was introduced in Windows 8 and is stored in an ESE database at
<code>C:\Windows\System32\sru\SRUDB.dat</code>. On Windows 8 some of the data can be found
in the Registry too (temporary storage before writing to SRUDB.dat), but in
later versions of Windows the data is no longer in the Registry.</p>
<p>Other Parsers:</p>
<ul>
<li><a href="https://docs.velociraptor.app/artifact_references/pages/windows.forensics.srum/">Velociraptor</a></li>
<li><a href="https://ericzimmerman.github.io/#!index.md">SRUMECmd</a></li>
</ul>
<p>References:</p>
<ul>
<li><a href="https://github.com/libyal/esedb-kb/blob/main/documentation/System%20Resource%20Usage%20Monitor%20(SRUM).asciidoc">Libyal</a></li>
<li><a href="https://velociraptor.velocidex.com/digging-into-the-system-resource-usage-monitor-srum-afbadb1a375">Velociraptor</a></li>
</ul>
<h1 id="toml-collection-18"><a class="header" href="#toml-collection-18">TOML Collection</a></h1>
<pre><code class="language-toml">system = &quot;windows&quot;

[output]
name = &quot;srum_collection&quot;
directory = &quot;./tmp&quot;
format = &quot;json&quot;
compress = false
endpoint_id = &quot;6c51b123-1522-4572-9f2a-0bd5abd81b82&quot;
collection_id = 1
output = &quot;local&quot;

[[artifacts]]
artifact_name = &quot;srum&quot;
[artifacts.srum]
# Optional
# alt_path = &quot;C:\Windows\System32\srum\SRUDB.dat&quot;
</code></pre>
<h1 id="collection-options-17"><a class="header" href="#collection-options-17">Collection Options</a></h1>
<ul>
<li><code>alt_path</code> An alternative path to the <code>SRUM</code> ESE database. This configuration
is <strong>optional</strong>. By default <code>artemis</code> will use
<code>%systemdrive%\Windows\System32\srum\SRUDB.dat</code></li>
</ul>
<h1 id="output-structure-18"><a class="header" href="#output-structure-18">Output Structure</a></h1>
<p>An array of entries based on each <code>SRUM</code> table</p>
<pre><code class="language-typescript">/**
 * SRUM table associated with application executions `{D10CA2FE-6FCF-4F6D-848E-B2E99266FA89}`
 */
export interface ApplicationInfo {
  /**ID in for row in the ESE table */
  auto_inc_id: number;
  /**Timestamp when ESE table was updated in UNIXEPOCH seconds */
  timestamp: number;
  /**Application name */
  app_id: string;
  /**SID associated with the application process */
  user_id: string;
  /**Foreground Cycle time for application */
  foreground_cycle_time: number;
  /**Background Cycle time for application */
  background_cycle_time: number;
  /**Facetime for application */
  facetime: number;
  /**Count of foreground context switches */
  foreground_context_switches: number;
  /**Count of background context switches */
  background_context_switches: number;
  /**Count of foreground bytes read */
  foreground_bytes_read: number;
  /**Count of background bytes read */
  foreground_bytes_written: number;
  /**Count of foreground read operations */
  foreground_num_read_operations: number;
  /**Count of foreground write operations */
  foreground_num_write_options: number;
  /**Count of foreground flushes */
  foreground_number_of_flushes: number;
  /**Count of background bytes read */
  background_bytes_read: number;
  /**Count of background write operations */
  background_bytes_written: number;
  /**Count of background read operations */
  background_num_read_operations: number;
  /**Count of background write operations */
  background_num_write_operations: number;
  /**Count of background flushes */
  background_number_of_flushes: number;
}
</code></pre>
<pre><code class="language-typescript">/**
 * SRUM table associated with the timeline of an application's execution `{D10CA2FE-6FCF-4F6D-848E-B2E99266FA86}`
 */
export interface ApplicationTimeline {
  /**ID in for row in the ESE table */
  auto_inc_id: number;
  /**Timestamp when ESE table was updated in UNIXEPOCH seconds */
  timestamp: number;
  /**Application name */
  app_id: string;
  /**SID associated with the application process */
  user_id: string;
  /**Flags associated with entry */
  flags: number;
  /**End time of entry */
  end_time: number;
  /**Duration of timeline in microseconds */
  duration_ms: number;
  /**Span of timeline in microseconds */
  span_ms: number;
  /**Timeline end for entry */
  timeline_end: number;
  /**In focus value for entry */
  in_focus_timeline: number;
  /**User input value for entry */
  user_input_timeline: number;
  /**Comp rendered value for entry */
  comp_rendered_timeline: number;
  /**Comp dirtied value for entry */
  comp_dirtied_timeline: number;
  /**Comp propaged value for entry */
  comp_propagated_timeline: number;
  /**Audio input value for entry */
  audio_in_timeline: number;
  /**Audio output value for entry */
  audio_out_timeline: number;
  /**CPU value for entry */
  cpu_timeline: number;
  /**Disk value for entry */
  disk_timeline: number;
  /**Network value for entry */
  network_timeline: number;
  /**MBB value for entry */
  mbb_timeline: number;
  /**In focus seconds count */
  in_focus_s: number;
  /**PSM foreground seconds count */
  psm_foreground_s: number;
  /**User input seconds count */
  user_input_s: number;
  /**Comp rendered seconds countr */
  comp_rendered_s: number;
  /**Comp dirtied seconds count */
  comp_dirtied_s: number;
  /**Comp propagated seconds count */
  comp_propagated_s: number;
  /**Audio input seconds count */
  audio_in_s: number;
  /**Audio output seconds count */
  audio_out_s: number;
  /**Cycles value for entry */
  cycles: number;
  /**Cycles breakdown value for entry */
  cycles_breakdown: number;
  /**Cycles attribute value for entry */
  cycles_attr: number;
  /**Cycles attribute breakdown for entry */
  cycles_attr_breakdown: number;
  /**Cycles WOB value for entry */
  cycles_wob: number;
  /**Cycles WOB breakdown value for entry */
  cycles_wob_breakdown: number;
  /**Disk raw value for entry */
  disk_raw: number;
  /**Network tail raw value for entry */
  network_tail_raw: number;
  /**Network bytes associated with entry*/
  network_bytes_raw: number;
  /**MBB tail raw value for entry */
  mbb_tail_raw: number;
  /**MBB bytes associated with entry */
  mbb_bytes_raw: number;
  /**Display required seconds count */
  display_required_s: number;
  /**Display required timeline value for entry */
  display_required_timeline: number;
  /**Keyboard input timeline value for entry */
  keyboard_input_timeline: number;
  /**Keybouard input seconds count */
  keyboard_input_s: number;
  /**Mouse input seconds count */
  mouse_input_s: number;
}
</code></pre>
<pre><code class="language-typescript">/**
 * SRUM table associated with VFU `{7ACBBAA3-D029-4BE4-9A7A-0885927F1D8F}`. Unsure what this tracks.
 */
export interface AppVfu {
  /**ID in for row in the ESE table */
  auto_inc_id: number;
  /**Timestamp when ESE table was updated in UNIXEPOCH seconds */
  timestamp: number;
  /**Application name */
  app_id: string;
  /**SID associated with the application process */
  user_id: string;
  /**Flags associated with VFU entry */
  flags: number;
  /**Start time in UNIXEPOCH seconds associated with VFU entry */
  start_time: number;
  /**End time in UNIXEPOCH seconds associated with VFU entry */
  end_time: number;
  /**Base64 encoded usage data associated with VFU entry */
  usage: string;
}
</code></pre>
<pre><code class="language-typescript">/**
 * SRUM table associated witn EnergyInfo `{DA73FB89-2BEA-4DDC-86B8-6E048C6DA477}`
 */
export interface EnergyInfo {
  /**ID in for row in the ESE table */
  auto_inc_id: number;
  /**Timestamp when ESE table was updated in UNIXEPOCH seconds */
  timestamp: number;
  /**Application name */
  app_id: string;
  /**SID associated with the application process */
  user_id: string;
  /**Base64 encoded binary data associated witn EnegyInfo entry */
  binary_data: string;
}
</code></pre>
<pre><code class="language-typescript">/**
 * SRUM table associated with EnergyUsage `{FEE4E14F-02A9-4550-B5CE-5FA2DA202E37}` and `{FEE4E14F-02A9-4550-B5CE-5FA2DA202E37}LT`
 */
export interface EnergyUsage {
  /**ID in for row in the ESE table */
  auto_inc_id: number;
  /**Timestamp when ESE table was updated in UNIXEPOCH seconds */
  timestamp: number;
  /**Application name */
  app_id: string;
  /**SID associated with the application process */
  user_id: string;
  /**Event Timestamp in UNIXEPOCH seconds */
  event_timestamp: number;
  /**State transition associated with entry */
  state_transition: number;
  /**Full charged capacity associated with entry */
  full_charged_capacity: number;
  /**Designed capacity associated with entry */
  designed_capacity: number;
  /** Charge level associated with entry */
  charge_level: number;
  /**Cycle count associated with entry */
  cycle_count: number;
  /**Configuration hash associated with entry */
  configuration_hash: number;
}
</code></pre>
<pre><code class="language-typescript">/**
 * SRUM table associated with NetworkInfo `{973F5D5C-1D90-4944-BE8E-24B94231A174}`
 */
export interface NetworkInfo {
  /**ID in for row in the ESE table */
  auto_inc_id: number;
  /**Timestamp when ESE table was updated in UNIXEPOCH seconds */
  timestamp: number;
  /**Application name */
  app_id: string;
  /**SID associated with the application process */
  user_id: string;
  /**Interface luid associated with entry */
  interface_luid: number;
  /**L2 profile ID associated with entry */
  l2_profile_id: number;
  /**L2 profiel flags associated with entry */
  l2_profile_flags: number;
  /**Bytes sent associated with entry */
  bytes_sent: number;
  /**Bytes received associated with entry */
  bytes_recvd: number;
}
</code></pre>
<pre><code class="language-typescript">/**
 * SRUM table associated with NetworkConnectivityInfo `{DD6636C4-8929-4683-974E-22C046A43763}`
 */
export interface NetworkConnectivityInfo {
  /**ID in for row in the ESE table */
  auto_inc_id: number;
  /**Timestamp when ESE table was updated in UNIXEPOCH seconds */
  timestamp: number;
  /**Application name */
  app_id: string;
  /**SID associated with the application process */
  user_id: string;
  /**Interface luid associated with entry */
  interface_luid: number;
  /**L2 profile ID associated with entry */
  l2_profile_id: number;
  /**Connected time associated with entry */
  connected_time: number;
  /*Connect start time associated with entry in UNIXEPOCH seconds*/
  connect_start_time: number;
  /**L2 profile flags associated with entry */
  l2_profile_flags: number;
}
</code></pre>
<pre><code class="language-typescript">/**
 * SRUM table associated with NotificationInfo `{D10CA2FE-6FCF-4F6D-848E-B2E99266FA86}`
 */
export interface NotificationInfo {
  /**ID in for row in the ESE table */
  auto_inc_id: number;
  /**Timestamp when ESE table was updated in UNIXEPOCH seconds */
  timestamp: number;
  /**Application name */
  app_id: string;
  /**SID associated with the application process */
  user_id: string;
  /**Notification type associated with entry */
  notification_type: number;
  /**Size of payload associated with entry */
  payload_size: number;
  /**Network type associated with entry */
  network_type: number;
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="systeminfo"><a class="header" href="#systeminfo">SystemInfo</a></h1>
<p>Gets system metadata associated with the endpoint</p>
<p>Other Parsers:</p>
<ul>
<li>Any tool that calls the Windows API or queries system information</li>
</ul>
<p>Refernces:</p>
<ul>
<li>N/A</li>
</ul>
<h1 id="toml-collection-19"><a class="header" href="#toml-collection-19">TOML Collection</a></h1>
<pre><code class="language-toml">system = &quot;windows&quot;

[output]
name = &quot;systeminfo_collection&quot;
directory = &quot;./tmp&quot;
format = &quot;json&quot;
compress = false
endpoint_id = &quot;abdc&quot;
collection_id = 1
output = &quot;local&quot;

[[artifacts]]
artifact_name = &quot;systeminfo&quot;
</code></pre>
<h1 id="collection-options-18"><a class="header" href="#collection-options-18">Collection Options</a></h1>
<ul>
<li>N/A</li>
</ul>
<h1 id="output-structure-19"><a class="header" href="#output-structure-19">Output Structure</a></h1>
<p>A <code>SystemInfo</code> object structure</p>
<pre><code class="language-typescript">export interface SystemInfo {
  /**Boot time for endpoint */
  boot_time: number;
  /**Endpoint hostname */
  hostname: string;
  /**Endpoint OS version */
  os_version: string;
  /**Uptime of endpoint */
  uptime: number;
  /**Endpoint kernel version */
  kernel_version: string;
  /**Endpoint platform */
  platform: string;
  /**CPU information */
  cpu: Cpus[];
  /**Disks information */
  disks: Disks[];
  /**Memory information */
  memory: Memory;
  /**Performance information */
  performance: LoadPerformance;
}

/**
 * CPU information on endpoint
 */
export interface Cpus {
  /**CPU frequency */
  frequency: number;
  /**CPU usage on endpoint */
  cpu_usage: number;
  /**Name of CPU */
  name: string;
  /**Vendor ID for CPU */
  vendor_id: string;
  /**CPU brand */
  brand: string;
  /**Core Count */
  physical_core_count: number;
}

/**
 * Disk information on endpoint
 */
export interface Disks {
  /**Type of disk */
  disk_type: string;
  /**Filesystem for disk */
  file_system: string;
  /**Disk mount point */
  mount_point: string;
  /**Disk storage */
  total_space: number;
  /**Storage remaining */
  available_space: number;
  /**If disk is removable */
  removable: boolean;
}

/**
 * Memory information on endpoint
 */
export interface Memory {
  /**Available memory on endpoint */
  available_memory: number;
  /**Free memory on endpoint */
  free_memory: number;
  /**Free swap on endpoint */
  free_swap: number;
  /**Total memory on endpoint */
  total_memory: number;
  /**Total swap on endpoint */
  total_swap: number;
  /**Memory in use */
  used_memory: number;
  /**Swap in use */
  used_swap: number;
}

/**
 * Average CPU load. These values are always zero (0) on Windows
 */
export interface LoadPerformance {
  /**Average load for one (1) min */
  avg_one_min: number;
  /**Average load for five (5) min */
  avg_five_min: number;
  /**Average load for fifteen (15) min */
  avg_fifteen_min: number;
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="userassist"><a class="header" href="#userassist">UserAssist</a></h1>
<p>Windows <code>UserAssist</code> is a Registry artifact that records applications executed
via Windows Explorer. These entries are typically ROT13 encoded (though this can
be disabled).</p>
<p>Other Parsers:</p>
<ul>
<li><a href="https://docs.velociraptor.app/artifact_references/pages/windows.registry.userassist/">Velociraptor</a></li>
<li><a href="https://ericzimmerman.github.io">RegistryExplorer</a></li>
</ul>
<p>References:</p>
<ul>
<li><a href="https://winreg-kb.readthedocs.io/en/latest/sources/explorer-keys/User-assist.html">Libyal</a></li>
</ul>
<h1 id="toml-collection-20"><a class="header" href="#toml-collection-20">TOML Collection</a></h1>
<pre><code class="language-toml">system = &quot;windows&quot;

[output]
name = &quot;userassist_collection&quot;
directory = &quot;./tmp&quot;
format = &quot;json&quot;
compress = false
endpoint_id = &quot;6c51b123-1522-4572-9f2a-0bd5abd81b82&quot;
collection_id = 1
output = &quot;local&quot;

[[artifacts]]
artifact_name = &quot;userassist&quot;
[artifacts.userassist]
# Optional
# alt_drive = 'C'
</code></pre>
<h1 id="collection-options-19"><a class="header" href="#collection-options-19">Collection Options</a></h1>
<ul>
<li><code>alt_drive</code> Expects a single character value. Will use an alternative drive
letter when parsing <code>UserAssist</code>. This configuration is <strong>optional</strong>. By
default <code>artemis</code> will use the <code>%systemdrive%</code> value (typically <code>C</code>)</li>
</ul>
<h1 id="output-structure-20"><a class="header" href="#output-structure-20">Output Structure</a></h1>
<p>An array of <code>UserAssist</code> entries</p>
<pre><code class="language-typescript">export interface UserAssist {
  /**Path of executed application */
  path: string;
  /**Last execution time of application in UNIXEPOCH seconds */
  last_execution: number;
  /**Number of times executed */
  count: number;
  /**Registry path to UserAssist entry */
  reg_path: string;
  /**ROT13 encoded path */
  rot_path: string;
  /**Path of executed application with folder description GUIDs resolved */
  folder_path: string;
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="users"><a class="header" href="#users">Users</a></h1>
<p>Gets user info from SAM Registry file</p>
<p>Other Parsers:</p>
<ul>
<li>Any tool that queries user info</li>
</ul>
<p>References:</p>
<ul>
<li>N/A</li>
</ul>
<h1 id="toml-collection-21"><a class="header" href="#toml-collection-21">TOML Collection</a></h1>
<pre><code class="language-toml">system = &quot;windows&quot;

[output]
name = &quot;users_collection&quot;
directory = &quot;./tmp&quot;
format = &quot;json&quot;
compress = false
endpoint_id = &quot;6c51b123-1522-4572-9f2a-0bd5abd81b82&quot;
collection_id = 1
output = &quot;local&quot;

[[artifacts]]
artifact_name = &quot;users&quot;
[artifacts.users]
# Optional
# alt_drive = 'C'
</code></pre>
<h1 id="collection-options-20"><a class="header" href="#collection-options-20">Collection Options</a></h1>
<ul>
<li><code>alt_drive</code> Expects a single character value. Will use an alternative drive
letter when parsing the <code>SAM</code> file. This configuration is <strong>optional</strong>. By
default <code>artemis</code> will use the <code>%systemdrive%</code> value (typically <code>C</code>)</li>
</ul>
<h1 id="output-structure-21"><a class="header" href="#output-structure-21">Output Structure</a></h1>
<p>An array of <code>UserInfo</code> entries</p>
<pre><code class="language-typescript">export interface UserInfo {
  /**Last logon for account */
  last_logon: number;
  /**Time when password last set in UNIXEPOCH seconds */
  password_last_set: number;
  /**Last password failure in UNIXEPOCH seconds */
  last_password_failure: number;
  /**Relative ID for account. Typically last number of SID */
  relative_id: number;
  /**Primary group ID for account */
  primary_group_id: number;
  /**UAC flags associated with account */
  user_account_control_flags: string[];
  /**Country code for account */
  country_code: number;
  /**Code page for account */
  code_page: number;
  /**Number of password failures associated with account */
  number_password_failures: number;
  /**Number of logons for account */
  number_logons: number;
  /**Username for account */
  username: string;
  /**SID for account */
  sid: string;
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="usnjrnl"><a class="header" href="#usnjrnl">UsnJrnl</a></h1>
<p>Windows <code>UsnJrnl</code> is a sparse binary file that tracks changes to files and
directories. Located at the alternative data stream (ADS)
<code>C:\$Extend\$UsnJrnl:$J</code>. Parsing this data can sometimes show files that have
been deleted. However, depending on the file activity on the system entries in
the <code>UsnJrnl</code> may get overwritten quickly.</p>
<p>Other Parsers:</p>
<ul>
<li><a href="https://docs.velociraptor.app/artifact_references/pages/windows.forensics.usn/">Velociraptor</a></li>
</ul>
<p>References:</p>
<ul>
<li><a href="https://learn.microsoft.com/en-us/windows/win32/api/winioctl/ns-winioctl-usn_record_v2?redirectedfrom=MSDN">UsnJrnl</a></li>
<li><a href="https://github.com/libyal/libfsntfs/blob/main/documentation/New%20Technologies%20File%20System%20(NTFS).asciidoc#usn_change_journal">Libyal</a></li>
</ul>
<h1 id="toml-collection-22"><a class="header" href="#toml-collection-22">TOML Collection</a></h1>
<pre><code class="language-toml">system = &quot;windows&quot;

[output]
name = &quot;usnjrnl_collection&quot;
directory = &quot;./tmp&quot;
format = &quot;json&quot;
compress = false
endpoint_id = &quot;6c51b123-1522-4572-9f2a-0bd5abd81b82&quot;
collection_id = 1
output = &quot;local&quot;

[[artifacts]]
artifact_name = &quot;usnjrnl&quot;
[artifacts.usnjrnl]
# Optional
# alt_drive = 'D'
</code></pre>
<h1 id="collection-options-21"><a class="header" href="#collection-options-21">Collection Options</a></h1>
<ul>
<li><code>alt_drive</code> Expects a single character value. Will use an alternative drive
letter when parsing <code>UsnJrnl</code>. This configuration is <strong>optional</strong>. By default
<code>artemis</code> will use the <code>%systemdrive%</code> value (typically <code>C</code>)</li>
</ul>
<h1 id="output-structure-22"><a class="header" href="#output-structure-22">Output Structure</a></h1>
<p>An array of <code>UsnJrnl</code> entries</p>
<pre><code class="language-typescript">export interface UsnJrnl {
  /**Entry number in the MFT */
  mft_entry: number;
  /**Sequence number in the MFT */
  mft_sequence: number;
  /**Parent entry number in the MFT */
  parent_mft_entry: number;
  /**Parent sequence number in the MFT */
  parent_mft_sequence: number;
  /**ID number in the Update Sequence Number Journal (UsnJrnl) */
  update_sequence_number: number;
  /**Timestamp of of entry update in UNIXEPOCH seconds */
  update_time: number;
  /**Reason for update action */
  update_reason: string;
  /**Source information of the update */
  update_source_flags: string;
  /**Security ID associated with entry */
  security_descriptor_id: number;
  /**Attributes associate with entry */
  file_attributes: string[];
  /**Name associated with entry. Can be file or directory */
  filename: string;
  /**Extension if available for filename */
  extension: string;
  /**Full path for the UsnJrnl entry. Obtained by parsing `$MFT` and referencing the `parent_mft_entry` */
  full_path: string;
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="macos"><a class="header" href="#macos">macOS</a></h1>
<p>Currently <code>artemis</code> has been tested on macOS Catalina and higher. Similar to the
Windows version a main focus point of the library <code>artemis-core</code> is to make a
best effort to not rely on the macOS APIs. Since <code>artemis-core</code> is a forensic
focused library, we do not want to rely on APIs from a potentially compromised
system.<br />
However, <code>artemis-core</code> does use the macOS API for a handful of artifacts:</p>
<ul>
<li><code>Processes</code> - The <a href="https://github.com/GuillaumeGomez/sysinfo">sysinfo</a> crate
is used to pull a process listing using macOS APIs</li>
<li><code>Systeminfo</code> - The <a href="https://github.com/GuillaumeGomez/sysinfo">sysinfo</a> crate
is also to get system information using macOS APIs</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="cron"><a class="header" href="#cron">Cron</a></h1>
<p><code>Cron</code> is an application that lets users create jobs on an endpoint. It is
common on Unix, Linux, and macOS systems. A <code>Cron</code> job can be configured to
execute a command on at a specific time. It is a popular form of persistence on
supported systems.</p>
<p>Other parsers:</p>
<ul>
<li>Any program that read a text file</li>
</ul>
<p>Refernces:</p>
<ul>
<li><a href="https://en.wikipedia.org/wiki/Cron">Cron</a></li>
</ul>
<h1 id="toml-collection-23"><a class="header" href="#toml-collection-23">TOML Collection</a></h1>
<pre><code class="language-toml">system = &quot;macos&quot; # or &quot;linux&quot;

[output]
name = &quot;cron_collection&quot;
directory = &quot;./tmp&quot;
format = &quot;json&quot;
compress = false
endpoint_id = &quot;abdc&quot;
collection_id = 1
output = &quot;local&quot;

[[artifacts]]
artifact_name = &quot;cron&quot;
</code></pre>
<h1 id="collection-options-22"><a class="header" href="#collection-options-22">Collection Options</a></h1>
<ul>
<li>N/A</li>
</ul>
<h1 id="output-structure-23"><a class="header" href="#output-structure-23">Output Structure</a></h1>
<p>An array of <code>Cron</code> entries.</p>
<pre><code class="language-typescript">export interface Cron {
  /**What hour should cron job run. * means every hour */
  hour: string;
  /**What minute should cron job run. * means every minute  */
  min: string;
  /**What day should cron job run. * means every day */
  day: string;
  /**What month should cron job run. * means every month */
  month: string;
  /**What weekday should cron job run. * means every day */
  weekday: string;
  /**Command to execute when cron job is triggered */
  command: string;
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="emond"><a class="header" href="#emond">Emond</a></h1>
<p>macOS Event Monitor Daemon (<code>Emond</code>) is a srvices that allows users to register
rules to perform actions when specific events are triggered, for example &quot;system
startup&quot;. <code>Emond</code> can be leveraged to acheive persistence on macOS. Starting on
macOS Ventura (13) <code>emond</code> has been removed.</p>
<p>Other Parsers:</p>
<ul>
<li>None</li>
</ul>
<p>References:</p>
<ul>
<li><a href="https://magnusviri.com/what-is-emond.html">What is emond</a></li>
<li><a href="https://www.xorrior.com/emond-persistence/">Emond for Persistence</a></li>
</ul>
<h1 id="toml-collection-24"><a class="header" href="#toml-collection-24">TOML Collection</a></h1>
<pre><code class="language-toml">system = &quot;macos&quot;

[output]
name = &quot;emond_collection&quot;
directory = &quot;./tmp&quot;
format = &quot;json&quot;
compress = false
endpoint_id = &quot;abdc&quot;
collection_id = 1
output = &quot;local&quot;

[[artifacts]]
artifact_name = &quot;emond&quot;
</code></pre>
<h1 id="collection-options-23"><a class="header" href="#collection-options-23">Collection Options</a></h1>
<ul>
<li>N/A</li>
</ul>
<h1 id="output-structure-24"><a class="header" href="#output-structure-24">Output Structure</a></h1>
<p>An array of <code>Emond</code> entries</p>
<pre><code class="language-typescript">export interface Emond {
  /**Name of `Emond` rule */
  name: string;
  /**Is rule enabled */
  enabled: boolean;
  /**Event types associated with the rule */
  event_types: string[];
  /**Start time of the rule */
  start_tiem: string;
  /**If partial criteria match should trigger the rule */
  allow_partial_criterion_match: boolean;
  /**Array of commad actions if rule is triggered */
  command_actions: Command[];
  /**Array of log actions if rule is triggered  */
  log_actions: Log[];
  /**Array of send email actions if rule is triggered */
  send_email_actions: SendEmailSms[];
  /**Array of send sms actions if rule is triggered. Has same structure as send email */
  send_sms_actions: SendEmailSms[];
  /**Criteria for the `Emond` rule */
  criterion: Record&lt;string, unknown&gt;[];
  /**Variables associated with the criterion  */
  variables: Record&lt;string, unknown&gt;[];
  /**If the emond client is enabled */
  emond_clients_enabled: boolean;
}

/**
 * Commands to execute if rule is triggered
 */
interface Command {
  /**Command name */
  command: string;
  /**User associated with command */
  user: string;
  /**Group associated with command */
  group: string;
  /**Arguments associated with command */
  arguments: string[];
}

/**
 * Log settings if rule is triggered
 */
interface Log {
  /**Log message content */
  message: string;
  /**Facility associated with log action */
  facility: string;
  /**Level of log */
  log_level: string;
  /**Log type */
  log_type: string;
  /**Parameters associated with log action */
  parameters: Record&lt;string, unknown&gt;;
}

/**
 * Email or SMS to send if rule is triggered
 */
interface SendEmailSms {
  /**Content of the email/sms */
  message: string;
  /**Subject of the email/sms */
  subject: string;
  /**Path to local binary */
  localization_bundle_path: string;
  /**Remote URL to send the message */
  relay_host: string;
  /**Email associated with email/sms action */
  admin_email: string;
  /**Targerts to receive email/sms */
  recipient_addresses: string[];
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="execpolicy"><a class="header" href="#execpolicy">ExecPolicy</a></h1>
<p>macOS Execution Policy (<code>ExecPolicy</code>) tracks application execution on a system.
It only tracks execution of applications that tracked by GateKeeper</p>
<p>Other Parsers:</p>
<ul>
<li>Any SQLITE viewer</li>
</ul>
<p>References:</p>
<ul>
<li><a href="https://eclecticlight.co/2023/03/13/ventura-has-changed-app-quarantine-with-a-new-xattr/">ExecPolicy Info</a></li>
<li><a href="https://knight.sc/reverse%20engineering/2019/02/20/syspolicyd-internals.html">Policy Internals</a></li>
</ul>
<h1 id="toml-collection-25"><a class="header" href="#toml-collection-25">TOML Collection</a></h1>
<pre><code class="language-toml">system = &quot;macos&quot;

[output]
name = &quot;execpolicy_collection&quot;
directory = &quot;./tmp&quot;
format = &quot;json&quot;
compress = false
endpoint_id = &quot;abdc&quot;
collection_id = 1
output = &quot;local&quot;

[[artifacts]]
artifact_name = &quot;execpolicy&quot;
</code></pre>
<h1 id="collection-options-24"><a class="header" href="#collection-options-24">Collection Options</a></h1>
<ul>
<li>N/A</li>
</ul>
<h1 id="output-structure-25"><a class="header" href="#output-structure-25">Output Structure</a></h1>
<p>An array of <code>ExecPolicy</code> entries</p>
<pre><code class="language-typescript">export interface ExecPolicy {
  /**Is file signed */
  is_signed: number;
  /**File ID name */
  file_identifier: string;
  /**App bundle ID */
  bundle_identifier: string;
  /**Bundle version */
  bundle_version: string;
  /**Team ID */
  team_identifier: string;
  /**Signing ID */
  signing_identifier: string;
  /**Code Directory hash*/
  cdhash: string;
  /**SHA256 hash of application */
  main_executable_hash: string;
  /**Executable timestamp in UNIXEPOCH seconds */
  executable_timestamp: number;
  /**Size of file */
  file_size: number;
  /**Is library */
  is_library: number;
  /**Is file used */
  is_used: number;
  /**File ID associated with entry */
  responsible_file_identifier: string;
  /**Is valid entry */
  is_valid: number;
  /**Is quarantined entry */
  is_quarantined: number;
  /**Timestamp for executable measurements in UNIXEPOCH seconds */
  executable_measurements_v2_timestamp: number;
  /**Reported timestamp in UNIXEPOCH seconds */
  reported_timstamp: number;
  /**Primary key */
  pk: number;
  /**Volume UUID for entry */
  volume_uuid: string;
  /**Object ID for entry */
  object_id: number;
  /**Filesystem type */
  fs_type_name: string;
  /**App Bundle ID */
  bundle_id: string;
  /**Policy match for entry */
  policy_match: number;
  /**Malware result for entry */
  malware_result: number;
  /**Flags for entry */
  flags: number;
  /**Modified time in UNIXEPOCH seconds */
  mod_time: number;
  /**Policy scan cache timestamp in UNIXEPOCH seconds */
  policy_scan_cache_timestamp: number;
  /**Revocation check timestamp in UNIXEPOCH seconds */
  revocation_check_time: number;
  /**Scan version for entry */
  scan_version: number;
  /**Top policy match for entry */
  top_policy_match: number;
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="files-1"><a class="header" href="#files-1">Files</a></h1>
<p>A regular macOS filelisting. <code>artemis</code> uses the
<a href="https://crates.io/crates/walkdir">walkdir</a> crate to recursively walk the files
and directories on the system. This artifact will fail on any System Integrity
Protection (SIP) protected files. Since a filelisting can be extremely large
every 100k entries <code>artemis</code> will output the data and then continue.</p>
<p>Other Parsers:</p>
<ul>
<li>Any tool that can recursively list files and directories</li>
</ul>
<p>References:</p>
<ul>
<li>N/A</li>
</ul>
<h1 id="toml-collection-26"><a class="header" href="#toml-collection-26">TOML Collection</a></h1>
<pre><code class="language-toml">system = &quot;macos&quot;

[output]
name = &quot;files_collection&quot;
directory = &quot;./tmp&quot;
format = &quot;json&quot;
compress = false
endpoint_id = &quot;abdc&quot;
collection_id = 1
output = &quot;local&quot;

[[artifacts]]
artifact_name = &quot;files&quot; # Name of artifact
[artifacts.files]
start_path = &quot;/usr/bin&quot; # Start of file listing
# Optional
depth = 5 # How many sub directories to descend
# Optional
metadata = true # Get executable metadata
# Optional
md5 = true # MD5 all files
# Optional
sha1 = false # SHA1 all files
# Optional
sha256 = false # SHA256 all files
# Optional
path_regex = &quot;&quot; # Regex for paths
# Optional
file_regex = &quot;&quot; # Regex for files
</code></pre>
<h1 id="collection-options-25"><a class="header" href="#collection-options-25">Collection Options</a></h1>
<ul>
<li><code>start_path</code> Where to start the file listing. Must exist on the endpoint. To
start at root use <code>/</code>. This configuration is <strong>required</strong></li>
<li><code>depth</code> Specify how many directories to descend from the <code>start_path</code>. Default
is one (1). Must be a postive number. Max value is 255. This configuration is
<strong>optional</strong></li>
<li><code>metadata</code> Get <a href="artifacts/macos/macho.html">Macho</a> data from <code>Macho</code> files. This configuration
is <strong>optional</strong>. Default is <strong>false</strong></li>
<li><code>md5</code> Boolean value to enable MD5 hashing on all files. This configuration is
<strong>optional</strong>. Default is <strong>false</strong></li>
<li><code>sha1</code> Boolean value to enable SHA1 hashing on all files. This configuration
is <strong>optional</strong>. Default is <strong>false</strong></li>
<li><code>sha256</code> Boolean value to enable SHA256 hashing on all files. This
configuration is <strong>optional</strong>. Default is <strong>false</strong></li>
<li><code>path_regex</code> Only descend into paths (directories) that match the provided
regex. This configuration is <strong>optional</strong>. Default is no Regex</li>
<li><code>file_regex</code> Only return entres that match the provided regex. This
configuration is <strong>optional</strong>. Default is no Regex</li>
</ul>
<h1 id="output-structure-26"><a class="header" href="#output-structure-26">Output Structure</a></h1>
<p>An array of <code>MacosFileInfo</code> entries</p>
<pre><code class="language-typescript">export interface MacosFileInfo {
  /**Full path to file or directory */
  full_path: string;
  /**Directory path */
  directory: string;
  /**Filename */
  filename: string;
  /**Extension of file if any */
  extension: string;
  /**Created timestamp in UNIXEPOCH seconds */
  created: number;
  /**Modified timestamp in UNIXEPOCH seconds */
  modified: number;
  /**Changed timestamp in UNIXEPOCH seconds */
  changed: number;
  /**Accessed timestamp in UNIXEPOCH seconds */
  accessed: number;
  /**Size of file in bytes */
  size: number;
  /**Inode associated with entry */
  inode: number;
  /**Mode of file entry */
  mode: number;
  /**User ID associated with file */
  uid: number;
  /**Group ID associated with file */
  gid: number;
  /**MD5 of file */
  md5: string;
  /**SHA1 of file */
  sha1: string;
  /**SHA256 of file */
  sha256: string;
  /**Is the entry a file */
  is_file: boolean;
  /**Is the entry a directory */
  is_directory: boolean;
  /**Is the entry a symbolic links */
  is_symlink: boolean;
  /**Depth the file from provided start point */
  depth: number;
  /**Macho binary metadata */
  binary_info: MachoInfo[];
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="fsevents"><a class="header" href="#fsevents">Fsevents</a></h1>
<p>macOS Filesystem Events (<code>FsEvents</code>) track changes to files on a macOS system
(similar to <code>UsnJrnl</code> on Windows). Parsing this data can sometimes show files
that have been deleted. Resides at <code>/System/Volumes/Data/.fseventsd/</code> or
<code>/.fseventsd</code> on older systems. <code>artemis</code> will try to parse both locations by
default.</p>
<p>Other Parsers:</p>
<ul>
<li><a href="https://docs.velociraptor.app/artifact_references/pages/macos.forensics.fsevents/">Velociraptor</a></li>
</ul>
<p>References:</p>
<ul>
<li><a href="https://github.com/libyal/dtformats/blob/main/documentation/MacOS%20File%20System%20Events%20Disk%20Log%20Stream%20format.asciidoc">Libyal</a></li>
</ul>
<h1 id="toml-collection-27"><a class="header" href="#toml-collection-27">TOML Collection</a></h1>
<pre><code class="language-toml">system = &quot;macos&quot;

[output]
name = &quot;fsevents_collection&quot;
directory = &quot;./tmp&quot;
format = &quot;json&quot;
compress = false
endpoint_id = &quot;abdc&quot;
collection_id = 1
output = &quot;local&quot;

[[artifacts]]
artifact_name = &quot;fseventsd&quot;
</code></pre>
<h1 id="collection-options-26"><a class="header" href="#collection-options-26">Collection Options</a></h1>
<ul>
<li>N/A</li>
</ul>
<h1 id="output-structure-27"><a class="header" href="#output-structure-27">Output Structure</a></h1>
<p>An array of <code>Fsevents</code> entries</p>
<pre><code class="language-typescript">export interface Fsevents {
  /**Flags associated with FsEvent record */
  flags: string[];
  /**Full path to file associated with FsEvent record */
  path: string;
  /**Node ID associated with FsEvent record */
  node: number;
  /**Event ID associated with FsEvent record */
  event_id: number;
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="groups"><a class="header" href="#groups">Groups</a></h1>
<p>Gets group info parsing the <code>plist</code> files at
<code>/var/db/dslocal/nodes/Default/groups</code>.</p>
<p>Other Parsers:</p>
<ul>
<li>Any tool that can parse a <code>plist</code> file</li>
</ul>
<p>References:</p>
<ul>
<li>N/A</li>
</ul>
<h1 id="toml-collection-28"><a class="header" href="#toml-collection-28">TOML Collection</a></h1>
<pre><code class="language-toml">system = &quot;macos&quot;

[output]
name = &quot;groups_collection&quot;
directory = &quot;./tmp&quot;
format = &quot;json&quot;
compress = false
endpoint_id = &quot;abdc&quot;
collection_id = 1
output = &quot;local&quot;

[[artifacts]]
artifact_name = &quot;groups&quot;
</code></pre>
<h1 id="collection-options-27"><a class="header" href="#collection-options-27">Collection Options</a></h1>
<ul>
<li>N/A</li>
</ul>
<h1 id="output-structure-28"><a class="header" href="#output-structure-28">Output Structure</a></h1>
<p>An array of <code>Groups</code> entries</p>
<pre><code class="language-typescript">export interface Groups {
  /**GID for the group */
  gid: string[];
  /**Name of the group */
  name: string[];
  /**Real name associated with the group */
  real_name: string[];
  /**Users associated with group */
  users: string[];
  /**Group members in the group */
  groupmembers: string[];
  /**UUID associated with the group */
  uuid: string[];
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="launchd"><a class="header" href="#launchd">Launchd</a></h1>
<p>macOS launch daemons (<code>launchd</code>) are the most common way to register
applications for persistence on macOS. <code>launchd</code> can be registered for a singler
user or system wide. <code>artemis</code> will try to parse all known<code>launchd</code> locations by
default.</p>
<ul>
<li><code>/Users/%/Library/LaunchDaemons/</code></li>
<li><code>/Users/%/Library/LaunchAgents/</code></li>
<li><code>/System/Library/LaunchDaemons/</code></li>
<li><code>/Library/Apple/System/Library/LaunchDaemons/</code></li>
<li><code>/System/Library/LaunchAgents/</code></li>
<li><code>/Library/Apple/System/Library/LaunchAgents/</code></li>
</ul>
<p>Other Parsers:</p>
<ul>
<li>Any tool that can parse a <code>plist</code> file</li>
</ul>
<p>References:</p>
<ul>
<li><a href="https://www.launchd.info/">launchd</a></li>
<li><code>man launchd.plist</code></li>
</ul>
<h1 id="toml-collection-29"><a class="header" href="#toml-collection-29">TOML Collection</a></h1>
<pre><code class="language-toml">system = &quot;macos&quot;

[output]
name = &quot;launchd_collection&quot;
directory = &quot;./tmp&quot;
format = &quot;json&quot;
compress = false
endpoint_id = &quot;abdc&quot;
collection_id = 1
output = &quot;local&quot;

[[artifacts]]
artifact_name = &quot;launchd&quot;
</code></pre>
<h1 id="collection-options-28"><a class="header" href="#collection-options-28">Collection Options</a></h1>
<ul>
<li>N/A</li>
</ul>
<h1 id="output-structure-29"><a class="header" href="#output-structure-29">Output Structure</a></h1>
<p>An array of <code>Launchd</code> entries</p>
<pre><code class="language-typescript">export interface Launchd {
  /**JSON representation of launchd plist contents */
  launchd_data: Record&lt;string, unknown&gt;;
  /**Full path of the plist file */
  plist_path: string;
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="loginitems"><a class="header" href="#loginitems">Loginitems</a></h1>
<p>macOS <code>LoginItems</code> are a form of persistence on macOS systems. They are
triggered when a user logs on to the system. They are located at:</p>
<ul>
<li><code>/Users/%/Library/Application Support/com.apple.backgroundtaskmanagementagent/backgrounditems.btm</code>
(pre-Ventura)</li>
<li><code>/var/db/com.apple.backgroundtaskmanagement/BackgroundItems-v4.btm</code> (Ventura+)
<br />
Both are <code>plist</code> files, however the actual <code>LoginItem</code> data is in an
additional binary format known as a <code>Bookmark</code> that needs to be parsed.</li>
</ul>
<p>Other Parsers:</p>
<ul>
<li><a href="https://mac-alias.readthedocs.io/en/latest/index.html">Bookmarks</a></li>
</ul>
<p>References:</p>
<ul>
<li><a href="https://www.sentinelone.com/blog/how-malware-persists-on-macos/">macOS Persistence</a></li>
<li><a href="https://michaellynn.github.io/2015/10/24/apples-bookmarkdata-exposed/">Bookmarks</a></li>
</ul>
<h1 id="toml-collection-30"><a class="header" href="#toml-collection-30">TOML Collection</a></h1>
<pre><code class="language-toml">system = &quot;macos&quot;

[output]
name = &quot;loginitems_collection&quot;
directory = &quot;./tmp&quot;
format = &quot;json&quot;
compress = false
endpoint_id = &quot;abdc&quot;
collection_id = 1
output = &quot;local&quot;

[[artifacts]]
artifact_name = &quot;loginitems&quot;
</code></pre>
<h1 id="collection-options-29"><a class="header" href="#collection-options-29">Collection Options</a></h1>
<ul>
<li>N/A</li>
</ul>
<h1 id="output-structure-30"><a class="header" href="#output-structure-30">Output Structure</a></h1>
<p>An array of <code>LoginItem</code> entries</p>
<pre><code class="language-typescript">export interface LoginItems {
  /**Path to file to run */
  path: string[];
  /**Path represented as Catalog Node ID */
  cnid_path: number[];
  /**Created timestamp of target file in UNIXEPOCH seconds */
  created: number;
  /**Path to the volume of target file */
  volume_path: string;
  /**Target file URL type */
  volume_url: string;
  /**Name of volume target file is on */
  volume_name: string;
  /**Volume UUID */
  volume_uuid: string;
  /**Size of target volume in bytes */
  volume_size: number;
  /**Created timestamp of volume in UNIXEPOCH seconds */
  volume_created: number;
  /**Volume Property flags */
  volume_flag: number[];
  /**Flag if volume if the root filesystem */
  volume_root: boolean;
  /**Localized name of target file */
  localized_name: string;
  /**Read-Write security extension of target file */
  security_extension_rw: string;
  /**Read-Only security extension of target file */
  security_extension_ro: string;
  /**File property flags */
  target_flags: number[];
  /**Username associated with `Bookmark` */
  username: string;
  /**Folder index number associated with target file */
  folder_index: number;
  /**UID associated with `LoginItem` */
  uid: number;
  /**`LoginItem` creation flags */
  creation_options: number;
  /**Is `LoginItem` bundled in app */
  is_bundled: boolean;
  /**App ID associated with `LoginItem` */
  app_id: string;
  /**App binary name */
  app_binary: string;
  /**Is target file executable */
  is_executable: boolean;
  /**Does target file have file reference flag */
  file_ref_flag: boolean;
  /**Path to `LoginItem` source */
  source_path: string;
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="macho"><a class="header" href="#macho">Macho</a></h1>
<p>macOS Mach object (<code>macho</code>) is the executable format for applications on macOS.
<code>artemis</code> is able to parse basic metadata from <code>macho</code> files.</p>
<p>Other Parsers:</p>
<ul>
<li><a href="https://rada.re/n/">radare2</a></li>
<li><a href="https://lief-project.github.io/">LIEF</a></li>
<li><a href="https://github.com/horsicq/XMachOViewer">XMachOView</a></li>
</ul>
<p>References:</p>
<ul>
<li><a href="https://lief-project.github.io/">LIEF</a></li>
<li><a href="https://github.com/aidansteele/osx-abi-macho-file-format-reference">Macho</a></li>
</ul>
<h1 id="toml-collection-31"><a class="header" href="#toml-collection-31">TOML Collection</a></h1>
<p>There is no way to collect just <code>macho</code> data with <code>artemis</code> instead it is an
optional feature for the macOS <code>filelisting</code> and <code>processes</code> artifacts.<br />
However, it is possible to directly parse <code>macho</code> files by using <code>JavaScript</code>.
See the <a href="artifacts/macos/../../examples/scripts.html">scripts</a> chapter for examples.</p>
<h1 id="configuration-optaions"><a class="header" href="#configuration-optaions">Configuration Optaions</a></h1>
<p>N/A</p>
<h1 id="output-structure-31"><a class="header" href="#output-structure-31">Output Structure</a></h1>
<p>An array of <code>macho</code> entries</p>
<pre><code class="language-typescript">export interface MachoInfo {
  /**CPU arch */
  cpu_type: string;
  /**CPU model */
  cpu_subtype: string;
  /**File type, ex: executable, dylib, object, core, etc*/
  filetype: string;
  /**Segments of the macho binary */
  sgements: Segment64[];
  /**Dynamic libraries in the macho binary */
  dylib_commands: DylibCommand[];
  /**Macho binary id */
  id: string;
  /**Macho team id */
  team_id: string;
  /**Parsed out macho entitlements from plist */
  entitlements: Record&lt;string, unknown&gt;;
  /**Base64 encoded embedded certs within the binary */
  certs: string;
  /**Minium OS binary can run on */
  minos: string;
  /**SDK version macho was compiled for */
  sdk: string;
}

/**
 * Metadata about macho Segments
 */
export interface Segment64 {
  /**Name of segment */
  name: string;
  /**Virtual memory address */
  vmaddr: number;
  /**Virtual memory size */
  vmsize: number;
  /**Offset in the macho binary */
  file_offset: number;
  /**Size of segment */
  file_size: number;
  /**Maxmimum permitted memory protection */
  max_prot: number;
  /**Initial memory protection */
  init_prot: number;
  /**Number of sections in the semgent */
  nsects: number;
  /**Segment flags */
  flags: number;
  /**Array of section data */
  sections: Sections[];
}

/**
 * Metadata about macho Sections
 */
export interface Sections {
  /**Name of section */
  section_name: string;
  /**Name of segment the section belongs to */
  segment_name: string;
  /**Virtual memory address */
  addr: number;
  /**Size of section */
  size: number;
  /**Section offset in file */
  offset: number;
  /**Section byte alignment */
  align: number;
  /**File offset to relocation entries */
  relocation_offset: number;
  /**Number of relocation entries */
  number_relocation_entries: number;
  /**Flags related to the section */
  flags: number;
  /**Reserved */
  reserved: number;
  /**Reserved */
  reserved2: number;
  /**Reserved */
  reserved3: number;
}

/**
 * Metadata about macho dylibcommand
 */
export interface DylibCommand {
  /**Name of dynamic library */
  name: string;
  /**Timestamp when the library was build */
  timestamp: number;
  /**Version of dynamic library */
  current_version: number;
  /**Compatiblity version of dynamic library */
  compatibility_version: string;
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="plist"><a class="header" href="#plist">Plist</a></h1>
<p>macOS property lists (<code>plist</code>) are the primary format for application
configurations. The contents of <code>plists</code> can be: xml, json, or binary. XML is
most common.</p>
<h1 id="toml-collection-32"><a class="header" href="#toml-collection-32">TOML Collection</a></h1>
<p>There is no way to collect <code>plist</code> data with <code>artemis</code> instead it is an feature
for scripting. See the <a href="artifacts/macos/../../examples/scripts.html">scripts</a> chapter for
examples.</p>
<h1 id="configuration-optaions-1"><a class="header" href="#configuration-optaions-1">Configuration Optaions</a></h1>
<p>N/A</p>
<h1 id="output-structure-32"><a class="header" href="#output-structure-32">Output Structure</a></h1>
<p>A JSON representation of the <code>plist</code> contents</p>
<pre><code class="language-typescript">Record&lt;String, unknown&gt;;
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="processes-1"><a class="header" href="#processes-1">Processes</a></h1>
<p>Gets a standard process listing using the macOS API</p>
<p>Other Parsers:</p>
<ul>
<li>Any tool that calls the macOS API</li>
</ul>
<p>References:</p>
<ul>
<li>N/A</li>
</ul>
<h1 id="toml-collection-33"><a class="header" href="#toml-collection-33">TOML Collection</a></h1>
<pre><code class="language-toml">system = &quot;macos&quot;

[output]
name = &quot;process_collection&quot;
directory = &quot;./tmp&quot;
format = &quot;jsonl&quot;
compress = false
endpoint_id = &quot;abdc&quot;
collection_id = 1
output = &quot;local&quot;

[[artifacts]]
artifact_name = &quot;processes&quot; # Name of artifact
[artifacts.processes]
# Get executable metadata
metadata = true 
# MD5 hash process binary
md5 = true 
 # SHA1 hash process binary
sha1 = false
# SHA256 hash process binary
sha256 = false
</code></pre>
<h1 id="collection-options-30"><a class="header" href="#collection-options-30">Collection Options</a></h1>
<ul>
<li><code>metadata</code> Get <a href="artifacts/macos/macho.html">Macho</a> data from process binary.</li>
<li><code>md5</code> Boolean value to MD5 hash process binary</li>
<li><code>sha1</code> Boolean value to SHA1 hash process binary</li>
<li><code>sha256</code> Boolean value to SHA256 hash process binary</li>
</ul>
<h1 id="output-structure-33"><a class="header" href="#output-structure-33">Output Structure</a></h1>
<p>An array of <code>MacosProcessInfo</code> entries</p>
<pre><code class="language-typescript">export interface MacosProcessInfo {
  /**Full path to the process binary */
  full_path: string;
  /**Name of process */
  name: string;
  /**Path to process binary */
  path: string;
  /** Process ID */
  pid: number;
  /** Parent Process ID */
  ppid: number;
  /**Environment variables associated with process */
  environment: string;
  /**Status of the process */
  status: string;
  /**Process arguments */
  arguments: string;
  /**Process memory usage */
  memory_usage: number;
  /**Process virtual memory usage */
  virtual_memory_usage: number;
  /**Process start time in UNIXEPOCH seconds*/
  start_time: number;
  /** User ID associated with process */
  uid: string;
  /**Group ID associated with process */
  gid: string;
  /**MD5 hash of process binary */
  md5: string;
  /**SHA1 hash of process binary */
  sha1: string;
  /**SHA256 hash of process binary */
  sha256: string;
  /**MACHO metadata asssociated with process binary */
  binary_info: MachoInfo[];
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="shell-history"><a class="header" href="#shell-history">Shell History</a></h1>
<p>Many Unix and Linux like systems provide a shell interface that allows a user to
execute a command or application. Many of these shell interfaces keep a record
of the command executed and depending on the configuration the timestamp when
the command was executed. Popular shells include:</p>
<ul>
<li>bash</li>
<li>zsh</li>
<li>fish</li>
<li>sh</li>
<li>PowerShell</li>
</ul>
<p><code>Artemis</code> supports parsing <code>zsh</code> and <code>bash</code> shell history. In addition, it
supports parsing <code>Python</code> history (despite not being a shell).</p>
<p>Other parsers:</p>
<ul>
<li>Any program that read a text file</li>
</ul>
<p>References:</p>
<ul>
<li><a href="https://linuxhint.com/bash_command_history_usage/">Bash</a></li>
<li><a href="https://www.soberkoder.com/better-zsh-history/">Zsh</a></li>
</ul>
<h1 id="toml-collection-34"><a class="header" href="#toml-collection-34">TOML Collection</a></h1>
<pre><code class="language-toml">system = &quot;macos&quot; # or &quot;linux&quot;

[output]
name = &quot;shellhistory_collection&quot;
directory = &quot;./tmp&quot;
format = &quot;json&quot;
compress = false
endpoint_id = &quot;abdc&quot;
collection_id = 1
output = &quot;local&quot;

[[artifacts]]
artifact_name = &quot;shell_history&quot;
</code></pre>
<h1 id="collection-options-31"><a class="header" href="#collection-options-31">Collection Options</a></h1>
<ul>
<li>N/A</li>
</ul>
<h1 id="output-structure-34"><a class="header" href="#output-structure-34">Output Structure</a></h1>
<p>An array of <code>BashHistory</code> for <code>bash</code> data, <code>ZshHistory</code> for <code>zsh</code> data, and
<code>PythonHistory</code> for <code>Python</code> data per user.</p>
<pre><code class="language-typescript">export interface BashHistory {
  /**Array of lines associated with `.bash_history` file */
  history: BashData[];
  /**Path to `.bash_history` file */
  path: string;
  /**User directory name */
  user: string;
}

/**
 * History data associated with `.bash_history`
 */
export interface BashData {
  /**Line entry */
  history: string;
  /**Timestamp associated with line entry in UNIXEPOCH. Timestamps are **optional** in `.bash_history`, zero (0) is returned for no timestamp */
  timestamp: number;
  /**Line number */
  line: number;
}

export interface ZshHistory {
  /**Array of lines associated with `.zs_history` file */
  history: ZshData[];
  /**Path to `.bash_history` file */
  path: string;
  /**User directory name */
  user: string;
}

/**
 * History data associated with `.zsh_history`
 */
export interface ZshData {
  /**Line entry */
  history: string;
  /**Timestamp associated with line entry in UNIXEPOCH. Timestamps are **optional** in `.zsh_history`, zero (0) is returned for no timestamp */
  timestamp: number;
  /**Line number */
  line: number;
  /**Duration of command */
  duration: number;
}

export interface PythonHistory {
  /**Array of lines associated with `.python_history` file */
  history: PythonData[];
  /**Path to `.python_history` file */
  path: string;
  /**User directory name */
  user: string;
}

/**
 * History data associated with `.python_history`
 */
export interface PythonData {
  /**Line entry */
  history: string;
  /**Line number */
  line: number;
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="sudo-logs"><a class="header" href="#sudo-logs">Sudo Logs</a></h1>
<p>Unix <code>SudoLogs</code> are the log files associated with sudo execution. Sudo (&quot;super
user do&quot; or &quot;substitute user&quot;) is used to run programs with elevated
privileges.<br />
macOS <code>SudoLogs</code> are stored in the Unified Log files.<br />
Linux <code>SudoLogs</code> are stored in the Systemd Journal files.<br />
The log entries show evidence of commands executed with elevated privileges</p>
<p>Other Parsers:</p>
<ul>
<li>None</li>
</ul>
<p>References:</p>
<ul>
<li>N/A</li>
</ul>
<h1 id="toml-collection-35"><a class="header" href="#toml-collection-35">TOML Collection</a></h1>
<pre><code class="language-toml">system = &quot;maco&quot; # or &quot;linux&quot;

[output]
name = &quot;sudologs_collection&quot;
directory = &quot;./tmp&quot;
format = &quot;json&quot;
compress = false
endpoint_id = &quot;abdc&quot;
collection_id = 1
output = &quot;local&quot;

[[artifacts]]
artifact_name = &quot;sudologs&quot;
</code></pre>
<h1 id="collection-options-32"><a class="header" href="#collection-options-32">Collection Options</a></h1>
<ul>
<li>N/A</li>
</ul>
<h1 id="output-structure-35"><a class="header" href="#output-structure-35">Output Structure</a></h1>
<p>On a macOS system <code>sudologs</code> return an array of <code>UnifiedLog</code> entries</p>
<pre><code class="language-typescript">export interface UnifiedLog {
  /**Subsystem used by the log entry */
  subsystem: string;
  /**Library associated with the log entry */
  library: string;
  /**Log entry category */
  category: string;
  /**Process ID associated with log entry */
  pid: number;
  /**Effective user ID associated with log entry */
  euid: number;
  /**Thread ID associated with log entry */
  thread_id: number;
  /**Activity ID associated with log entry */
  activity_id: number;
  /**UUID of library associated with the log entry */
  library_uuid: string;
  /**UNIXEPOCH timestamp of log entry in nanoseconds */
  time: number;
  /**Log entry event type */
  event_type: string;
  /**Log entry log type */
  log_type: string;
  /**Process associated with log entry */
  process: string;
  /**UUID of process associated with log entry */
  process_uuid: string;
  /**Raw string message  associated with log entry*/
  raw_message: string;
  /**Boot UUID associated with log entry */
  boot_uuid: string;
  /**Timezone associated with log entry */
  timezone_name: string;
  /**Strings associated with the log entry */
  mesage_entries: Record&lt;string, string | number&gt;;
  /**
   * Resolved message entry associated log entry.
   * Merge of `raw_message` and `message_entries`
   */
  message: string;
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="systeminfo-1"><a class="header" href="#systeminfo-1">SystemInfo</a></h1>
<p>Gets system metadata associated with the endpoint</p>
<p>Other Parsers:</p>
<ul>
<li>Any tool that calls the macOS API or queries system information</li>
</ul>
<p>Refernces:</p>
<ul>
<li>N/A</li>
</ul>
<h1 id="toml-collection-36"><a class="header" href="#toml-collection-36">TOML Collection</a></h1>
<pre><code class="language-toml">system = &quot;macos&quot;

[output]
name = &quot;systeminfo_collection&quot;
directory = &quot;./tmp&quot;
format = &quot;json&quot;
compress = false
endpoint_id = &quot;abdc&quot;
collection_id = 1
output = &quot;local&quot;

[[artifacts]]
artifact_name = &quot;systeminfo&quot;
</code></pre>
<h1 id="collection-options-33"><a class="header" href="#collection-options-33">Collection Options</a></h1>
<ul>
<li>N/A</li>
</ul>
<h1 id="output-structure-36"><a class="header" href="#output-structure-36">Output Structure</a></h1>
<p>A <code>SystemInfo</code> object structure</p>
<pre><code class="language-typescript">export interface SystemInfo {
  /**Boot time for endpoint */
  boot_time: number;
  /**Endpoint hostname */
  hostname: string;
  /**Endpoint OS version */
  os_version: string;
  /**Uptime of endpoint */
  uptime: number;
  /**Endpoint kernel version */
  kernel_version: string;
  /**Endpoint platform */
  platform: string;
  /**CPU information */
  cpu: Cpus[];
  /**Disks information */
  disks: Disks[];
  /**Memory information */
  memory: Memory;
  /**Performance information */
  performance: LoadPerformance;
}

/**
 * CPU information on endpoint
 */
export interface Cpus {
  /**CPU frequency */
  frequency: number;
  /**CPU usage on endpoint */
  cpu_usage: number;
  /**Name of CPU */
  name: string;
  /**Vendor ID for CPU */
  vendor_id: string;
  /**CPU brand */
  brand: string;
  /**Core Count */
  physical_core_count: number;
}

/**
 * Disk information on endpoint
 */
export interface Disks {
  /**Type of disk */
  disk_type: string;
  /**Filesystem for disk */
  file_system: string;
  /**Disk mount point */
  mount_point: string;
  /**Disk storage */
  total_space: number;
  /**Storage remaining */
  available_space: number;
  /**If disk is removable */
  removable: boolean;
}

/**
 * Memory information on endpoint
 */
export interface Memory {
  /**Available memory on endpoint */
  available_memory: number;
  /**Free memory on endpoint */
  free_memory: number;
  /**Free swap on endpoint */
  free_swap: number;
  /**Total memory on endpoint */
  total_memory: number;
  /**Total swap on endpoint */
  total_swap: number;
  /**Memory in use */
  used_memory: number;
  /**Swap in use */
  used_swap: number;
}

/**
 * Average CPU load
 */
export interface LoadPerformance {
  /**Average load for one (1) min */
  avg_one_min: number;
  /**Average load for five (5) min */
  avg_five_min: number;
  /**Average load for fifteen (15) min */
  avg_fifteen_min: number;
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="unifiedlogs"><a class="header" href="#unifiedlogs">UnifiedLogs</a></h1>
<p>macOS <code>unifiedlogs</code> are the primary files associated with logging system
activity. They are stored in a binary format at <code>/var/db/diagnostics/</code>.</p>
<p>Other Parsers:</p>
<ul>
<li><a href="https://github.com/ydkhatri/UnifiedLogReader">UnifiedLogReader</a> (Only partial
support)</li>
</ul>
<p>References:</p>
<ul>
<li><a href="https://eclecticlight.co/2018/03/19/macos-unified-log-1-why-what-and-how/">Unified Logging</a></li>
<li><a href="https://www.mandiant.com/resources/blog/reviewing-macos-unified-logs">Reviewing logs</a></li>
<li><a href="https://www.crowdstrike.com/blog/how-to-leverage-apple-unified-log-for-incident-response/">Reviewing more logs</a></li>
</ul>
<h1 id="toml-collection-37"><a class="header" href="#toml-collection-37">TOML Collection</a></h1>
<pre><code class="language-toml">system = &quot;macos&quot;

[output]
name = &quot;unifiedlogs_collection&quot;
directory = &quot;./tmp&quot;
format = &quot;json&quot;
compress = false
endpoint_id = &quot;abdc&quot;
collection_id = 1
output = &quot;local&quot;

[[artifacts]]
artifact_name = &quot;unifiedlogs&quot;
[artifacts.unifiedlogs]
sources = [&quot;Special&quot;]
</code></pre>
<h1 id="collection-options-34"><a class="header" href="#collection-options-34">Collection Options</a></h1>
<ul>
<li><code>sources</code> List of directories that should be included when parsing the
<code>unifiedlogs</code>. These directories are found at <code>/var/db/diagnostics/</code>. Only the
following directories contain logs:
<ul>
<li>Persist</li>
<li>Special</li>
<li>Signpost</li>
<li>HighVolume</li>
</ul>
</li>
</ul>
<p>To parse all logs you would use
<code>sources = [&quot;Special&quot;, &quot;Persist&quot;, &quot;Signpost&quot;, &quot;HighVolume&quot;]</code></p>
<h1 id="output-structure-37"><a class="header" href="#output-structure-37">Output Structure</a></h1>
<p>An array of <code>UnifiedLog</code> entries</p>
<pre><code class="language-typescript">export interface UnifiedLog {
  /**Subsystem used by the log entry */
  subsystem: string;
  /**Library associated with the log entry */
  library: string;
  /**Log entry category */
  category: string;
  /**Process ID associated with log entry */
  pid: number;
  /**Effective user ID associated with log entry */
  euid: number;
  /**Thread ID associated with log entry */
  thread_id: number;
  /**Activity ID associated with log entry */
  activity_id: number;
  /**UUID of library associated with the log entry */
  library_uuid: string;
  /**UNIXEPOCH timestamp of log entry in nanoseconds */
  time: number;
  /**Log entry event type */
  event_type: string;
  /**Log entry log type */
  log_type: string;
  /**Process associated with log entry */
  process: string;
  /**UUID of process associated with log entry */
  process_uuid: string;
  /**Raw string message  associated with log entry*/
  raw_message: string;
  /**Boot UUID associated with log entry */
  boot_uuid: string;
  /**Timezone associated with log entry */
  timezone_name: string;
  /**Strings associated with the log entry */
  mesage_entries: Record&lt;string, string | number&gt;;
  /**
   * Resolved message entry associated log entry.
   * Merge of `raw_message` and `message_entries`
   */
  message: string;
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="users-1"><a class="header" href="#users-1">Users</a></h1>
<p>Gets user info parsing the <code>plist</code> files at
<code>/var/db/dslocal/nodes/Default/users</code>.</p>
<p>Other Parsers:</p>
<ul>
<li>Any tool that can parse a <code>plist</code> file</li>
</ul>
<p>References:</p>
<ul>
<li>N/A</li>
</ul>
<h1 id="toml-collection-38"><a class="header" href="#toml-collection-38">TOML Collection</a></h1>
<pre><code class="language-toml">system = &quot;macos&quot;

[output]
name = &quot;users_collection&quot;
directory = &quot;./tmp&quot;
format = &quot;json&quot;
compress = false
endpoint_id = &quot;abdc&quot;
collection_id = 1
output = &quot;local&quot;

[[artifacts]]
artifact_name = &quot;users&quot;
</code></pre>
<h1 id="collection-options-35"><a class="header" href="#collection-options-35">Collection Options</a></h1>
<ul>
<li>N/A</li>
</ul>
<h1 id="output-structure-38"><a class="header" href="#output-structure-38">Output Structure</a></h1>
<p>An array of <code>Users</code> entries</p>
<pre><code class="language-typescript">export interface Users {
  /**UID for the user */
  uid: string[];
  /**GID associated with the user */
  gid: string[];
  /**User name */
  name: string[];
  /**Real name associated with user */
  real_name: string[];
  /**Base64 encoded photo associated with user */
  account_photo: string[];
  /**Timestamp the user was created in UNIXEPOCH seconds */
  account_created: number;
  /**Password last changed for the user in UNIXEPOCH seconds */
  password_last_set: number;
  /**Shell associated with the user */
  shell: string[];
  /**Unlock associated with the user */
  unlock_options: string[];
  /**Home path associated with user */
  home_path: string[];
  /**UUID associated with user */
  uuid: string[];
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="linux"><a class="header" href="#linux">Linux</a></h1>
<p>Currently <code>artemis</code> has been tested on Ubuntu 18.04 and higher, Fedora, and Arch Linux. Similar to the Windows and macOS versions a main focus point of the library <code>artemis-core</code> is to make a
best effort to not rely on the macOS APIs. Since <code>artemis-core</code> is a forensic
focused library, we do not want to rely on APIs from a potentially compromised
system.<br />
However, <code>artemis-core</code> does use the Linux API for a handful of artifacts:</p>
<ul>
<li><code>Processes</code> - The <a href="https://github.com/GuillaumeGomez/sysinfo">sysinfo</a> crate
is used to pull a process listing using Linux APIs</li>
<li><code>Systeminfo</code> - The <a href="https://github.com/GuillaumeGomez/sysinfo">sysinfo</a> crate
is also to get system information using Linux APIs</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="cron-1"><a class="header" href="#cron-1">Cron</a></h1>
<p><code>Cron</code> is an application that lets users create jobs on an endpoint. It is
common on Unix, Linux, and macOS systems. A <code>Cron</code> job can be configured to
execute a command on at a specific time. It is a popular form of persistence on
supported systems.</p>
<p>Other parsers:</p>
<ul>
<li>Any program that read a text file</li>
</ul>
<p>Refernces:</p>
<ul>
<li><a href="https://en.wikipedia.org/wiki/Cron">Cron</a></li>
</ul>
<h1 id="toml-collection-39"><a class="header" href="#toml-collection-39">TOML Collection</a></h1>
<pre><code class="language-toml">system = &quot;linux&quot; # or &quot;macos&quot;

[output]
name = &quot;cron_collection&quot;
directory = &quot;./tmp&quot;
format = &quot;json&quot;
compress = false
endpoint_id = &quot;abdc&quot;
collection_id = 1
output = &quot;local&quot;

[[artifacts]]
artifact_name = &quot;cron&quot;
</code></pre>
<h1 id="collection-options-36"><a class="header" href="#collection-options-36">Collection Options</a></h1>
<ul>
<li>N/A</li>
</ul>
<h1 id="output-structure-39"><a class="header" href="#output-structure-39">Output Structure</a></h1>
<p>An array of <code>Cron</code> entries.</p>
<pre><code class="language-typescript">export interface Cron {
  /**What hour should cron job run. * means every hour */
  hour: string;
  /**What minute should cron job run. * means every minute  */
  min: string;
  /**What day should cron job run. * means every day */
  day: string;
  /**What month should cron job run. * means every month */
  month: string;
  /**What weekday should cron job run. * means every day */
  weekday: string;
  /**Command to execute when cron job is triggered */
  command: string;
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="elf"><a class="header" href="#elf">ELF</a></h1>
<p>Linux Executable Linkable Format (<code>ELF</code>) is the executable format for applications on Linux systems.<br />
<code>artemis</code> is able to parse basic metadata from <code>ELF</code> files.</p>
<p>Other Parsers:</p>
<ul>
<li><a href="https://rada.re/n/">radare2</a></li>
<li><a href="https://lief-project.github.io/">LIEF</a></li>
</ul>
<p>References:</p>
<ul>
<li><a href="https://lief-project.github.io/">LIEF</a></li>
<li><a href="https://en.wikipedia.org/wiki/Executable_and_Linkable_Format">ELF</a></li>
</ul>
<h1 id="toml-collection-40"><a class="header" href="#toml-collection-40">TOML Collection</a></h1>
<p>There is no way to collect just <code>ELF</code> data with <code>artemis</code> instead it is an
optional feature for the Linux <code>filelisting</code> and <code>processes</code> artifacts.<br />
However, it is possible to directly parse <code>ELF</code> files by using <code>JavaScript</code>.
See the <a href="artifacts/linux/../../examples/scripts.html">scripts</a> chapter for examples.</p>
<h1 id="configuration-optaions-2"><a class="header" href="#configuration-optaions-2">Configuration Optaions</a></h1>
<p>N/A</p>
<h1 id="output-structure-40"><a class="header" href="#output-structure-40">Output Structure</a></h1>
<p>An array of <code>ElfInfo</code> entries</p>
<pre><code class="language-typescript">export interface ElfInfo {
  /**Array of symbols in ELF binary */
  symbols: string[];
  /**Array of sections in ELF binary */
  sections: string[];
  /**Machine type information in ELF binary */
  machine_type: string;
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="files-2"><a class="header" href="#files-2">Files</a></h1>
<p>A regular Linux filelisting. <code>artemis</code> uses the
<a href="https://crates.io/crates/walkdir">walkdir</a> crate to recursively walk the files
and directories on the system. Since a filelisting can be extremely large every
100k entries <code>artemis</code> will output the data and then continue.</p>
<p>Other Parsers:</p>
<ul>
<li>Any tool that can recursively list files and directories</li>
</ul>
<p>References:</p>
<ul>
<li>N/A</li>
</ul>
<h1 id="toml-collection-41"><a class="header" href="#toml-collection-41">TOML Collection</a></h1>
<pre><code class="language-toml">system = &quot;linux&quot;

[output]
name = &quot;files_collection&quot;
directory = &quot;./tmp&quot;
format = &quot;json&quot;
compress = false
endpoint_id = &quot;abdc&quot;
collection_id = 1
output = &quot;local&quot;

[[artifacts]]
artifact_name = &quot;files&quot; # Name of artifact
[artifacts.files]
start_path = &quot;/usr/bin&quot; # Start of file listing
# Optional
depth = 5 # How many sub directories to descend
# Optional
metadata = true # Get executable metadata
# Optional
md5 = true # MD5 all files
# Optional
sha1 = false # SHA1 all files
# Optional
sha256 = false # SHA256 all files
# Optional
path_regex = &quot;&quot; # Regex for paths
# Optional
file_regex = &quot;&quot; # Regex for files
</code></pre>
<h1 id="collection-options-37"><a class="header" href="#collection-options-37">Collection Options</a></h1>
<ul>
<li><code>start_path</code> Where to start the file listing. Must exist on the endpoint. To
start at root use <code>/</code>. This configuration is <strong>required</strong></li>
<li><code>depth</code> Specify how many directories to descend from the <code>start_path</code>. Default
is one (1). Must be a postive number. Max value is 255. This configuration is
<strong>optional</strong></li>
<li><code>metadata</code> Get <a href="artifacts/linux/elf.html">ELF</a> data from <code>ELF</code> files. This configuration is
<strong>optional</strong>. Default is <strong>false</strong></li>
<li><code>md5</code> Boolean value to enable MD5 hashing on all files. This configuration is
<strong>optional</strong>. Default is <strong>false</strong></li>
<li><code>sha1</code> Boolean value to enable SHA1 hashing on all files. This configuration
is <strong>optional</strong>. Default is <strong>false</strong></li>
<li><code>sha256</code> Boolean value to enable SHA256 hashing on all files. This
configuration is <strong>optional</strong>. Default is <strong>false</strong></li>
<li><code>path_regex</code> Only descend into paths (directories) that match the provided
regex. This configuration is <strong>optional</strong>. Default is no Regex</li>
<li><code>file_regex</code> Only return entres that match the provided regex. This
configuration is <strong>optional</strong>. Default is no Regex</li>
</ul>
<h1 id="output-structure-41"><a class="header" href="#output-structure-41">Output Structure</a></h1>
<p>An array of <code>LinuxFileInfo</code> entries</p>
<pre><code class="language-typescript">export interface LinuxFileInfo {
  /**Full path to file or directory */
  full_path: string;
  /**Directory path */
  directory: string;
  /**Filename */
  filename: string;
  /**Extension of file if any */
  extension: string;
  /**Created timestamp in UNIXEPOCH seconds */
  created: number;
  /**Modified timestamp in UNIXEPOCH seconds */
  modified: number;
  /**Changed timestamp in UNIXEPOCH seconds */
  changed: number;
  /**Accessed timestamp in UNIXEPOCH seconds */
  accessed: number;
  /**Size of file in bytes */
  size: number;
  /**Inode associated with entry */
  inode: number;
  /**Mode of file entry */
  mode: number;
  /**User ID associated with file */
  uid: number;
  /**Group ID associated with file */
  gid: number;
  /**MD5 of file */
  md5: string;
  /**SHA1 of file */
  sha1: string;
  /**SHA256 of file */
  sha256: string;
  /**Is the entry a file */
  is_file: boolean;
  /**Is the entry a directory */
  is_directory: boolean;
  /**Is the entry a symbolic links */
  is_symlink: boolean;
  /**Depth the file from provided start point */
  depth: number;
  /**ELF binary metadata */
  binary_info: ElfInfo[];
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="journals"><a class="header" href="#journals">Journals</a></h1>
<p>Linux <code>Journals</code> are the log files associated with the systemd service. Systemd
is a popular system service that is common on most Linux distros. The logs can
contain data related to application activity, sudo commands, and much more.</p>
<p>Other Parsers:</p>
<ul>
<li>None</li>
</ul>
<p>References:</p>
<ul>
<li><a href="https://systemd.io/JOURNAL_FILE_FORMAT/">Journal format</a></li>
<li><a href="https://wiki.archlinux.org/title/Systemd/Journal">Arch Wiki</a></li>
</ul>
<h1 id="toml-collection-42"><a class="header" href="#toml-collection-42">TOML Collection</a></h1>
<pre><code class="language-toml">system = &quot;linux&quot;

[output]
name = &quot;journals_collection&quot;
directory = &quot;./tmp&quot;
format = &quot;json&quot;
compress = false
endpoint_id = &quot;abdc&quot;
collection_id = 1
output = &quot;local&quot;

[[artifacts]]
artifact_name = &quot;journals&quot;
</code></pre>
<h1 id="collection-options-38"><a class="header" href="#collection-options-38">Collection Options</a></h1>
<ul>
<li>N/A</li>
</ul>
<h1 id="output-structure-42"><a class="header" href="#output-structure-42">Output Structure</a></h1>
<p>An array of <code>Journal</code> entries</p>
<pre><code class="language-typescript">export interface Journal {
  /**User ID associated with entry */
  uid: number;
  /**Group ID associated with entry */
  gid: number;
  /**Process ID associated with entry */
  pid: number;
  /**Thread ID associated with entry */
  thread_id: number;
  /**Command associated with entry */
  comm: string;
  /**Priority associated with entry */
  priority: string;
  /**Syslog facility associated with entry */
  syslog_facility: string;
  /**Executable file associated with entry */
  executable: string;
  /**Cmdline args associated with entry */
  cmdline: string;
  /**Effective capabilities of process associated with entry */
  cap_effective: string;
  /**Session of the process associated with entry */
  audit_session: number;
  /**Login UID of the process associated with entry */
  audit_loginuid: number;
  /**Systemd Countrol Group associated with entry */
  systemd_cgroup: string;
  /**Systemd owner UID associated with entry */
  systemd_owner_uid: number;
  /**Systemd unit associated with entry */
  systemd_unit: string;
  /**Systemd user unit associated with entry */
  systemd_user_unit: string;
  /**Systemd slice associated with entry */
  systemd_slice: string;
  /**Sysemd user slice associated with entry */
  systemd_user_slice: string;
  /**Systemd invocation ID associated with entry */
  systemd_invocation_id: string;
  /**Kernel Boot ID associated with entry */
  boot_id: string;
  /**Machine ID of host associated with entry */
  machine_id: string;
  /**Hostname associated with entry */
  hostname: string;
  /**Runtime scope associated with entry */
  runtime_scope: string;
  /**Trused Timestamp associated with entry in UNIXEPOCH microseconds */
  source_realtime: number;
  /**Timestamp associated with entry in UNIXEPOCH microseconds */
  realtime: number;
  /**How entry was received by the Journal service */
  transport: string;
  /**Journal message entry */
  message: string;
  /**Message ID associated with Journal Catalog */
  message_id: string;
  /**Unit result associated with entry */
  unit_result: string;
  /**Code line for file associated with entry */
  code_line: number;
  /**Code function for file associated with entry */
  code_function: string;
  /**Code file associated with entry */
  code_file: string;
  /**User invocation ID associated with entry */
  user_invocation_id: string;
  /**User unit associated with entry */
  user_unit: string;
  /**
   * Custom fields associated with entry.
   * Example:
   * ```
   * &quot;custom&quot;: {
   *            &quot;_SOURCE_MONOTONIC_TIMESTAMP&quot;: &quot;536995&quot;,
   *            &quot;_UDEV_SYSNAME&quot;: &quot;0000:00:1c.3&quot;,
   *            &quot;_KERNEL_DEVICE&quot;: &quot;+pci:0000:00:1c.3&quot;,
   *            &quot;_KERNEL_SUBSYSTEM&quot;: &quot;pci&quot;
   *        }
   * ```
   */
  custom: Record&lt;string, string&gt;;
  /**Sequence Number associated with entry */
  seqnum: number;
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="logons"><a class="header" href="#logons">Logons</a></h1>
<p>Linux stores <code>Logon</code> information in several different files depending on the
distro and software installed. Typically the following files contain logon
information on Linux:</p>
<ul>
<li>wtmp - Historical logons</li>
<li>btmp - Failed logons</li>
<li>utmp - Users currently logged on</li>
</ul>
<p>In addition, <a href="artifacts/linux/./journals.html">Journal</a> files may also contain logon information
Currently <code>artemis</code> supports all three (3) files above when obtaining <code>Logon</code>
information. When collecting <code>Logon</code> information <code>artemis</code> will only parse:
wtmp, utmp, and btmp files.</p>
<p>If you want to check for logons in <code>Journal</code> files, you can try to apply a
<a href="artifacts/linux/../../scripting/filterscripts.html">filter</a> to the <a href="artifacts/linux/./journals.html">Journal</a>
artifact</p>
<p>Other Parsers:</p>
<ul>
<li>N/A</li>
</ul>
<p>References:</p>
<ul>
<li><a href="https://github.com/libyal/dtformats/blob/main/documentation/Utmp%20login%20records%20format.asciidoc">libyal</a></li>
<li><a href="https://man7.org/linux/man-pages/man5/utmp.5.html">utmp</a></li>
</ul>
<h1 id="toml-collection-43"><a class="header" href="#toml-collection-43">TOML Collection</a></h1>
<pre><code class="language-toml">system = &quot;linux&quot;

[output]
name = &quot;logon_collection&quot;
directory = &quot;./tmp&quot;
format = &quot;json&quot;
compress = false
endpoint_id = &quot;abdc&quot;
collection_id = 1
output = &quot;local&quot;

[[artifacts]]
artifact_name = &quot;logon&quot;
</code></pre>
<h1 id="collection-options-39"><a class="header" href="#collection-options-39">Collection Options</a></h1>
<ul>
<li>N/A</li>
</ul>
<h1 id="output-structure-43"><a class="header" href="#output-structure-43">Output Structure</a></h1>
<p>An array of <code>Logon</code> entries</p>
<pre><code class="language-typescript">export interface Logon {
  /**Logon type for logon entry */
  logon_type: string;
  /**Process ID */
  pid: number;
  /** Terminal info */
  terminal: string;
  /**Terminal ID for logon entry */
  terminal_id: number;
  /**Username for logon */
  username: string;
  /**Hostname for logon source */
  hostname: string;
  /**Termination status for logon entry */
  termination_status: number;
  /**Exit status logon entry */
  exit_status: number;
  /**Session for logon entry */
  session: number;
  /**Timestamp for logon in UNIXEPOCH seconds */
  timestamp: number;
  /**Source IP for logon entry */
  ip: string;
  /**Status of logon entry: `Success` or `Failed` */
  status: string;
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="processes-2"><a class="header" href="#processes-2">Processes</a></h1>
<p>Gets a standard process listing using the Linux API</p>
<p>Other Parsers:</p>
<ul>
<li>Any tool that calls the Linux API</li>
</ul>
<p>References:</p>
<ul>
<li>N/A</li>
</ul>
<h1 id="toml-collection-44"><a class="header" href="#toml-collection-44">TOML Collection</a></h1>
<pre><code class="language-toml">system = &quot;Linux&quot;

[output]
name = &quot;process_collection&quot;
directory = &quot;./tmp&quot;
format = &quot;jsonl&quot;
compress = false
endpoint_id = &quot;abdc&quot;
collection_id = 1
output = &quot;local&quot;

[[artifacts]]
artifact_name = &quot;processes&quot; # Name of artifact
[artifacts.processes]
# Get executable metadata
metadata = true 
# MD5 hash process binary
md5 = true 
 # SHA1 hash process binary
sha1 = false
# SHA256 hash process binary
sha256 = false
</code></pre>
<h1 id="collection-options-40"><a class="header" href="#collection-options-40">Collection Options</a></h1>
<ul>
<li><code>metadata</code> Get <a href="artifacts/linux/elf.html">ELF</a> data from process binary.</li>
<li><code>md5</code> Boolean value to MD5 hash process binary</li>
<li><code>sha1</code> Boolean value to SHA1 hash process binary</li>
<li><code>sha256</code> Boolean value to SHA256 hash process binary</li>
</ul>
<h1 id="output-structure-44"><a class="header" href="#output-structure-44">Output Structure</a></h1>
<p>An array of <code>LinuxProcessInfo</code> entries</p>
<pre><code class="language-typescript">export interface LinuxProcessInfo {
  /**Full path to the process binary */
  full_path: string;
  /**Name of process */
  name: string;
  /**Path to process binary */
  path: string;
  /** Process ID */
  pid: number;
  /** Parent Process ID */
  ppid: number;
  /**Environment variables associated with process */
  environment: string;
  /**Status of the process */
  status: string;
  /**Process arguments */
  arguments: string;
  /**Process memory usage */
  memory_usage: number;
  /**Process virtual memory usage */
  virtual_memory_usage: number;
  /**Process start time in UNIXEPOCH seconds*/
  start_time: number;
  /** User ID associated with process */
  uid: string;
  /**Group ID associated with process */
  gid: string;
  /**MD5 hash of process binary */
  md5: string;
  /**SHA1 hash of process binary */
  sha1: string;
  /**SHA256 hash of process binary */
  sha256: string;
  /**ELF metadata asssociated with process binary */
  binary_info: ElfInfo[];
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="shell-history-1"><a class="header" href="#shell-history-1">Shell History</a></h1>
<p>Many Unix and Linux like systems provide a shell interface that allows a user to
execute a command or application. Many of these shell interfaces keep a record
of the command executed and depending on the configuration the timestamp when
the command was executed. Popular shells include:</p>
<ul>
<li>bash</li>
<li>zsh</li>
<li>fish</li>
<li>sh</li>
<li>PowerShell</li>
</ul>
<p><code>Artemis</code> supports parsing <code>zsh</code> and <code>bash</code> shell history. In addition, it
supports parsing <code>Python</code> history (despite not being a shell).</p>
<p>Other parsers:</p>
<ul>
<li>Any program that read a text file</li>
</ul>
<p>References:</p>
<ul>
<li><a href="https://linuxhint.com/bash_command_history_usage/">Bash</a></li>
<li><a href="https://www.soberkoder.com/better-zsh-history/">Zsh</a></li>
</ul>
<h1 id="toml-collection-45"><a class="header" href="#toml-collection-45">TOML Collection</a></h1>
<pre><code class="language-toml">system = &quot;macos&quot; # or &quot;linux&quot;

[output]
name = &quot;shellhistory_collection&quot;
directory = &quot;./tmp&quot;
format = &quot;json&quot;
compress = false
endpoint_id = &quot;abdc&quot;
collection_id = 1
output = &quot;local&quot;

[[artifacts]]
artifact_name = &quot;shell_history&quot;
</code></pre>
<h1 id="collection-options-41"><a class="header" href="#collection-options-41">Collection Options</a></h1>
<ul>
<li>N/A</li>
</ul>
<h1 id="output-structure-45"><a class="header" href="#output-structure-45">Output Structure</a></h1>
<p>An array of <code>BashHistory</code> for <code>bash</code> data, <code>ZshHistory</code> for <code>zsh</code> data, and
<code>PythonHistory</code> for <code>Python</code> data per user.</p>
<pre><code class="language-typescript">export interface BashHistory {
  /**Array of lines associated with `.bash_history` file */
  history: BashData[];
  /**Path to `.bash_history` file */
  path: string;
  /**User directory name */
  user: string;
}

/**
 * History data associated with `.bash_history`
 */
export interface BashData {
  /**Line entry */
  history: string;
  /**Timestamp associated with line entry in UNIXEPOCH. Timestamps are **optional** in `.bash_history`, zero (0) is returned for no timestamp */
  timestamp: number;
  /**Line number */
  line: number;
}

export interface ZshHistory {
  /**Array of lines associated with `.zs_history` file */
  history: ZshData[];
  /**Path to `.bash_history` file */
  path: string;
  /**User directory name */
  user: string;
}

/**
 * History data associated with `.zsh_history`
 */
export interface ZshData {
  /**Line entry */
  history: string;
  /**Timestamp associated with line entry in UNIXEPOCH. Timestamps are **optional** in `.zsh_history`, zero (0) is returned for no timestamp */
  timestamp: number;
  /**Line number */
  line: number;
  /**Duration of command */
  duration: number;
}

export interface PythonHistory {
  /**Array of lines associated with `.python_history` file */
  history: PythonData[];
  /**Path to `.python_history` file */
  path: string;
  /**User directory name */
  user: string;
}

/**
 * History data associated with `.python_history`
 */
export interface PythonData {
  /**Line entry */
  history: string;
  /**Line number */
  line: number;
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="sudo-logs-1"><a class="header" href="#sudo-logs-1">Sudo Logs</a></h1>
<p>Unix <code>SudoLogs</code> are the log files associated with sudo execution. Sudo (&quot;super
user do&quot; or &quot;substitute user&quot;) is used to run programs with elevated
privileges.<br />
macOS <code>SudoLogs</code> are stored in the Unified Log files.<br />
Linux <code>SudoLogs</code> are stored in the Systemd Journal files.<br />
The log entries show evidence of commands executed with elevated privileges</p>
<p>Other Parsers:</p>
<ul>
<li>None</li>
</ul>
<p>References:</p>
<ul>
<li>N/A</li>
</ul>
<h1 id="toml-collection-46"><a class="header" href="#toml-collection-46">TOML Collection</a></h1>
<pre><code class="language-toml">system = &quot;linux&quot; # or &quot;macos&quot;

[output]
name = &quot;sudologs_collection&quot;
directory = &quot;./tmp&quot;
format = &quot;json&quot;
compress = false
endpoint_id = &quot;abdc&quot;
collection_id = 1
output = &quot;local&quot;

[[artifacts]]
artifact_name = &quot;sudologs&quot;
</code></pre>
<h1 id="collection-options-42"><a class="header" href="#collection-options-42">Collection Options</a></h1>
<ul>
<li>N/A</li>
</ul>
<h1 id="output-structure-46"><a class="header" href="#output-structure-46">Output Structure</a></h1>
<p>On a Linux system <code>SudoLogs</code> return an array of <code>Journal</code> entries</p>
<pre><code class="language-typescript">export interface Journal {
  /**User ID associated with entry */
  uid: number;
  /**Group ID associated with entry */
  gid: number;
  /**Process ID associated with entry */
  pid: number;
  /**Thread ID associated with entry */
  thread_id: number;
  /**Command associated with entry */
  comm: string;
  /**Priority associated with entry */
  priority: string;
  /**Syslog facility associated with entry */
  syslog_facility: string;
  /**Executable file associated with entry */
  executable: string;
  /**Cmdline args associated with entry */
  cmdline: string;
  /**Effective capabilities of process associated with entry */
  cap_effective: string;
  /**Session of the process associated with entry */
  audit_session: number;
  /**Login UID of the process associated with entry */
  audit_loginuid: number;
  /**Systemd Countrol Group associated with entry */
  systemd_cgroup: string;
  /**Systemd owner UID associated with entry */
  systemd_owner_uid: number;
  /**Systemd unit associated with entry */
  systemd_unit: string;
  /**Systemd user unit associated with entry */
  systemd_user_unit: string;
  /**Systemd slice associated with entry */
  systemd_slice: string;
  /**Sysemd user slice associated with entry */
  systemd_user_slice: string;
  /**Systemd invocation ID associated with entry */
  systemd_invocation_id: string;
  /**Kernel Boot ID associated with entry */
  boot_id: string;
  /**Machine ID of host associated with entry */
  machine_id: string;
  /**Hostname associated with entry */
  hostname: string;
  /**Runtime scope associated with entry */
  runtime_scope: string;
  /**Trused Timestamp associated with entry in UNIXEPOCH microseconds */
  source_realtime: number;
  /**Timestamp associated with entry in UNIXEPOCH microseconds */
  realtime: number;
  /**How entry was received by the Journal service */
  transport: string;
  /**Journal message entry */
  message: string;
  /**Message ID associated with Journal Catalog */
  message_id: string;
  /**Unit result associated with entry */
  unit_result: string;
  /**Code line for file associated with entry */
  code_line: number;
  /**Code function for file associated with entry */
  code_function: string;
  /**Code file associated with entry */
  code_file: string;
  /**User invocation ID associated with entry */
  user_invocation_id: string;
  /**User unit associated with entry */
  user_unit: string;
  /**
   * Custom fields associated with entry.
   * Example:
   * ```
   * &quot;custom&quot;: {
   *            &quot;_SOURCE_MONOTONIC_TIMESTAMP&quot;: &quot;536995&quot;,
   *            &quot;_UDEV_SYSNAME&quot;: &quot;0000:00:1c.3&quot;,
   *            &quot;_KERNEL_DEVICE&quot;: &quot;+pci:0000:00:1c.3&quot;,
   *            &quot;_KERNEL_SUBSYSTEM&quot;: &quot;pci&quot;
   *        }
   * ```
   */
  custom: Record&lt;string, string&gt;;
  /**Sequence Number associated with entry */
  seqnum: number;
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="systeminfo-2"><a class="header" href="#systeminfo-2">SystemInfo</a></h1>
<p>Gets system metadata associated with the endpoint</p>
<p>Other Parsers:</p>
<ul>
<li>Any tool that calls the Linux API or queries system information</li>
</ul>
<p>Refernces:</p>
<ul>
<li>N/A</li>
</ul>
<h1 id="toml-collection-47"><a class="header" href="#toml-collection-47">TOML Collection</a></h1>
<pre><code class="language-toml">system = &quot;Linux&quot;

[output]
name = &quot;systeminfo_collection&quot;
directory = &quot;./tmp&quot;
format = &quot;json&quot;
compress = false
endpoint_id = &quot;abdc&quot;
collection_id = 1
output = &quot;local&quot;

[[artifacts]]
artifact_name = &quot;systeminfo&quot;
</code></pre>
<h1 id="collection-options-43"><a class="header" href="#collection-options-43">Collection Options</a></h1>
<ul>
<li>N/A</li>
</ul>
<h1 id="output-structure-47"><a class="header" href="#output-structure-47">Output Structure</a></h1>
<p>A <code>SystemInfo</code> object structure</p>
<pre><code class="language-typescript">export interface SystemInfo {
  /**Boot time for endpoint */
  boot_time: number;
  /**Endpoint hostname */
  hostname: string;
  /**Endpoint OS version */
  os_version: string;
  /**Uptime of endpoint */
  uptime: number;
  /**Endpoint kernel version */
  kernel_version: string;
  /**Endpoint platform */
  platform: string;
  /**CPU information */
  cpu: Cpus[];
  /**Disks information */
  disks: Disks[];
  /**Memory information */
  memory: Memory;
  /**Performance information */
  performance: LoadPerformance;
}

/**
 * CPU information on endpoint
 */
export interface Cpus {
  /**CPU frequency */
  frequency: number;
  /**CPU usage on endpoint */
  cpu_usage: number;
  /**Name of CPU */
  name: string;
  /**Vendor ID for CPU */
  vendor_id: string;
  /**CPU brand */
  brand: string;
  /**Core Count */
  physical_core_count: number;
}

/**
 * Disk information on endpoint
 */
export interface Disks {
  /**Type of disk */
  disk_type: string;
  /**Filesystem for disk */
  file_system: string;
  /**Disk mount point */
  mount_point: string;
  /**Disk storage */
  total_space: number;
  /**Storage remaining */
  available_space: number;
  /**If disk is removable */
  removable: boolean;
}

/**
 * Memory information on endpoint
 */
export interface Memory {
  /**Available memory on endpoint */
  available_memory: number;
  /**Free memory on endpoint */
  free_memory: number;
  /**Free swap on endpoint */
  free_swap: number;
  /**Total memory on endpoint */
  total_memory: number;
  /**Total swap on endpoint */
  total_swap: number;
  /**Memory in use */
  used_memory: number;
  /**Swap in use */
  used_swap: number;
}

/**
 * Average CPU load
 */
export interface LoadPerformance {
  /**Average load for one (1) min */
  avg_one_min: number;
  /**Average load for five (5) min */
  avg_five_min: number;
  /**Average load for fifteen (15) min */
  avg_fifteen_min: number;
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="applications"><a class="header" href="#applications">Applications</a></h1>
<p>In addition to supporting OS specific artifacts, <code>artemis</code> can parse data
associated with several applications.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="chromium"><a class="header" href="#chromium">Chromium</a></h1>
<p><code>Chromium</code> is a popular open source web browser created and maintained by
Google. The <code>Chromium</code> codebase also used for multiple other browsers such as:</p>
<ul>
<li>Chrome</li>
<li>Microsoft Edge</li>
<li>Opera</li>
<li>Brave</li>
</ul>
<p><code>Artemis</code> supports parsing browsing history and downloads from <code>Chromium</code>.
History and downloads data are stored in a SQLITE file.</p>
<p>Other parsers:</p>
<ul>
<li>Any program that read a SQLITE database</li>
</ul>
<p>References:</p>
<ul>
<li><a href="https://en.wikiversity.org/wiki/Chromium_browsing_history_database">History</a></li>
<li><a href="https://gist.github.com/dropmeaword/9372cbeb29e8390521c2">Schema</a></li>
</ul>
<h1 id="toml-collection-48"><a class="header" href="#toml-collection-48">TOML Collection</a></h1>
<pre><code class="language-toml">system = &quot;macos&quot;

[output]
name = &quot;chromium_macos&quot;
directory = &quot;./tmp&quot;
format = &quot;json&quot;
compress = false
endpoint_id = &quot;abdc&quot;
collection_id = 1
output = &quot;local&quot;

[[artifacts]]
artifact_name = &quot;chromium-history&quot;

[[artifacts]]
artifact_name = &quot;chromium-downloads&quot;
</code></pre>
<h1 id="collection-options-44"><a class="header" href="#collection-options-44">Collection Options</a></h1>
<ul>
<li>N/A</li>
</ul>
<h1 id="output-structure-48"><a class="header" href="#output-structure-48">Output Structure</a></h1>
<p>An array of <code>ChromiumHistory</code> for history data and <code>ChromiumDownloads</code> for
downloads data per user.</p>
<pre><code class="language-typescript">export interface ChromiumHistory {
  /**Array of history entries */
  history: RawChromiumHistory[];
  /**Path associated with the history file */
  path: string;
  /**User associated with the history file */
  user: string;
}

/**
 * An interface representing the Chromium SQLITE tables: `urls` and `visits`
 */
export interface RawChromiumHistory {
  /**Row ID value */
  id: number;
  /**Page URL */
  url: string;
  /**Page title */
  title: string;
  /**Page visit count */
  visit_count: number;
  /**Typed count value */
  typed_count: number;
  /**Last visit time in UNIXEPOCH seconds */
  last_visit_time: number;
  /**Hiden value */
  hidden: number;
  /**Visits ID value */
  visits_id: number;
  /**From visit value */
  from_visit: number;
  /**Transition value */
  transition: number;
  /**Segment ID value */
  segment_id: number;
  /**Visit duration value */
  visit_duration: number;
  /**Opener visit value */
  opener_visit: number;
}

export interface ChromiumDownloads {
  /**Array of downloads entries */
  downloads: RawChromiumDownloads[];
  /**Path associated with the downloads file */
  path: string;
  /**User associated with the downloads file */
  user: string;
}

/**
 * An interface representing the Chromium SQLITE tables: `downloads` and  `downloads_url_chains`
 */
export interface RawChromiumDownloads {
  /**Row ID */
  id: number;
  /**GUID for download */
  guid: string;
  /**Path to download */
  current_path: string;
  /**Target path to download */
  target_path: string;
  /**Download start time in UNIXEPOCH seconds */
  start_time: number;
  /**Bytes downloaded */
  received_bytes: number;
  /**Total bytes downloaded */
  total_bytes: number;
  /**State value */
  state: number;
  /**Danger type value */
  danger_type: number;
  /**Interrupt reaason value */
  interrupt_reason: number;
  /**Raw byte hash value */
  hash: number[];
  /**Download end time in UNIXEPOCH seconds */
  end_time: number;
  /**Opened value */
  opened: number;
  /**Last access time in UNIXEPOCH seconds */
  last_access_time: number;
  /**Transient value */
  transient: number;
  /**Referer URL */
  referrer: string;
  /**Download source URL */
  site_url: string;
  /**Tabl URL */
  tab_url: string;
  /**Tab referrer URL */
  tab_referrer_url: string;
  /**HTTP method used */
  http_method: string;
  /**By ext ID value */
  by_ext_id: string;
  /**By ext name value */
  by_ext_name: string;
  /**Etag value */
  etag: string;
  /**Last modified time as STRING */
  last_modified: string;
  /**MIME type value */
  mime_type: string;
  /**Original mime type value */
  original_mime_type: string;
  /**Downloads URL chain ID value */
  downloads_url_chain_id: number;
  /**Chain index value */
  chain_index: number;
  /**URL for download */
  url: string;
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="firefox"><a class="header" href="#firefox">Firefox</a></h1>
<p><code>Firefox</code> is a popular open source web browser created and maintained by
Mozilla. <code>artemis</code> supports parsing browsing history and downloads from
<code>Firefox</code>. History and downloads data are stored in a SQLITE file.</p>
<p>Other parsers:</p>
<ul>
<li>Any program that read a SQLITE database</li>
</ul>
<p>References:</p>
<ul>
<li><a href="https://kb.mozillazine.org/Places.sqlite">Schema</a></li>
</ul>
<h1 id="toml-collection-49"><a class="header" href="#toml-collection-49">TOML Collection</a></h1>
<pre><code class="language-toml">system = &quot;macos&quot;

[output]
name = &quot;firefox_tester&quot;
directory = &quot;./tmp&quot;
format = &quot;json&quot;
compress = false
endpoint_id = &quot;abdc&quot;
collection_id = 1
output = &quot;local&quot;

[[artifacts]]
artifact_name = &quot;firefox-history&quot;

[[artifacts]]
artifact_name = &quot;firefox-downloads&quot;
</code></pre>
<h1 id="collection-options-45"><a class="header" href="#collection-options-45">Collection Options</a></h1>
<ul>
<li>N/A</li>
</ul>
<h1 id="output-structure-49"><a class="header" href="#output-structure-49">Output Structure</a></h1>
<p>An array of <code>FirefoxHistory</code> for history data and <code>FirefoxDownloads</code> for
downloads data per user.</p>
<pre><code class="language-typescript">export interface FirefoxHistory {
  /**Array of history entries */
  history: RawFirefoxHistory[];
  /**Path associated with the history file */
  path: string;
  /**User associated with the history file */
  user: string;
}

/**
 * An interface representing the Firefox SQLITE tables: `moz_places` and `moz_origins`
 */
export interface RawFirefoxHistory {
  /**SQLITE row id */
  moz_places_id: number;
  /**Page URL */
  url: string;
  /**Page title */
  title: string;
  /**URL in reverse */
  rev_host: string;
  /**Page visit count */
  visit_count: number;
  /**Hidden value */
  hidden: number;
  /**Typed value */
  typed: number;
  /**Frequency value */
  frequency: number;
  /**Last visit time in UNIXEPOCH seconds */
  last_visit_date: number;
  /**GUID for entry */
  guid: string;
  /**Foreign count value */
  foreign_count: number;
  /**Hash of URL */
  url_hash: number;
  /**Page description */
  description: string;
  /**Preview image URL value */
  preview_image_url: string;
  /**Prefix value (ex: https://) */
  prefix: string;
  /** Host value */
  host: string;
}

export interface FirefoxDownloads {
  /**Array of downloads entries */
  downloads: RawFirefoxDownloads[];
  /**Path associated with the downloads file */
  path: string;
  /**User associated with the downloads file */
  user: string;
}

/**
 * An interface representing the Firefox SQLITE tables: `moz_places`, `moz_origins`, `moz_annos`, `moz_anno_attributes`
 */
export interface RawFirefoxDownloads {
  /**ID for SQLITE row */
  id: number;
  /**ID to history entry */
  place_id: number;
  /**ID to anno_attribute entry */
  anno_attribute_id: number;
  /**Content value */
  content: string;
  /**Flags value */
  flags: number;
  /**Expiration value */
  expiration: number;
  /**Download type value */
  download_type: number;
  /**Date added in UNIXEPOCH seconds */
  date_added: number;
  /**Last modified in UNIXEPOCH seconds */
  last_modified: number;
  /**Downloaded file name */
  name: string;
  /**History data associated with downloaded file */
  history: RawFirefoxHistory;
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="safari"><a class="header" href="#safari">Safari</a></h1>
<p><code>Safari</code> is the builtin web browser an Apple devices. <code>artemis</code> supports parsing
browsing history and downloads from <code>Safari</code>. History data is stored in a SQLITE
file while downloads data is stored PLIST file and then stored in
<a href="https://mac-alias.readthedocs.io/en/latest/index.html">Bookmark</a> format</p>
<p>Other Parsers:</p>
<ul>
<li>Any program that read a SQLITE database for History data</li>
</ul>
<p>References:</p>
<ul>
<li><a href="https://gist.github.com/l1x/68e206f56bcc22cde3d76cc8fed49f3f">History Schema</a></li>
</ul>
<h1 id="toml-collection-50"><a class="header" href="#toml-collection-50">TOML Collection</a></h1>
<pre><code class="language-toml">system = &quot;macos&quot;

[output]
name = &quot;safari_collection&quot;
directory = &quot;./tmp&quot;
format = &quot;json&quot;
compress = false
endpoint_id = &quot;abdc&quot;
collection_id = 1
output = &quot;local&quot;

[[artifacts]]
artifact_name = &quot;safari-history&quot;

[[artifacts]]
artifact_name = &quot;safari-downloads&quot;
</code></pre>
<h1 id="collection-options-46"><a class="header" href="#collection-options-46">Collection Options</a></h1>
<ul>
<li>N/A</li>
</ul>
<h1 id="output-structure-50"><a class="header" href="#output-structure-50">Output Structure</a></h1>
<p>An array of <code>SafariHistory</code> for history data and <code>SafariDownloads</code> for downloads
data per user.</p>
<pre><code class="language-typescript">export interface SafariHistory {
  /**Array of history entries */
  history: RawSafariHistory[];
  /**Path associated with the history file */
  path: string;
  /**User associated with the history file */
  user: string;
}

/**
 * An interface representing the Safari SQLITE tables: `history_items` and `history_visits`
 */
export interface RawSafariHistory {
  /**Row ID value */
  id: number;
  /**Page URL */
  url: string;
  /**Expansion for domain */
  domain_expansion: string;
  /**Page visit count */
  visit_count: number;
  /**Daily visist in raw bytes */
  daily_visit_counts: number[];
  /**Weekly visist in raw bytes */
  weekly_visit_counts: number[];
  /**Autocomplete triggers for page */
  autocomplete_triggers: number[];
  /**Recompute visits count */
  should_recompute_derived_visit_counts: number;
  /**Visit score value */
  visit_count_score: number;
  /**Status code value */
  status_code: number;
  /**Visit time in UNIXEPOCH seconds */
  visit_time: number;
  /**Load successful value */
  load_successful: boolean;
  /**Page title */
  title: string;
  /**Attributes value */
  attributes: number;
  /**Score value */
  score: number;
}

export interface SafariDownloads {
  /**Array of downloads entries */
  downloads: RawSafariDownloads[];
  /**Path associated with the downloads file */
  path: string;
  /**User associated with the downloads file */
  user: string;
}

/**
 * An interface representing Safari downloads data
 */
export interface RawSafariDownloads {
  /**Source URL for download */
  source_url: string;
  /**File download path */
  download_path: string;
  /**Sandbox ID value */
  sandbox_id: string;
  /**Downloaded bytes */
  download_bytes: number;
  /**Download ID value */
  download_id: string;
  /**Download start date in UNIXEPOCH seconds */
  download_entry_date: number;
  /**Download finish date in UNIXEPOCH seoconds */
  download_entry_finish: number;
  /**Path to file to run */
  path: string[];
  /**Path represented as Catalog Node ID */
  cnid_path: number[];
  /**Created timestamp of target file in UNIXEPOCH seconds */
  created: number;
  /**Path to the volume of target file */
  volume_path: string;
  /**Target file URL type */
  volume_url: string;
  /**Name of volume target file is on */
  volume_name: string;
  /**Volume UUID */
  volume_uuid: string;
  /**Size of target volume in bytes */
  volume_size: number;
  /**Created timestamp of volume in UNIXEPOCH seconds */
  volume_created: number;
  /**Volume Property flags */
  volume_flag: number[];
  /**Flag if volume if the root filesystem */
  volume_root: boolean;
  /**Localized name of target file */
  localized_name: string;
  /**Read-Write security extension of target file */
  security_extension_rw: string;
  /**Read-Only security extension of target file */
  security_extension_ro: string;
  /**File property flags */
  target_flags: number[];
  /**Username associated with `Bookmark` */
  username: string;
  /**Folder index number associated with target file */
  folder_index: number;
  /**UID associated with `LoginItem` */
  uid: number;
  /**`LoginItem` creation flags */
  creation_options: number;
  /**Is target file executable */
  is_executable: boolean;
  /**Does target file have file reference flag */
  file_ref_flag: boolean;
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="scripting-with-deno"><a class="header" href="#scripting-with-deno">Scripting with Deno</a></h1>
<p><img src="scripting/../images/deno2.jpeg" alt="a small velociraptor joke" /></p>
<p>A really cool capability of <code>artemis</code> is it contains an embedded <code>JavaScript</code>
runtime via <a href="https://deno.land/">Deno</a>. Deno is V8 based <code>JavaScript</code> runtime
written in Rust. By importing the <code>deno_core</code> crate this allows us to create our
own <code>JavaScript</code> runtime geared specifically for forensics and IR!</p>
<p>For example, the Rust <code>artemis</code> function <code>get_registry(registry_file_path)</code> can
be used to parse a provided <code>Registry</code> file on disk. By registering this
function with the Deno runtime we can call this function directly from
<code>JavaScript</code>! In addition to <code>JavaScript</code>,
<a href="https://www.typescriptlang.org/">TypeScript</a> is also supported by Deno!<br />
To summarize:</p>
<ol>
<li>We can create a script using <code>TypeScript</code> and <code>Deno</code></li>
<li>Compile <code>TypeScript</code> to <code>JavaScript</code></li>
<li>Execute <code>JavaScript</code> using <code>artemis</code></li>
</ol>
<p><code>Deno image from https://deno.land/artwork. The image is MIT licensed. Checkout other artwork by the author at https://hashrock.studio.site/</code></p>
<h1 id="prequisites-for-scripting"><a class="header" href="#prequisites-for-scripting">Prequisites for Scripting.</a></h1>
<ol>
<li><a href="https://deno.land/">Deno</a></li>
<li>A text-editor or IDE that supports Deno. <a href="https://vscodium.com/">VSCodium</a>
and <a href="https://code.visualstudio.com/">VSCode</a> have been tested</li>
<li>Deno language server extension. The extension in the VSCodium and VSCode
marketplaces has been tested.</li>
<li>A <code>TypeScript</code> to <code>JavaScript</code> bundler. There are multiple options:
<ul>
<li><code>Deno</code> includes a builtin bundler however it is schedule for depreciation.
(But it still works)</li>
<li><a href="https://deno.land/x/esbuild_deno_loader@0.6.0">esbuild Deno loader</a>. Will
require a simple build script in order to bundle our <code>artemis</code> script</li>
</ul>
</li>
</ol>
<div style="break-before: page; page-break-before: always;"></div><h1 id="why-typescript"><a class="header" href="#why-typescript">Why TypeScript?</a></h1>
<p>A <code>TypeScript</code> library is provided instead of <code>JavaScript</code> due to the enhanced
features and ease of use <code>TypeScript</code> provides over plain <code>JavaScript</code>.</p>
<p>Continuing from <code>get_registry(registry_file_path)</code> example:</p>
<pre><code class="language-typescript">export interface Registry {
  /**
   * Full path to `Registry` key and name.
   * Ex: ` ROOT\...\CurrentVersion\Run`
   */
  path: string;
  /**
   * Path to Key
   * Ex: ` ROOT\...\CurrentVersion`
   */
  key: string;
  /**
   * Key name
   * Ex: `Run`
   */
  name: string;
  /**
   * Values associated with key name
   * Ex: `Run =&gt; Vmware`. Where Run is the `key` name and `Vmware` is the value name
   */
  values: Value[];
  /**Timestamp of when the path was last modified */
  last_modified: number;
  /**Depth of key name */
  depth: number;
}

/**
 * The value data associated with Registry key
 * References:
 *   https://github.com/libyal/libregf
 *   https://github.com/msuhanov/regf/blob/master/Windows%20registry%20file%20format%20specification.md
 */
export interface Value {
  /**Name of Value */
  value: string;
  /**
   * Data associated with value.  Type can be determiend by `data_type`.
   * `REG_BINARY` is base64 encoded string
   */
  data: string;
  /**Value type */
  data_type: string;
}

/**
 * Function to parse a `Registry` file
 * @param path Full path to a `Registry` file
 * @returns Array of `Registry` entries
 */
export function get_registry(path: string): Registry[] {
  // Array of JSON objects
  const data = Deno.core.ops.get_registry(path);
  const reg_array: Registry[] = JSON.parse(data);

  return reg_array;
}
</code></pre>
<p>The above <code>TypeScript</code> code shows that we can access our registered
<code>get_registry</code> function by calling it via <code>Deno.core.ops.get_registry(path);</code><br />
To make scripting even easier a simple <code>artemis-api</code> library is available to
import into Deno scripts. This allows users to create scripts without needing to
know what functions are registered.</p>
<p>The example script below shows <code>TypeScript</code> code that imports the <code>artemis-api</code>
library to parse the <code>SOFTWARE</code> <code>Registry</code> file to get a list of installed
programs</p>
<pre><code class="language-typescript">import { getRegistry } from &quot;https://raw.githubusercontent.com/puffycid/artemis-api/master/mod.ts&quot;;
import { Registry } from &quot;https://raw.githubusercontent.com/puffycid/artemis-api/master/src/windows/registry.ts&quot;;

interface InstalledPrograms {
  name: string;
  version: string;
  install_location: string;
  install_source: string;
  language: string;
  publisher: string;
  install_string: string;
  install_date: string;
  uninstall_string: string;
  url_info: string;
  reg_path: string;
}

function grab_info(reg: Registry[]): InstalledPrograms[] {
  const programs: InstalledPrograms[] = [];
  const min_size = 3;
  for (const entries of reg) {
    if (entries.values.length &lt; min_size) {
      continue;
    }
    const program: InstalledPrograms = {
      name: &quot;&quot;,
      version: &quot;&quot;,
      install_location: &quot;&quot;,
      install_source: &quot;&quot;,
      language: &quot;&quot;,
      publisher: &quot;&quot;,
      install_string: &quot;&quot;,
      install_date: &quot;&quot;,
      uninstall_string: &quot;&quot;,
      url_info: &quot;&quot;,
      reg_path: entries.path,
    };

    for (const value of entries.values) {
      switch (value.value) {
        case &quot;DisplayName&quot;:
          program.name = value.data;
          break;
        case &quot;DisplayVersion&quot;:
          program.version = value.data;
          break;
        case &quot;InstallDate&quot;:
          program.install_date = value.data;
          break;
        case &quot;InstallLocation&quot;:
          program.install_location = value.data;
          break;
        case &quot;InstallSource&quot;:
          program.install_source = value.data;
          break;
        case &quot;Language&quot;:
          program.language = value.data;
          break;
        case &quot;Publisher&quot;:
          program.publisher = value.data;
          break;
        case &quot;UninstallString&quot;:
          program.uninstall_string = value.data;
          break;
        case &quot;URLInfoAbout&quot;:
          program.url_info = value.data;
          break;
        default:
          continue;
      }
    }
    programs.push(program);
  }
  return programs;
}

function main() {
  const path = &quot;C:\\Windows\\System32\\config\\SOFTWARE&quot;;

  const reg = getRegistry(path);
  const programs: Registry[] = [];
  for (const entries of reg) {
    if (
      !entries.path.includes(
        &quot;Microsoft\\Windows\\CurrentVersion\\Uninstall&quot;,
      )
    ) {
      continue;
    }
    programs.push(entries);
  }
  return grab_info(programs);
}

main();
</code></pre>
<p>We can then compile and bundle this <code>TypeScript</code> code to <code>JavaScript</code> and
execute using <code>artemis</code>!</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="bundling"><a class="header" href="#bundling">Bundling</a></h1>
<p>Currently <code>artemis</code> requires that we have all of our <code>JavaScript</code> code in one
(1) <code>.js</code> file. However, while very simple scripts may only be one (1) file, if
we decide to import an <code>artemis</code> function, or split our code into multiple files
we now have multiple files that need to be combine into one (1) <code>.js</code> file.</p>
<p>A Bundler can help us perform this task.</p>
<p>The <code>TypeScript</code> code below imports a function and the <code>Registry</code> interface from
<code>artemis</code>.</p>
<pre><code class="language-typescript">import { getRegistry } from &quot;https://raw.githubusercontent.com/puffycid/artemis-api/master/mod.ts&quot;;
import { Registry } from &quot;https://raw.githubusercontent.com/puffycid/artemis-api/master/src/windows/registry.ts&quot;;

interface InstalledPrograms {
  name: string;
  version: string;
  install_location: string;
  install_source: string;
  language: string;
  publisher: string;
  install_string: string;
  install_date: string;
  uninstall_string: string;
  url_info: string;
  reg_path: string;
}

function grab_info(reg: Registry[]): InstalledPrograms[] {
  const programs: InstalledPrograms[] = [];
  const min_size = 3;
  for (const entries of reg) {
    if (entries.values.length &lt; min_size) {
      continue;
    }
    const program: InstalledPrograms = {
      name: &quot;&quot;,
      version: &quot;&quot;,
      install_location: &quot;&quot;,
      install_source: &quot;&quot;,
      language: &quot;&quot;,
      publisher: &quot;&quot;,
      install_string: &quot;&quot;,
      install_date: &quot;&quot;,
      uninstall_string: &quot;&quot;,
      url_info: &quot;&quot;,
      reg_path: entries.path,
    };

    for (const value of entries.values) {
      switch (value.value) {
        case &quot;DisplayName&quot;:
          program.name = value.data;
          break;
        case &quot;DisplayVersion&quot;:
          program.version = value.data;
          break;
        case &quot;InstallDate&quot;:
          program.install_date = value.data;
          break;
        case &quot;InstallLocation&quot;:
          program.install_location = value.data;
          break;
        case &quot;InstallSource&quot;:
          program.install_source = value.data;
          break;
        case &quot;Language&quot;:
          program.language = value.data;
          break;
        case &quot;Publisher&quot;:
          program.publisher = value.data;
          break;
        case &quot;UninstallString&quot;:
          program.uninstall_string = value.data;
          break;
        case &quot;URLInfoAbout&quot;:
          program.url_info = value.data;
          break;
        default:
          continue;
      }
    }
    programs.push(program);
  }
  return programs;
}

function main() {
  const path = &quot;C:\\Windows\\System32\\config\\SOFTWARE&quot;;

  const reg = getRegistry(path);
  const programs: Registry[] = [];
  for (const entries of reg) {
    if (
      !entries.path.includes(
        &quot;Microsoft\\Windows\\CurrentVersion\\Uninstall&quot;,
      )
    ) {
      continue;
    }
    programs.push(entries);
  }
  return grab_info(programs);
}

main();
</code></pre>
<p>Lets save this code to the file <code>main.ts</code>. Before we can compile the code to
<code>JavaScript</code> we have to include (bundle) <code>mod.ts</code> and <code>registry.ts</code>.<br />
There are multiple types of bundler applications that can help us with this
task. Two (2) this book will focus on are:</p>
<ul>
<li>The builtin bundler in Deno</li>
<li><a href="https://deno.land/x/esbuild_deno_loader@0.6.0">esbuild Deno loader</a></li>
</ul>
<h2 id="deno-builtin-bundler"><a class="header" href="#deno-builtin-bundler">Deno Builtin Bundler</a></h2>
<p>To bundle our <code>main.ts</code> and compile to a <code>.js</code> file. We just need to run:
<code>deno bundle  --no-check main.ts &gt; main.js</code>. By default <code>Deno</code> wil output to the
console when bundling.</p>
<h3 id="--no-check-flag"><a class="header" href="#--no-check-flag"><code>--no-check</code> Flag</a></h3>
<p>This flag tells <code>Deno</code> not to type check values. This flag is required due to:
<code>Deno.core.ops.get_registry(path)</code><br />
The Deno binary is designed to support code written for the Deno platform.
However, we are using a custom Deno runtime.<br />
The Deno binary has no idea what <code>get_registry</code> is because it is a custom
function we have registered in our own runtime.</p>
<h3 id="output"><a class="header" href="#output">Output</a></h3>
<pre><code class="language-javascript">// deno-fmt-ignore-file
// deno-lint-ignore-file
// This code was bundled using `deno bundle` and it's not recommended to edit it manually

function get_registry(path) {
    const data = Deno.core.ops.get_registry(path);
    const reg_array = JSON.parse(data);
    return reg_array;
}
function getRegistry(path) {
    return get_registry(path);
}
function grab_info(reg) {
    const programs = [];
    for (const entries of reg){
        if (entries.values.length &lt; 3) {
            continue;
        }
        const program = {
            name: &quot;&quot;,
            version: &quot;&quot;,
            install_location: &quot;&quot;,
            install_source: &quot;&quot;,
            language: &quot;&quot;,
            publisher: &quot;&quot;,
            install_string: &quot;&quot;,
            install_date: &quot;&quot;,
            uninstall_string: &quot;&quot;,
            url_info: &quot;&quot;,
            reg_path: entries.path
        };
        for (const value of entries.values){
            switch(value.value){
                case &quot;DisplayName&quot;:
                    program.name = value.data;
                    break;
                case &quot;DisplayVersion&quot;:
                    program.version = value.data;
                    break;
                case &quot;InstallDate&quot;:
                    program.install_date = value.data;
                    break;
                case &quot;InstallLocation&quot;:
                    program.install_location = value.data;
                    break;
                case &quot;InstallSource&quot;:
                    program.install_source = value.data;
                    break;
                case &quot;Language&quot;:
                    program.language = value.data;
                    break;
                case &quot;Publisher&quot;:
                    program.publisher = value.data;
                    break;
                case &quot;UninstallString&quot;:
                    program.uninstall_string = value.data;
                    break;
                case &quot;URLInfoAbout&quot;:
                    program.url_info = value.data;
                    break;
                default:
                    continue;
            }
        }
        programs.push(program);
    }
    return programs;
}
function main() {
    const path = &quot;C:\\Windows\\System32\\config\\SOFTWARE&quot;;
    const reg = getRegistry(path);
    const programs = [];
    for (const entries of reg){
        if (!entries.path.includes(&quot;Microsoft\\Windows\\CurrentVersion\\Uninstall&quot;)) {
            continue;
        }
        programs.push(entries);
    }
    return grab_info(programs);
}
main();
</code></pre>
<p>The <code>JavaScript</code> code above was generated with the <code>deno bundle</code> command and is
now ready to be executed by <code>artemis</code>!</p>
<h2 id="esbuild"><a class="header" href="#esbuild">Esbuild</a></h2>
<p><a href="https://esbuild.github.io/">esbuild</a> is a popular Bundler for <code>JavaScript</code>. It
is normally run as a standalone binary, however we can import a module that lets
us dynamically execute esbuild using Deno. In order to do this we need a build
script. Using the same <code>main.ts</code> file above, create a <code>build.ts</code> file in the
same directory. Add the following code to <code>build.ts</code>:</p>
<pre><code class="language-typescript">import * as esbuild from &quot;https://deno.land/x/esbuild@v0.15.10/mod.js&quot;;
import { denoPlugin } from &quot;https://deno.land/x/esbuild_deno_loader@0.6.0/mod.ts&quot;;

async function main() {
  const _result = await esbuild.build({
    plugins: [denoPlugin()],
    entryPoints: [&quot;./main.ts&quot;],
    outfile: &quot;main.js&quot;,
    bundle: true,
    format: &quot;cjs&quot;,
  });

  esbuild.stop();
}

main();
</code></pre>
<p>The above script will use the <code>main.ts</code> file and bundle all of its pre-requisite
files into one <code>.js</code> file using esbuild. We then execute this code using
<code>deno run build.ts</code></p>
<h3 id="output-1"><a class="header" href="#output-1">Output</a></h3>
<pre><code class="language-javascript">// https://raw.githubusercontent.com/puffycid/artemis-api/master/src/windows/registry.ts
function get_registry(path) {
  const data = Deno.core.ops.get_registry(path);
  const reg_array = JSON.parse(data);
  return reg_array;
}

// https://raw.githubusercontent.com/puffycid/artemis-api/master/mod.ts
function getRegistry(path) {
  return get_registry(path);
}

// main.ts
function grab_info(reg) {
  const programs = [];
  const min_size = 3;
  for (const entries of reg) {
    if (entries.values.length &lt; min_size) {
      continue;
    }
    const program = {
      name: &quot;&quot;,
      version: &quot;&quot;,
      install_location: &quot;&quot;,
      install_source: &quot;&quot;,
      language: &quot;&quot;,
      publisher: &quot;&quot;,
      install_string: &quot;&quot;,
      install_date: &quot;&quot;,
      uninstall_string: &quot;&quot;,
      url_info: &quot;&quot;,
      reg_path: entries.path,
    };
    for (const value of entries.values) {
      switch (value.value) {
        case &quot;DisplayName&quot;:
          program.name = value.data;
          break;
        case &quot;DisplayVersion&quot;:
          program.version = value.data;
          break;
        case &quot;InstallDate&quot;:
          program.install_date = value.data;
          break;
        case &quot;InstallLocation&quot;:
          program.install_location = value.data;
          break;
        case &quot;InstallSource&quot;:
          program.install_source = value.data;
          break;
        case &quot;Language&quot;:
          program.language = value.data;
          break;
        case &quot;Publisher&quot;:
          program.publisher = value.data;
          break;
        case &quot;UninstallString&quot;:
          program.uninstall_string = value.data;
          break;
        case &quot;URLInfoAbout&quot;:
          program.url_info = value.data;
          break;
        default:
          continue;
      }
    }
    programs.push(program);
  }
  return programs;
}
function main() {
  const path = &quot;C:\\Windows\\System32\\config\\SOFTWARE&quot;;
  const reg = getRegistry(path);
  const programs = [];
  for (const entries of reg) {
    if (
      !entries.path.includes(
        &quot;Microsoft\\Windows\\CurrentVersion\\Uninstall&quot;,
      )
    ) {
      continue;
    }
    programs.push(entries);
  }
  return grab_info(programs);
}
main();
</code></pre>
<p>The <code>JavaScript</code> code above was generated by esbuild via <code>Deno</code> and is now ready
to be executed by <code>artemis</code>!</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="scripts"><a class="header" href="#scripts">Scripts</a></h1>
<p>The easiest way to start scripting is to create a Deno project.</p>
<ul>
<li><code>deno init &lt;project name&gt;</code> will create a project in the current directory</li>
</ul>
<p>The <a href="https://deno.land/manual@v1.32.4/introduction">deno</a> website contains the
full documentation on a Deno project layout. By default the following files are
created for a new project:</p>
<ul>
<li><code>deno.jsonc</code></li>
<li><code>main.ts</code></li>
<li><code>main_bench.ts</code></li>
<li><code>main_test.ts</code></li>
</ul>
<p>Since we are using a runtime built specifically for forensics and IR none of the
builtin Deno functions are available. All scripts must import the
<a href="https://github.com/puffyCid/artemis-api">artemis-api</a> modules in order to
effectively create scripts. In addition, to <code>artemis-api</code> only the vanilla
<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects">JavaScript</a>
API is available for scripting</p>
<p>To import <code>artemis</code> functions into your script, open <code>main.ts</code> and import the
function associated with the artifact you want to parse. For example, to parse
the Windows <code>Registry</code> you would import:</p>
<pre><code class="language-typescript">import { getRegistry } from &quot;https://raw.githubusercontent.com/puffycid/artemis-api/master/mod.ts&quot;;
</code></pre>
<p>If you wanted to parse the Windows <code>Registry</code> and manipulate the parsed data you
would import:</p>
<pre><code class="language-typescript">import { getRegistry } from &quot;https://raw.githubusercontent.com/puffycid/artemis-api/master/mod.ts&quot;;
import { Registry } from &quot;https://raw.githubusercontent.com/puffycid/artemis-api/master/src/windows/registry.ts&quot;;
</code></pre>
<p>A list of all exported <code>artemis</code> functions can be found at
<code>https://github.com/puffyCid/artemis-api</code>. All artifacts supported by <code>artemis</code>
are callable from <code>TypeScript</code>. The structured output produced by each
<code>artifact</code> is listed in the respective <code>artifact</code> chapter. For example, the
structured <code>Registry</code> data format return <code>getRegistry</code> is found in the
<a href="scripting/../artifacts/windows/registry.html">Registry chapter</a></p>
<p>Once we have created and bundled our script. We just need to base64 encode
before providing it to <code>artemis</code>.</p>
<h1 id="toml-collection-51"><a class="header" href="#toml-collection-51">TOML Collection</a></h1>
<p>An example TOML collection would like this</p>
<pre><code class="language-toml">system = &quot;macos&quot;

[output]
name = &quot;plist_data&quot;
directory = &quot;./tmp&quot;
format = &quot;json&quot;
compress = false
endpoint_id = &quot;6c51b123-1522-4572-9f2a-0bd5abd81b82&quot;
collection_id = 1
output = &quot;local&quot;

[[artifacts]]
artifact_name = &quot;script&quot;
[artifacts.script]
name = &quot;all_users_plist_files&quot;
# Parses all plist files in /Users/%
script = &quot;Ly8gaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL3B1ZmZ5Y2lkL2FydGVtaXMtYXBpL21hc3Rlci9zcmMvbWFjb3MvcGxpc3QudHMKZnVuY3Rpb24gZ2V0UGxpc3QocGF0aCkgewogIGNvbnN0IGRhdGEgPSBEZW5vLmNvcmUub3BzLmdldF9wbGlzdChwYXRoKTsKICBpZiAoZGF0YSA9PT0gIiIpIHsKICAgIHJldHVybiBudWxsOwogIH0KICBjb25zdCBwbGlzdF9kYXRhID0gSlNPTi5wYXJzZShkYXRhKTsKICByZXR1cm4gcGxpc3RfZGF0YTsKfQoKLy8gaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL3B1ZmZ5Y2lkL2FydGVtaXMtYXBpL21hc3Rlci9zcmMvc3lzdGVtL291dHB1dC50cwpmdW5jdGlvbiBvdXRwdXRSZXN1bHRzKGRhdGEsIGRhdGFfbmFtZSwgb3V0cHV0KSB7CiAgY29uc3Qgb3V0cHV0X3N0cmluZyA9IEpTT04uc3RyaW5naWZ5KG91dHB1dCk7CiAgY29uc3Qgc3RhdHVzID0gRGVuby5jb3JlLm9wcy5vdXRwdXRfcmVzdWx0cygKICAgIGRhdGEsCiAgICBkYXRhX25hbWUsCiAgICBvdXRwdXRfc3RyaW5nCiAgKTsKICByZXR1cm4gc3RhdHVzOwp9CgovLyBodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vcHVmZnljaWQvYXJ0ZW1pcy1hcGkvbWFzdGVyL3NyYy9maWxlc3lzdGVtL2RpcmVjdG9yeS50cwphc3luYyBmdW5jdGlvbiByZWFkRGlyKHBhdGgpIHsKICBjb25zdCBkYXRhID0gSlNPTi5wYXJzZShhd2FpdCBmcy5yZWFkRGlyKHBhdGgpKTsKICByZXR1cm4gZGF0YTsKfQoKLy8gbWFpbi50cwphc3luYyBmdW5jdGlvbiBtYWluKCkgewogIGNvbnN0IHN0YXJ0X3BhdGggPSAiL1VzZXJzIjsKICBjb25zdCBwbGlzdF9maWxlcyA9IFtdOwogIGF3YWl0IHJlY3Vyc2VfZGlyKHBsaXN0X2ZpbGVzLCBzdGFydF9wYXRoKTsKICByZXR1cm4gcGxpc3RfZmlsZXM7Cn0KYXN5bmMgZnVuY3Rpb24gcmVjdXJzZV9kaXIocGxpc3RfZmlsZXMsIHN0YXJ0X3BhdGgpIHsKICBpZiAocGxpc3RfZmlsZXMubGVuZ3RoID4gMjApIHsKICAgIGNvbnN0IG91dCA9IHsKICAgICAgbmFtZTogImFydGVtaXNfcGxpc3QiLAogICAgICBkaXJlY3Rvcnk6ICIuL3RtcCIsCiAgICAgIGZvcm1hdDogImpzb24iIC8qIEpTT04gKi8sCiAgICAgIGNvbXByZXNzOiBmYWxzZSwKICAgICAgZW5kcG9pbnRfaWQ6ICJhbnl0aGluZy1pLXdhbnQiLAogICAgICBjb2xsZWN0aW9uX2lkOiAxLAogICAgICBvdXRwdXQ6ICJsb2NhbCIgLyogTE9DQUwgKi8KICAgIH07CiAgICBjb25zdCBzdGF0dXMgPSBvdXRwdXRSZXN1bHRzKAogICAgICBKU09OLnN0cmluZ2lmeShwbGlzdF9maWxlcyksCiAgICAgICJhcnRlbWlzX2luZm8iLAogICAgICBvdXQKICAgICk7CiAgICBpZiAoIXN0YXR1cykgewogICAgICBjb25zb2xlLmxvZygiQ291bGQgbm90IG91dHB1dCB0byBsb2NhbCBkaXJlY3RvcnkiKTsKICAgIH0KICAgIHBsaXN0X2ZpbGVzID0gW107CiAgfQogIGZvciAoY29uc3QgZW50cnkgb2YgYXdhaXQgcmVhZERpcihzdGFydF9wYXRoKSkgewogICAgY29uc3QgcGxpc3RfcGF0aCA9IGAke3N0YXJ0X3BhdGh9LyR7ZW50cnkuZmlsZW5hbWV9YDsKICAgIGlmIChlbnRyeS5pc19maWxlICYmIGVudHJ5LmZpbGVuYW1lLmVuZHNXaXRoKCJwbGlzdCIpKSB7CiAgICAgIGNvbnN0IGRhdGEgPSBnZXRQbGlzdChwbGlzdF9wYXRoKTsKICAgICAgaWYgKGRhdGEgPT09IG51bGwpIHsKICAgICAgICBjb250aW51ZTsKICAgICAgfQogICAgICBjb25zdCBwbGlzdF9pbmZvID0gewogICAgICAgIHBsaXN0X2NvbnRlbnQ6IGRhdGEsCiAgICAgICAgZmlsZTogcGxpc3RfcGF0aAogICAgICB9OwogICAgICBwbGlzdF9maWxlcy5wdXNoKHBsaXN0X2luZm8pOwogICAgICBjb250aW51ZTsKICAgIH0KICAgIGlmIChlbnRyeS5pc19kaXJlY3RvcnkpIHsKICAgICAgYXdhaXQgcmVjdXJzZV9kaXIocGxpc3RfZmlsZXMsIHBsaXN0X3BhdGgpOwogICAgfQogIH0KfQptYWluKCk7Cg==&quot;
</code></pre>
<h1 id="collection-options-47"><a class="header" href="#collection-options-47">Collection Options</a></h1>
<ul>
<li><code>name</code> Name for script</li>
<li><code>script</code> Base64 encoded bundled script (JavaScript)</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h2 id="filter-scripts"><a class="header" href="#filter-scripts">Filter Scripts</a></h2>
<p>In addition to creating scripts that call <code>artemis</code> functions. <code>artemis</code> has the
ability to pass the artifact data as an argument to a script! For most scenarios
calling the <code>artemis</code> function is the recommended practice for scripting.
However, the sole execption is the <code>filelisting</code> and <code>rawfilelisting</code> artifacts.</p>
<p>When pulling a filelisting <code>artemis</code> will recursively walk the filesystem, but
in order to keep memory usage low, every 100,000 files <code>artemis</code> will output the
results. While this will keep memory usage low, it makes it difficult to use via
scripting. If we return 100,000 entries to our script, we cannot continue our
recursive filelisting because we have lost track where we are in the filesystem.</p>
<p>This where filter scripts can help.</p>
<p>Instead of calling an <code>artemis</code> function like <code>getRegistry</code> we instead tell
<code>artemis</code> to pass the artifact data as an argument to our script. So, instead of
returning 100,000 files, we pass that data as an argument to our script before
outputting the results.</p>
<p>A normal <code>artemis</code> script would look like something below:</p>
<pre><code class="language-toml">system = &quot;macos&quot;

[output]
name = &quot;plist_data&quot;
directory = &quot;./tmp&quot;
format = &quot;json&quot;
compress = false
endpoint_id = &quot;6c51b123-1522-4572-9f2a-0bd5abd81b82&quot;
collection_id = 1
output = &quot;local&quot;

[[artifacts]]
artifact_name = &quot;script&quot;
[artifacts.script]
name = &quot;all_users_plist_files&quot;
# Parses all plist files in /Users/%
script = &quot;Ly8gaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL3B1ZmZ5Y2lkL2FydGVtaXMtYXBpL21hc3Rlci9zcmMvbWFjb3MvcGxpc3QudHMKZnVuY3Rpb24gZ2V0UGxpc3QocGF0aCkgewogIGNvbnN0IGRhdGEgPSBEZW5vLmNvcmUub3BzLmdldF9wbGlzdChwYXRoKTsKICBpZiAoZGF0YSA9PT0gIiIpIHsKICAgIHJldHVybiBudWxsOwogIH0KICBjb25zdCBwbGlzdF9kYXRhID0gSlNPTi5wYXJzZShkYXRhKTsKICByZXR1cm4gcGxpc3RfZGF0YTsKfQoKLy8gaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL3B1ZmZ5Y2lkL2FydGVtaXMtYXBpL21hc3Rlci9zcmMvc3lzdGVtL291dHB1dC50cwpmdW5jdGlvbiBvdXRwdXRSZXN1bHRzKGRhdGEsIGRhdGFfbmFtZSwgb3V0cHV0KSB7CiAgY29uc3Qgb3V0cHV0X3N0cmluZyA9IEpTT04uc3RyaW5naWZ5KG91dHB1dCk7CiAgY29uc3Qgc3RhdHVzID0gRGVuby5jb3JlLm9wcy5vdXRwdXRfcmVzdWx0cygKICAgIGRhdGEsCiAgICBkYXRhX25hbWUsCiAgICBvdXRwdXRfc3RyaW5nCiAgKTsKICByZXR1cm4gc3RhdHVzOwp9CgovLyBodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vcHVmZnljaWQvYXJ0ZW1pcy1hcGkvbWFzdGVyL3NyYy9maWxlc3lzdGVtL2RpcmVjdG9yeS50cwphc3luYyBmdW5jdGlvbiByZWFkRGlyKHBhdGgpIHsKICBjb25zdCBkYXRhID0gSlNPTi5wYXJzZShhd2FpdCBmcy5yZWFkRGlyKHBhdGgpKTsKICByZXR1cm4gZGF0YTsKfQoKLy8gbWFpbi50cwphc3luYyBmdW5jdGlvbiBtYWluKCkgewogIGNvbnN0IHN0YXJ0X3BhdGggPSAiL1VzZXJzIjsKICBjb25zdCBwbGlzdF9maWxlcyA9IFtdOwogIGF3YWl0IHJlY3Vyc2VfZGlyKHBsaXN0X2ZpbGVzLCBzdGFydF9wYXRoKTsKICByZXR1cm4gcGxpc3RfZmlsZXM7Cn0KYXN5bmMgZnVuY3Rpb24gcmVjdXJzZV9kaXIocGxpc3RfZmlsZXMsIHN0YXJ0X3BhdGgpIHsKICBpZiAocGxpc3RfZmlsZXMubGVuZ3RoID4gMjApIHsKICAgIGNvbnN0IG91dCA9IHsKICAgICAgbmFtZTogImFydGVtaXNfcGxpc3QiLAogICAgICBkaXJlY3Rvcnk6ICIuL3RtcCIsCiAgICAgIGZvcm1hdDogImpzb24iIC8qIEpTT04gKi8sCiAgICAgIGNvbXByZXNzOiBmYWxzZSwKICAgICAgZW5kcG9pbnRfaWQ6ICJhbnl0aGluZy1pLXdhbnQiLAogICAgICBjb2xsZWN0aW9uX2lkOiAxLAogICAgICBvdXRwdXQ6ICJsb2NhbCIgLyogTE9DQUwgKi8KICAgIH07CiAgICBjb25zdCBzdGF0dXMgPSBvdXRwdXRSZXN1bHRzKAogICAgICBKU09OLnN0cmluZ2lmeShwbGlzdF9maWxlcyksCiAgICAgICJhcnRlbWlzX2luZm8iLAogICAgICBvdXQKICAgICk7CiAgICBpZiAoIXN0YXR1cykgewogICAgICBjb25zb2xlLmxvZygiQ291bGQgbm90IG91dHB1dCB0byBsb2NhbCBkaXJlY3RvcnkiKTsKICAgIH0KICAgIHBsaXN0X2ZpbGVzID0gW107CiAgfQogIGZvciAoY29uc3QgZW50cnkgb2YgYXdhaXQgcmVhZERpcihzdGFydF9wYXRoKSkgewogICAgY29uc3QgcGxpc3RfcGF0aCA9IGAke3N0YXJ0X3BhdGh9LyR7ZW50cnkuZmlsZW5hbWV9YDsKICAgIGlmIChlbnRyeS5pc19maWxlICYmIGVudHJ5LmZpbGVuYW1lLmVuZHNXaXRoKCJwbGlzdCIpKSB7CiAgICAgIGNvbnN0IGRhdGEgPSBnZXRQbGlzdChwbGlzdF9wYXRoKTsKICAgICAgaWYgKGRhdGEgPT09IG51bGwpIHsKICAgICAgICBjb250aW51ZTsKICAgICAgfQogICAgICBjb25zdCBwbGlzdF9pbmZvID0gewogICAgICAgIHBsaXN0X2NvbnRlbnQ6IGRhdGEsCiAgICAgICAgZmlsZTogcGxpc3RfcGF0aAogICAgICB9OwogICAgICBwbGlzdF9maWxlcy5wdXNoKHBsaXN0X2luZm8pOwogICAgICBjb250aW51ZTsKICAgIH0KICAgIGlmIChlbnRyeS5pc19kaXJlY3RvcnkpIHsKICAgICAgYXdhaXQgcmVjdXJzZV9kaXIocGxpc3RfZmlsZXMsIHBsaXN0X3BhdGgpOwogICAgfQogIH0KfQptYWluKCk7Cg==&quot;
</code></pre>
<p>High level overview of what happens:<br />
<code>TOML file -&gt; decode script -&gt; artemis executes script -&gt; output data</code></p>
<p>A filter script would look like something below:</p>
<pre><code class="language-toml">system = &quot;macos&quot;

[output]
name = &quot;info_plist_collection&quot;
directory = &quot;./tmp&quot;
format = &quot;json&quot;
compress = false
endpoint_id = &quot;abdc&quot;
collection_id = 1
output = &quot;local&quot;
filter_name = &quot;apps_info_plists&quot;
# This script will take the files artifact below and filter it to only return Info.plist files
# We could expand this even further by then using the plist parser on the Info.plist path and include that parsed data too
filter_script = &quot;Ly8gbWFpbi50cwpmdW5jdGlvbiBtYWluKCkgewogIGNvbnN0IGFyZ3MgPSBTVEFUSUNfQVJHUzsKICBpZiAoYXJncy5sZW5ndGggPT09IDApIHsKICAgIHJldHVybiBbXTsKICB9CiAgY29uc3QgZGF0YSA9IEpTT04ucGFyc2UoYXJnc1swXSk7CiAgY29uc3QgZmlsdGVyX2ZpbGVzID0gW107CiAgZm9yIChjb25zdCBlbnRyeSBvZiBkYXRhKSB7CiAgICBpZiAoZW50cnkuZmlsZW5hbWUgPT0gIkluZm8ucGxpc3QiKSB7CiAgICAgIGZpbHRlcl9maWxlcy5wdXNoKGVudHJ5KTsKICAgIH0KICB9CiAgcmV0dXJuIGZpbHRlcl9maWxlczsKfQptYWluKCk7Cg==&quot;

[[artifacts]]
artifact_name = &quot;files&quot; # Name of artifact
filter = true
[artifacts.files]
start_path = &quot;/System/Volumes/Data/Applications&quot; # Start of file listing
depth = 100 # How many sub directories to descend
metadata = false # Get executable metadata
md5 = false # MD5 all files
sha1 = false # SHA1 all files
sha256 = false # SHA256 all files
path_regex = &quot;&quot; # Regex for paths
file_regex = &quot;&quot; # Regex for files
</code></pre>
<p>The biggest differences are:</p>
<ul>
<li>We use a <code>[[artifacts]]</code> list to parse our data</li>
<li>We base64 encode our script and assign to <code>filter_script</code> to tell <code>artemis</code>:
take the results of the <code>[[artifacts]]</code> list and filter them before outputting
the data</li>
<li>We then set the <code>filter</code> value to <code>true</code></li>
</ul>
<p>High level overview of what happens:<br />
<code>TOML file -&gt; walkthrough artifacts list -&gt; artemis collects data -&gt; pass data to filter script -&gt; output data</code><br />
All entries in a <code>[[artifacts]]</code> list can be sent through a filter script with
the exception of regular <code>artemis</code> scripts. The output of these scripts do not
go through <code>filter_script</code>.</p>
<p>The <code>TypeScript</code> code for a filter script would be something like below:</p>
<pre><code class="language-typescript">import { MacosFileInfo } from &quot;https://raw.githubusercontent.com/puffycid/artemis-api/master/src/macos/files.ts&quot;;

/**
 * Filters a provided file listing argument to only return Info.plist files from /Applications
 * Two arguments are always provided:
 *   - First is the parsed data serialized into JSON string
 *   - Second is the artifact name (ex: &quot;amcache&quot;)
 * @returns Array of files only containing Info.plist
 */
function main() {
  // Since this is a filter script our data will be passed as a Serde Value that is a string
  const args = Deno.args;
  if (args.length === 0) {
    return [];
  }

  // Parse the provide Serde Value (JSON string) as a MacosFileInfo[]
  const data: MacosFileInfo[] = JSON.parse(args[0]);
  const filter_files: MacosFileInfo[] = [];

  for (const entry of data) {
    if (entry.filename == &quot;Info.plist&quot;) {
      filter_files.push(entry);
    }
  }
  return filter_files;
}

main();
</code></pre>
<p>The key difference between a regular <code>artemis</code> script and a filter script is:</p>
<pre><code class="language-typescript">const args = Deno.args;
if (args.length === 0) {
  return [];
}

// Parse the provide Serde Value (JSON string) as a MacosFileInfo[]
const data: MacosFileInfo[] = JSON.parse(args[0]);
</code></pre>
<p>Here we are taking the first argument provided to our script and parsing it as a
JSON <code>MacosFileInfo</code> object array. As stated above, <code>artemis</code> will pass the
results of each <code>[[artifacts]]</code> entry to our script using serde to serialize the
data as a JSON formattted string.</p>
<p>We then parse and filter the data based on our script</p>
<pre><code class="language-typescript">// Parse the provide Serde Value (JSON string) as a MacosFileInfo[]
const data: MacosFileInfo[] = JSON.parse(args[0]);
const filter_files: MacosFileInfo[] = [];

for (const entry of data) {
  if (entry.filename == &quot;Info.plist&quot;) {
    filter_files.push(entry);
  }
}
</code></pre>
<p>Finally, we take our filtered output and return it back to <code>artemis</code></p>
<pre><code class="language-typescript">return filter_files;
</code></pre>
<p>So our initial data provided to our filter script gets filtered and returned. In
this example, our 100,000 file listing entry gets filtered to only return
entries with the filename <code>Info.plist</code>.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="limitations"><a class="header" href="#limitations">Limitations</a></h1>
<p>It is important to understand the JavaScript runtime for <code>artemis</code> is <strong>not</strong>
like normal JavaScript runtimes like <code>nodejs</code>, <code>deno</code>, <code>bun</code>, etc. These
runtimes are primarily designed to create web apps.</p>
<p>Therefore tutorials or example scripts created for other runtimes will likely
not work with <code>artemis</code>. For example, the JavaScript function <code>console.table()</code>
does not exist in <code>artemis</code>. However, the functions <code>console.log()</code> and
<code>console.error()</code> do exist in <code>artemis</code>.</p>
<p>There JavaScript runtime for <code>artemis</code> is designed specifically to assist with
scripting for IR and forensic investigations.</p>
<p>There are currently some additional limitations to scripting with <code>artemis</code>.</p>
<ol>
<li>All scripts executed through <code>artemis</code> must be in <code>JavaScript</code>. You
<strong>cannot</strong> execute <code>TypeScript</code> scripts directly. You <strong>must</strong> compile and
bundle them into one (1) <code>JavaScript</code> file.</li>
<li>The <code>JavaScript</code> must be in common JS format (cjs). EMCAScript (ES) module
scripts are not supported. The example code below uses <code>esbuild</code> to bundle
the <code>main.ts</code> file to <code>JavaScript</code> using CJS format via <code>deno run build.ts</code>:</li>
</ol>
<pre><code class="language-typescript">import * as esbuild from &quot;https://deno.land/x/esbuild@v0.15.10/mod.js&quot;;
import { denoPlugin } from &quot;https://deno.land/x/esbuild_deno_loader@0.6.0/mod.ts&quot;;

async function main() {
  const _result = await esbuild.build({
    plugins: [denoPlugin()],
    entryPoints: [&quot;./main.ts&quot;],
    outfile: &quot;main.js&quot;,
    bundle: true,
    format: &quot;cjs&quot;,
  });

  esbuild.stop();
}

main();
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="library-usage"><a class="header" href="#library-usage">Library Usage</a></h1>
<p><code>artemis-core</code> is a very simple Rust library. It currently only exposes two (2)
functions:</p>
<ul>
<li><code>parse_toml_file(path: &amp;str)</code> - Parse a TOML collection file at provided path</li>
<li><code>parse_toml_data(data: &amp;[u8])</code> - Parse bytes associated with a TOML collection</li>
</ul>
<p>Both functions will return nothing on success (<code>artemis-core</code> handles data
output) or an error.</p>
<h1 id="logging"><a class="header" href="#logging">Logging</a></h1>
<p><code>artemis-core</code> includes a logging feature that tracks internal issues it may
encounter when executing. If you import <code>artemis-core</code> into your own project you
may register you own logger, however that will then disable the builtin logger
in <code>artemis-core</code>.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="execution"><a class="header" href="#execution">Execution</a></h1>
<p>Windows TOML collection to parse artifacts commonly associated with execution</p>
<pre><code class="language-toml">system = &quot;windows&quot;

[output]
name = &quot;execution_collection&quot;
directory = &quot;./tmp&quot;
format = &quot;json&quot;
compress = true
endpoint_id = &quot;6c51b123-1522-4572-9f2a-0bd5abd81b82&quot;
collection_id = 1
output = &quot;local&quot;

[[artifacts]]
artifact_name = &quot;prefetch&quot;
[artifacts.prefetch]

[[artifacts]]
artifact_name = &quot;amcache&quot;
[artifacts.amcache]

[[artifacts]]
artifact_name = &quot;shimcache&quot;
[artifacts.shimcache]

[[artifacts]]
artifact_name = &quot;userassist&quot;
[artifacts.userassist]

[[artifacts]]
artifact_name = &quot;script&quot;
[artifacts.script]
name = &quot;muicache&quot;
script = &quot;Ly8gaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL3B1ZmZ5Y2lkL2FydGVtaXMtYXBpL21hc3Rlci9zcmMvd2luZG93cy9yZWdpc3RyeS50cwpmdW5jdGlvbiBnZXRSZWdpc3RyeShwYXRoKSB7CiAgY29uc3QgZGF0YSA9IERlbm8uY29yZS5vcHMuZ2V0X3JlZ2lzdHJ5KHBhdGgpOwogIGNvbnN0IHJlc3VsdHMgPSBKU09OLnBhcnNlKGRhdGEpOwogIHJldHVybiByZXN1bHRzOwp9CgovLyBodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vcHVmZnljaWQvYXJ0ZW1pcy1hcGkvbWFzdGVyL3NyYy9lbnZpcm9ubWVudC9lbnYudHMKZnVuY3Rpb24gZ2V0RW52VmFsdWUoa2V5KSB7CiAgY29uc3QgZGF0YSA9IGVudi5lbnZpcm9ubWVudFZhbHVlKGtleSk7CiAgcmV0dXJuIGRhdGE7Cn0KCi8vIGh0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9wdWZmeWNpZC9hcnRlbWlzLWFwaS9tYXN0ZXIvc3JjL2ZpbGVzeXN0ZW0vZGlyZWN0b3J5LnRzCmFzeW5jIGZ1bmN0aW9uIHJlYWREaXIocGF0aCkgewogIGNvbnN0IGRhdGEgPSBKU09OLnBhcnNlKGF3YWl0IGZzLnJlYWREaXIocGF0aCkpOwogIHJldHVybiBkYXRhOwp9CgovLyBodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vcHVmZnljaWQvYXJ0ZW1pcy1hcGkvbWFzdGVyL3NyYy9maWxlc3lzdGVtL2ZpbGVzLnRzCmZ1bmN0aW9uIHN0YXQocGF0aCkgewogIGNvbnN0IGRhdGEgPSBmcy5zdGF0KHBhdGgpOwogIGNvbnN0IHZhbHVlID0gSlNPTi5wYXJzZShkYXRhKTsKICByZXR1cm4gdmFsdWU7Cn0KCi8vIG1haW4udHMKYXN5bmMgZnVuY3Rpb24gbWFpbigpIHsKICBjb25zdCBkcml2ZSA9IGdldEVudlZhbHVlKCJTeXN0ZW1Ecml2ZSIpOwogIGlmIChkcml2ZSA9PT0gIiIpIHsKICAgIHJldHVybiBbXTsKICB9CiAgY29uc3QgbXVpX2FycmF5ID0gW107CiAgY29uc3QgdXNlcnMgPSBgJHtkcml2ZX1cXFVzZXJzYDsKICBmb3IgKGNvbnN0IGVudHJ5IG9mIGF3YWl0IHJlYWREaXIodXNlcnMpKSB7CiAgICB0cnkgewogICAgICBjb25zdCBwYXRoID0gYCR7dXNlcnN9XFwke2VudHJ5LmZpbGVuYW1lfVxcQXBwRGF0YVxcTG9jYWxcXE1pY3Jvc29mdFxcV2luZG93c1xcVXNyQ2xhc3MuZGF0YDsKICAgICAgY29uc3Qgc3RhdHVzID0gc3RhdChwYXRoKTsKICAgICAgaWYgKCFzdGF0dXMuaXNfZmlsZSkgewogICAgICAgIGNvbnRpbnVlOwogICAgICB9CiAgICAgIGNvbnN0IHJlZ19yZXN1bHRzID0gZ2V0UmVnaXN0cnkocGF0aCk7CiAgICAgIGZvciAoY29uc3QgcmVnX2VudHJ5IG9mIHJlZ19yZXN1bHRzKSB7CiAgICAgICAgaWYgKHJlZ19lbnRyeS5wYXRoLmluY2x1ZGVzKAogICAgICAgICAgIkxvY2FsIFNldHRpbmdzXFxTb2Z0d2FyZVxcTWljcm9zb2Z0XFxXaW5kb3dzXFxTaGVsbFxcTXVpQ2FjaGUiCiAgICAgICAgKSkgewogICAgICAgICAgZm9yIChjb25zdCB2YWx1ZSBvZiByZWdfZW50cnkudmFsdWVzKSB7CiAgICAgICAgICAgIGlmICh2YWx1ZS5kYXRhX3R5cGUgIT0gIlJFR19TWiIpIHsKICAgICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgICAgfQogICAgICAgICAgICBjb25zdCBtdWljYWNoZSA9IHsKICAgICAgICAgICAgICBhcHBsaWNhdGlvbjogdmFsdWUudmFsdWUsCiAgICAgICAgICAgICAgZGVzY3JpcHRpb246IHZhbHVlLmRhdGEKICAgICAgICAgICAgfTsKICAgICAgICAgICAgbXVpX2FycmF5LnB1c2gobXVpY2FjaGUpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgfSBjYXRjaCAoX2UpIHsKICAgICAgY29udGludWU7CiAgICB9CiAgfQogIHJldHVybiBtdWlfYXJyYXk7Cn0KbWFpbigpOwo=&quot;

[[artifacts]]
artifact_name = &quot;script&quot;
[artifacts.script]
name = &quot;eventlogs_4688&quot;
script = &quot;Ly8gLi4vLi4vYXJ0ZW1pcy1hcGkvc3JjL3dpbmRvd3MvZXZlbnRsb2dzLnRzCmZ1bmN0aW9uIGdldF9ldmVudGxvZ3MocGF0aCkgewogIGNvbnN0IGRhdGEgPSBEZW5vLmNvcmUub3BzLmdldF9ldmVudGxvZ3MocGF0aCk7CiAgY29uc3QgbG9nX2FycmF5ID0gSlNPTi5wYXJzZShkYXRhKTsKICByZXR1cm4gbG9nX2FycmF5Owp9CgovLyAuLi8uLi9hcnRlbWlzLWFwaS9tb2QudHMKZnVuY3Rpb24gZ2V0RXZlbnRMb2dzKHBhdGgpIHsKICByZXR1cm4gZ2V0X2V2ZW50bG9ncyhwYXRoKTsKfQoKLy8gbWFpbi50cwpmdW5jdGlvbiBtYWluKCkgewogIGNvbnN0IHBhdGggPSAiQzpcXFdpbmRvd3NcXFN5c3RlbTMyXFx3aW5ldnRcXExvZ3NcXFNlY3VyaXR5LmV2dHgiOwogIGNvbnN0IHJlY29yZHMgPSBnZXRFdmVudExvZ3MocGF0aCk7CiAgY29uc3QgcHJvY2Vzc2VzID0gW107CiAgZm9yIChjb25zdCByZWNvcmQgb2YgcmVjb3JkcykgewogICAgaWYgKHJlY29yZC5kYXRhWyJFdmVudCJdWyJTeXN0ZW0iXVsiRXZlbnRJRCJdICE9IDQ2ODgpIHsKICAgICAgY29udGludWU7CiAgICB9CiAgICBwcm9jZXNzZXMucHVzaChyZWNvcmQpOwogIH0KICByZXR1cm4gcHJvY2Vzc2VzOwp9Cm1haW4oKTsK&quot;
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="triage"><a class="header" href="#triage">Triage</a></h1>
<p>Windows TOML collection focusing on quickly collecting data related to a Windows
alert.</p>
<pre><code class="language-toml">system = &quot;windows&quot;

[output]
name = &quot;triage_collection&quot;
directory = &quot;./tmp&quot;
format = &quot;json&quot;
compress = true
endpoint_id = &quot;6c51b123-1522-4572-9f2a-0bd5abd81b82&quot;
collection_id = 1
output = &quot;local&quot;

[[artifacts]]
artifact_name = &quot;processes&quot;
[artifacts.processes]
md5 = true
sha1 = false
sha256 = false
metadata = true

[[artifacts]]
artifact_name = &quot;prefetch&quot;
[artifacts.prefetch]

[[artifacts]]
artifact_name = &quot;userassist&quot;
[artifacts.userassist]

[[artifacts]]
artifact_name = &quot;script&quot;
[artifacts.script]
name = &quot;office_mru&quot;
# Pulls back recently opened Office documents for all users from NTUSER.DAT files
script = &quot;Ly8gaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL3B1ZmZ5Y2lkL2FydGVtaXMtYXBpL21hc3Rlci9zcmMvd2luZG93cy9yZWdpc3RyeS50cwpmdW5jdGlvbiBnZXRSZWdpc3RyeShwYXRoKSB7CiAgY29uc3QgZGF0YSA9IERlbm8uY29yZS5vcHMuZ2V0X3JlZ2lzdHJ5KHBhdGgpOwogIGNvbnN0IHJlc3VsdHMgPSBKU09OLnBhcnNlKGRhdGEpOwogIHJldHVybiByZXN1bHRzOwp9CgovLyBodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vcHVmZnljaWQvYXJ0ZW1pcy1hcGkvbWFzdGVyL3NyYy9lbnZpcm9ubWVudC9lbnYudHMKZnVuY3Rpb24gZ2V0RW52VmFsdWUoa2V5KSB7CiAgY29uc3QgZGF0YSA9IGVudi5lbnZpcm9ubWVudFZhbHVlKGtleSk7CiAgcmV0dXJuIGRhdGE7Cn0KCi8vIGh0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9wdWZmeWNpZC9hcnRlbWlzLWFwaS9tYXN0ZXIvc3JjL2ZpbGVzeXN0ZW0vZGlyZWN0b3J5LnRzCmFzeW5jIGZ1bmN0aW9uIHJlYWREaXIocGF0aCkgewogIGNvbnN0IGRhdGEgPSBKU09OLnBhcnNlKGF3YWl0IGZzLnJlYWREaXIocGF0aCkpOwogIHJldHVybiBkYXRhOwp9CgovLyBodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vcHVmZnljaWQvYXJ0ZW1pcy1hcGkvbWFzdGVyL3NyYy9maWxlc3lzdGVtL2ZpbGVzLnRzCmZ1bmN0aW9uIHN0YXQocGF0aCkgewogIGNvbnN0IGRhdGEgPSBmcy5zdGF0KHBhdGgpOwogIGNvbnN0IHZhbHVlID0gSlNPTi5wYXJzZShkYXRhKTsKICByZXR1cm4gdmFsdWU7Cn0KCi8vIG1haW4udHMKYXN5bmMgZnVuY3Rpb24gbWFpbigpIHsKICBjb25zdCBkcml2ZSA9IGdldEVudlZhbHVlKCJTeXN0ZW1Ecml2ZSIpOwogIGlmIChkcml2ZSA9PT0gIiIpIHsKICAgIHJldHVybiBbXTsKICB9CiAgY29uc3Qgb2ZmaWNlX2FycmF5ID0gW107CiAgY29uc3QgdXNlcnMgPSBgJHtkcml2ZX1cXFVzZXJzYDsKICBmb3IgKGNvbnN0IGVudHJ5IG9mIGF3YWl0IHJlYWREaXIodXNlcnMpKSB7CiAgICB0cnkgewogICAgICBjb25zdCBwYXRoID0gYCR7dXNlcnN9XFwke2VudHJ5LmZpbGVuYW1lfVxcTlRVU0VSLkRBVGA7CiAgICAgIGNvbnN0IHN0YXR1cyA9IHN0YXQocGF0aCk7CiAgICAgIGlmICghc3RhdHVzLmlzX2ZpbGUpIHsKICAgICAgICBjb250aW51ZTsKICAgICAgfQogICAgICBjb25zdCByZWdfcmVzdWx0cyA9IGdldFJlZ2lzdHJ5KHBhdGgpOwogICAgICBmb3IgKGNvbnN0IHJlZ19lbnRyeSBvZiByZWdfcmVzdWx0cykgewogICAgICAgIGlmICghcmVnX2VudHJ5LnBhdGgubWF0Y2goCiAgICAgICAgICAvTWljcm9zb2Z0XFxPZmZpY2VcXDEoNHw1fDYpXC4wXFwuKlxcKEZpbGUgTVJVfCBVc2VyIE1SVVxcLipcXEZpbGUgTVJVKS8KICAgICAgICApKSB7CiAgICAgICAgICBjb250aW51ZTsKICAgICAgICB9CiAgICAgICAgZm9yIChjb25zdCB2YWx1ZSBvZiByZWdfZW50cnkudmFsdWVzKSB7CiAgICAgICAgICBpZiAoIXZhbHVlLnZhbHVlLmluY2x1ZGVzKCJJdGVtICIpKSB7CiAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgfQogICAgICAgICAgY29uc3Qgd2luZG93c19uYW5vID0gMWU3OwogICAgICAgICAgY29uc3Qgc2Vjb25kc190b191bml4ID0gMTE2NDQ0NzM2MDA7CiAgICAgICAgICBjb25zdCBmaWxldGltZSA9IHBhcnNlSW50KAogICAgICAgICAgICB2YWx1ZS5kYXRhLnNwbGl0KCJbVCIpWzFdLnNwbGl0KCJdIilbMF0sCiAgICAgICAgICAgIDE2CiAgICAgICAgICApOwogICAgICAgICAgY29uc3QgdW5peGVwb2NoID0gZmlsZXRpbWUgLyB3aW5kb3dzX25hbm8gLSBzZWNvbmRzX3RvX3VuaXg7CiAgICAgICAgICBjb25zdCBtcnUgPSB7CiAgICAgICAgICAgIGZpbGVfcGF0aDogdmFsdWUuZGF0YS5zcGxpdCgiKiIpWzFdLAogICAgICAgICAgICByZWdfcGF0aDogcmVnX2VudHJ5LnBhdGgsCiAgICAgICAgICAgIGxhc3Rfb3BlbmVkOiB1bml4ZXBvY2gsCiAgICAgICAgICAgIGxhc3Rfb3BlbmVkX2ZpbGV0aW1lOiBmaWxldGltZSwKICAgICAgICAgICAgcmVnX2ZpbGVfcGF0aDogcGF0aAogICAgICAgICAgfTsKICAgICAgICAgIG9mZmljZV9hcnJheS5wdXNoKG1ydSk7CiAgICAgICAgfQogICAgICB9CiAgICB9IGNhdGNoIChfZSkgewogICAgICBjb250aW51ZTsKICAgIH0KICB9CiAgcmV0dXJuIG9mZmljZV9hcnJheTsKfQptYWluKCk7Cg==&quot;

[[artifacts]]
artifact_name = &quot;script&quot;
[artifacts.script]
name = &quot;recent_files&quot;
# Parses all recent accessed files (shortcuts/lnk files) for all users
script = &quot;Ly8gaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL3B1ZmZ5Y2lkL2FydGVtaXMtYXBpL21hc3Rlci9zcmMvd2luZG93cy9zaG9ydGN1dHMudHMKZnVuY3Rpb24gZ2V0TG5rRmlsZShwYXRoKSB7CiAgY29uc3QgZGF0YSA9IERlbm8uY29yZS5vcHMuZ2V0X2xua19maWxlKHBhdGgpOwogIGNvbnN0IHJlc3VsdHMgPSBKU09OLnBhcnNlKGRhdGEpOwogIHJldHVybiByZXN1bHRzOwp9CgovLyBodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vcHVmZnljaWQvYXJ0ZW1pcy1hcGkvbWFzdGVyL3NyYy9lbnZpcm9ubWVudC9lbnYudHMKZnVuY3Rpb24gZ2V0RW52VmFsdWUoa2V5KSB7CiAgY29uc3QgZGF0YSA9IGVudi5lbnZpcm9ubWVudFZhbHVlKGtleSk7CiAgcmV0dXJuIGRhdGE7Cn0KCi8vIGh0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9wdWZmeWNpZC9hcnRlbWlzLWFwaS9tYXN0ZXIvc3JjL2ZpbGVzeXN0ZW0vZGlyZWN0b3J5LnRzCmFzeW5jIGZ1bmN0aW9uIHJlYWREaXIocGF0aCkgewogIGNvbnN0IGRhdGEgPSBKU09OLnBhcnNlKGF3YWl0IGZzLnJlYWREaXIocGF0aCkpOwogIHJldHVybiBkYXRhOwp9CgovLyBtYWluLnRzCmFzeW5jIGZ1bmN0aW9uIG1haW4oKSB7CiAgY29uc3QgZHJpdmUgPSBnZXRFbnZWYWx1ZSgiU3lzdGVtRHJpdmUiKTsKICBpZiAoZHJpdmUgPT09ICIiKSB7CiAgICByZXR1cm4gW107CiAgfQogIGNvbnN0IHVzZXJzID0gYCR7ZHJpdmV9XFxVc2Vyc2A7CiAgY29uc3QgcmVjZW50X2ZpbGVzID0gW107CiAgZm9yIChjb25zdCBlbnRyeSBvZiBhd2FpdCByZWFkRGlyKHVzZXJzKSkgewogICAgdHJ5IHsKICAgICAgY29uc3QgcGF0aCA9IGAke3VzZXJzfVxcJHtlbnRyeS5maWxlbmFtZX1cXEFwcERhdGFcXFJvYW1pbmdcXE1pY3Jvc29mdFxcV2luZG93c1xcUmVjZW50YDsKICAgICAgZm9yIChjb25zdCBlbnRyeTIgb2YgYXdhaXQgcmVhZERpcihwYXRoKSkgewogICAgICAgIGlmICghZW50cnkyLmZpbGVuYW1lLmVuZHNXaXRoKCJsbmsiKSkgewogICAgICAgICAgY29udGludWU7CiAgICAgICAgfQogICAgICAgIGNvbnN0IGxua19maWxlID0gYCR7cGF0aH1cXCR7ZW50cnkyLmZpbGVuYW1lfWA7CiAgICAgICAgY29uc3QgbG5rID0gZ2V0TG5rRmlsZShsbmtfZmlsZSk7CiAgICAgICAgcmVjZW50X2ZpbGVzLnB1c2gobG5rKTsKICAgICAgfQogICAgfSBjYXRjaCAoX2Vycm9yKSB7CiAgICAgIGNvbnRpbnVlOwogICAgfQogIH0KICByZXR1cm4gcmVjZW50X2ZpbGVzOwp9Cm1haW4oKTsK&quot;

[[artifacts]]
artifact_name = &quot;script&quot;
[artifacts.script]
name = &quot;logons_7_days&quot;
# Pulls back all logons within the past seven (7) days (logoffs are not included)
script = &quot;Ly8gaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL3B1ZmZ5Y2lkL2FydGVtaXMtYXBpL21hc3Rlci9zcmMvd2luZG93cy9ldmVudGxvZ3MudHMKZnVuY3Rpb24gZ2V0RXZlbnRsb2dzKHBhdGgpIHsKICBjb25zdCByZXN1bHRzID0gRGVuby5jb3JlLm9wcy5nZXRfZXZlbnRsb2dzKHBhdGgpOwogIGNvbnN0IGRhdGEgPSBKU09OLnBhcnNlKHJlc3VsdHMpOwogIHJldHVybiBkYXRhOwp9CgovLyBtYWluLnRzCmZ1bmN0aW9uIG1haW4oKSB7CiAgY29uc3QgcGF0aCA9ICJDOlxcV2luZG93c1xcU3lzdGVtMzJcXHdpbmV2dFxcTG9nc1xcU2VjdXJpdHkuZXZ0eCI7CiAgY29uc3QgcmVjb3JkcyA9IGdldEV2ZW50bG9ncyhwYXRoKTsKICBjb25zdCBsb2dvbnMgPSBbXTsKICBjb25zdCB0aW1lX25vdyA9IG5ldyBEYXRlKCk7CiAgY29uc3QgbWlsbGlzZWNvbmRzID0gdGltZV9ub3cuZ2V0VGltZSgpOwogIGNvbnN0IG5hbm9zZWNvbmRzID0gbWlsbGlzZWNvbmRzICogMWU2OwogIGNvbnN0IHNldmVuX2RheXMgPSA2MDQ4ZTExOwogIGNvbnN0IHN0YXJ0X2xvZ29ucyA9IG5hbm9zZWNvbmRzIC0gc2V2ZW5fZGF5czsKICBmb3IgKGNvbnN0IHJlY29yZCBvZiByZWNvcmRzKSB7CiAgICBpZiAocmVjb3JkLmRhdGFbIkV2ZW50Il1bIlN5c3RlbSJdWyJFdmVudElEIl0gIT0gNDYyNCAmJiByZWNvcmQuZGF0YVsiRXZlbnQiXVsiU3lzdGVtIl1bIkV2ZW50SUQiXVsiI3RleHQiXSAhPSA0NjI0KSB7CiAgICAgIGNvbnRpbnVlOwogICAgfQogICAgaWYgKHJlY29yZC50aW1lc3RhbXAgPCBzdGFydF9sb2dvbnMpIHsKICAgICAgY29udGludWU7CiAgICB9CiAgICBjb25zdCBlbnRyeSA9IHsKICAgICAgdGltZXN0YW1wOiByZWNvcmQudGltZXN0YW1wLAogICAgICB0YXJnZXRfc2lkOiByZWNvcmQuZGF0YVsiRXZlbnQiXVsiRXZlbnREYXRhIl1bIlRhcmdldFVzZXJTaWQiXSwKICAgICAgdGFyZ2V0X3VzZXJuYW1lOiByZWNvcmQuZGF0YVsiRXZlbnQiXVsiRXZlbnREYXRhIl1bIlRhcmdldFVzZXJOYW1lIl0sCiAgICAgIHRhcmdldF9kb21haW46IHJlY29yZC5kYXRhWyJFdmVudCJdWyJFdmVudERhdGEiXVsiVGFyZ2V0RG9tYWluTmFtZSJdLAogICAgICB0eXBlOiByZWNvcmQuZGF0YVsiRXZlbnQiXVsiRXZlbnREYXRhIl1bIkxvZ29uVHlwZSJdLAogICAgICBob3N0bmFtZTogcmVjb3JkLmRhdGFbIkV2ZW50Il1bIkV2ZW50RGF0YSJdWyJXb3Jrc3RhdGlvbk5hbWUiXSwKICAgICAgaXBfYWRkcmVzczogcmVjb3JkLmRhdGFbIkV2ZW50Il1bIkV2ZW50RGF0YSJdWyJJcEFkZHJlc3MiXSwKICAgICAgcHJvY2Vzc19uYW1lOiByZWNvcmQuZGF0YVsiRXZlbnQiXVsiRXZlbnREYXRhIl1bIlByb2Nlc3NOYW1lIl0sCiAgICAgIHJhdzogcmVjb3JkCiAgICB9OwogICAgbG9nb25zLnB1c2goZW50cnkpOwogIH0KICByZXR1cm4gbG9nb25zOwp9Cm1haW4oKTsK&quot;

[[artifacts]]
artifact_name = &quot;script&quot;
[artifacts.script]
name = &quot;powershell&quot;
# Parses PowerShell logs looking for EIDs 400,4104,4103, and 800
script = &quot;Ly8gaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL3B1ZmZ5Y2lkL2FydGVtaXMtYXBpL21hc3Rlci9zcmMvd2luZG93cy9ldmVudGxvZ3MudHMKZnVuY3Rpb24gZ2V0RXZlbnRsb2dzKHBhdGgpIHsKICBjb25zdCByZXN1bHRzID0gRGVuby5jb3JlLm9wcy5nZXRfZXZlbnRsb2dzKHBhdGgpOwogIGNvbnN0IGRhdGEgPSBKU09OLnBhcnNlKHJlc3VsdHMpOwogIHJldHVybiBkYXRhOwp9CgovLyBtYWluLnRzCmZ1bmN0aW9uIG1haW4oKSB7CiAgY29uc3QgcGF0aHMgPSBbCiAgICAiQzpcXFdpbmRvd3NcXFN5c3RlbTMyXFx3aW5ldnRcXExvZ3NcXFdpbmRvd3MgUG93ZXJTaGVsbC5ldnR4IiwKICAgICJDOlxcV2luZG93c1xcU3lzdGVtMzJcXHdpbmV2dFxcTG9nc1xcTWljcm9zb2Z0LVdpbmRvd3MtUG93ZXJTaGVsbCU0T3BlcmF0aW9uYWwuZXZ0eCIKICBdOwogIGNvbnN0IGJsb2NrcyA9IFtdOwogIGNvbnN0IHBvd2VyID0gW107CiAgY29uc3QgZWlkcyA9IFs0MDAsIDgwMCwgNDEwNCwgNDEwM107CiAgZm9yIChjb25zdCBwYXRoIG9mIHBhdGhzKSB7CiAgICBjb25zdCByZWNvcmRzID0gZ2V0RXZlbnRsb2dzKHBhdGgpOwogICAgZm9yIChjb25zdCByZWNvcmQgb2YgcmVjb3JkcykgewogICAgICBpZiAoIWVpZHMuaW5jbHVkZXMocmVjb3JkLmRhdGFbIkV2ZW50Il1bIlN5c3RlbSJdWyJFdmVudElEIl0pICYmICFlaWRzLmluY2x1ZGVzKHJlY29yZC5kYXRhWyJFdmVudCJdWyJTeXN0ZW0iXVsiRXZlbnRJRCJdWyIjdGV4dCJdKSkgewogICAgICAgIGNvbnRpbnVlOwogICAgICB9CiAgICAgIGlmIChwYXRoLmluY2x1ZGVzKCJXaW5kb3dzIFBvd2VyU2hlbGwuZXZ0eCIpKSB7CiAgICAgICAgY29uc3QgcG93ZXJzaGVsbCA9IHsKICAgICAgICAgIHRpbWVzdGFtcDogcmVjb3JkLnRpbWVzdGFtcCwKICAgICAgICAgIGRhdGE6IHJlY29yZC5kYXRhWyJFdmVudCJdWyJFdmVudERhdGEiXVsiRGF0YSJdWyIjdGV4dCJdLAogICAgICAgICAgcmF3OiByZWNvcmQKICAgICAgICB9OwogICAgICAgIHBvd2VyLnB1c2gocG93ZXJzaGVsbCk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgY29uc3QgYmxvY2sgPSB7CiAgICAgICAgICB0aW1lc3RhbXA6IHJlY29yZC50aW1lc3RhbXAsCiAgICAgICAgICBwYXRoOiByZWNvcmQuZGF0YVsiRXZlbnQiXVsiRXZlbnREYXRhIl1bIlBhdGgiXSwKICAgICAgICAgIHRleHQ6IHJlY29yZC5kYXRhWyJFdmVudCJdWyJFdmVudERhdGEiXVsiU2NyaXB0QmxvY2tUZXh0Il0sCiAgICAgICAgICBpZDogcmVjb3JkLmRhdGFbIkV2ZW50Il1bIkV2ZW50RGF0YSJdWyJTY3JpcHRCbG9ja0lkIl0sCiAgICAgICAgICByYXc6IHJlY29yZAogICAgICAgIH07CiAgICAgICAgYmxvY2tzLnB1c2goYmxvY2spOwogICAgICB9CiAgICB9CiAgfQogIGNvbnN0IGxvZ3MgPSB7CiAgICBzY3JpcHRibG9ja3M6IGJsb2NrcywKICAgIHBvd2Vyc2hlbGw6IHBvd2VyCiAgfTsKICByZXR1cm4gbG9nczsKfQptYWluKCk7Cg==&quot;
</code></pre>
<p>macOS TOML collection focusing on quickly collecting data related to a macOS
alert.</p>
<pre><code class="language-toml">system = &quot;macos&quot;

[output]
name = &quot;triage_collection&quot;
directory = &quot;./tmp&quot;
format = &quot;json&quot;
compress = true
endpoint_id = &quot;6c51b123-1522-4572-9f2a-0bd5abd81b82&quot;
collection_id = 1
output = &quot;local&quot;
filter_name = &quot;unifiedlogs_fsevents_filter&quot;
# Filter for all logs and FsEvents that contain &quot;.dmg&quot; or &quot;Downloads
filter_script=&quot;ZnVuY3Rpb24gZmlsdGVyTG9ncyhkYXRhKSB7CiAgY29uc3QgbG9ncyA9IFtdOwogIGNvbnN0IGxvZ0RhdGEgPSBKU09OLnBhcnNlKGRhdGEpOwogIGZvciAobGV0IGVudHJ5ID0gMDsgZW50cnkgPCBsb2dEYXRhLmxlbmd0aDsgZW50cnkrKykgewogICAgaWYgKCFsb2dEYXRhW2VudHJ5XS5tZXNzYWdlLmluY2x1ZGVzKCJEb3dubG9hZHMiKSAmJiAhbG9nRGF0YVtlbnRyeV0ubWVzc2FnZS5pbmNsdWRlcygiLmRtZyIpKSB7CiAgICAgIGNvbnRpbnVlOwogICAgfQogICAgbG9ncy5wdXNoKGxvZ0RhdGFbZW50cnldKTsKICB9CiAgcmV0dXJuIGxvZ3M7Cn0KZnVuY3Rpb24gZmlsdGVyRXZlbnRzKGRhdGEpIHsKICBjb25zdCBldmVudHMgPSBbXTsKICBjb25zdCBldmVudHNEYXRhID0gSlNPTi5wYXJzZShkYXRhKTsKICBmb3IgKGNvbnN0IGVudHJ5IG9mIGV2ZW50c0RhdGEpIHsKICAgIGlmICghZW50cnkucGF0aC5pbmNsdWRlcygiLmRtZyIpICYmICFlbnRyeS5wYXRoLmluY2x1ZGVzKCJEb3dubG9hZHMiKSkgewogICAgICBjb250aW51ZTsKICAgIH0KICAgIGV2ZW50cy5wdXNoKGVudHJ5KTsKICB9CiAgcmV0dXJuIGV2ZW50czsKfQoKZnVuY3Rpb24gbWFpbigpIHsKICBjb25zdCBhcmdzOiBzdHJpbmdbXSA9IFNUQVRJQ19BUkdTOwogIGlmIChhcmdzLmxlbmd0aCAhPSAyKSB7CiAgICByZXR1cm4gIm1pc3NpbmcgYXJncyIKICB9CiAgaWYgKGFyZ3NbMV0gPT09ICJ1bmlmaWVkbG9ncyIpIHsKICAgIHJldHVybiBmaWx0ZXJMb2dzKGFyZ3NbMF0pOwogIH0KICBpZiAoYXJnc1sxXSA9PT0gImZzZXZlbnRzZCIpIHsKICAgIHJldHVybiBmaWx0ZXJFdmVudHMoYXJnc1swXSk7CiAgfQoKICByZXR1cm4gSlNPTi5wYXJzZShhcmdzWzBdKTsKfQptYWluKCk7Cg==&quot;

[[artifacts]]
artifact_name = &quot;processes&quot;
[artifacts.processes]
md5 = true
sha1 = false
sha256 = false
metadata = true

[[artifacts]]
artifact_name = &quot;unifiedlogs&quot;
filter = true
[artifacts.unifiedlogs]
sources = [&quot;Persist&quot;]

[[artifacts]]
artifact_name = &quot;fseventsd&quot;
filter = true

[[artifacts]]
artifact_name = &quot;chromium-history&quot;

[[artifacts]]
artifact_name = &quot;chromium-downloads&quot;

[[artifacts]]
artifact_name = &quot;firefox-history&quot;

[[artifacts]]
artifact_name = &quot;firefox-downloads&quot;

[[artifacts]]
artifact_name = &quot;safari-history&quot;

[[artifacts]]
artifact_name = &quot;safari-downloads&quot;
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="live-response"><a class="header" href="#live-response">Live Response</a></h1>
<p>Windows TOML collection focusing on collecting data to help investigate a
Windows incident.</p>
<pre><code class="language-toml">system = &quot;windows&quot;

[output]
name = &quot;windows_collection&quot;
directory = &quot;./tmp&quot;
format = &quot;jsonl&quot;
compress = true
endpoint_id = &quot;6c51b123-1522-4572-9f2a-0bd5abd81b82&quot;
collection_id = 1
output = &quot;local&quot;

[[artifacts]]
artifact_name = &quot;prefetch&quot;
[artifacts.prefetch]

[[artifacts]]
artifact_name = &quot;processes&quot;
[artifacts.processes]
md5 = true
sha1 = false
sha256 = false
metadata = true

[[artifacts]]
artifact_name = &quot;systeminfo&quot;

[[artifacts]]
artifact_name = &quot;chromium-history&quot;

[[artifacts]]
artifact_name = &quot;chromium-downloads&quot;

[[artifacts]]
artifact_name = &quot;firefox-history&quot;

[[artifacts]]
artifact_name = &quot;firefox-downloads&quot;

[[artifacts]]
artifact_name = &quot;amcache&quot;
[artifacts.amcache]

[[artifacts]]
artifact_name = &quot;bits&quot;
[artifacts.bits]
carve = true

[[artifacts]]
artifact_name = &quot;eventlogs&quot;
[artifacts.eventlogs]

[[artifacts]]
artifact_name = &quot;rawfiles&quot;
[artifacts.rawfiles]
drive_letter = 'C'
start_path = &quot;C:\\&quot;
depth = 40
recover_indx = true
md5 = true
sha1 = false
sha256 = false
metadata = true

[[artifacts]]
artifact_name = &quot;registry&quot; # Parses the whole Registry file
[artifacts.registry]
user_hives = true # All NTUSER.DAT and UsrClass.dat
system_hives = true # SYSTEM, SOFTWARE, SAM, SECURITY

[[artifacts]]
artifact_name = &quot;shellbags&quot;
[artifacts.shellbags]
resolve_guids = true

[[artifacts]]
artifact_name = &quot;shimcache&quot;
[artifacts.shimcache]

[[artifacts]]
artifact_name = &quot;srum&quot;
[artifacts.srum]

[[artifacts]]
artifact_name = &quot;userassist&quot;
[artifacts.userassist]

[[artifacts]]
artifact_name = &quot;users&quot;
[artifacts.users]

[[artifacts]]
artifact_name = &quot;usnjrnl&quot;
[artifacts.usnjrnl]

[[artifacts]]
artifact_name = &quot;script&quot;
[artifacts.script]
name = &quot;recent_files&quot;
# Parses all recent accessed files (shortcuts/lnk files) for all users
script = &quot;Ly8gaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL3B1ZmZ5Y2lkL2FydGVtaXMtYXBpL21hc3Rlci9zcmMvd2luZG93cy9zaG9ydGN1dHMudHMKZnVuY3Rpb24gZ2V0TG5rRmlsZShwYXRoKSB7CiAgY29uc3QgZGF0YSA9IERlbm8uY29yZS5vcHMuZ2V0X2xua19maWxlKHBhdGgpOwogIGNvbnN0IHJlc3VsdHMgPSBKU09OLnBhcnNlKGRhdGEpOwogIHJldHVybiByZXN1bHRzOwp9CgovLyBodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vcHVmZnljaWQvYXJ0ZW1pcy1hcGkvbWFzdGVyL3NyYy9lbnZpcm9ubWVudC9lbnYudHMKZnVuY3Rpb24gZ2V0RW52VmFsdWUoa2V5KSB7CiAgY29uc3QgZGF0YSA9IGVudi5lbnZpcm9ubWVudFZhbHVlKGtleSk7CiAgcmV0dXJuIGRhdGE7Cn0KCi8vIGh0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9wdWZmeWNpZC9hcnRlbWlzLWFwaS9tYXN0ZXIvc3JjL2ZpbGVzeXN0ZW0vZGlyZWN0b3J5LnRzCmFzeW5jIGZ1bmN0aW9uIHJlYWREaXIocGF0aCkgewogIGNvbnN0IGRhdGEgPSBKU09OLnBhcnNlKGF3YWl0IGZzLnJlYWREaXIocGF0aCkpOwogIHJldHVybiBkYXRhOwp9CgovLyBtYWluLnRzCmFzeW5jIGZ1bmN0aW9uIG1haW4oKSB7CiAgY29uc3QgZHJpdmUgPSBnZXRFbnZWYWx1ZSgiU3lzdGVtRHJpdmUiKTsKICBpZiAoZHJpdmUgPT09ICIiKSB7CiAgICByZXR1cm4gW107CiAgfQogIGNvbnN0IHVzZXJzID0gYCR7ZHJpdmV9XFxVc2Vyc2A7CiAgY29uc3QgcmVjZW50X2ZpbGVzID0gW107CiAgZm9yIChjb25zdCBlbnRyeSBvZiBhd2FpdCByZWFkRGlyKHVzZXJzKSkgewogICAgdHJ5IHsKICAgICAgY29uc3QgcGF0aCA9IGAke3VzZXJzfVxcJHtlbnRyeS5maWxlbmFtZX1cXEFwcERhdGFcXFJvYW1pbmdcXE1pY3Jvc29mdFxcV2luZG93c1xcUmVjZW50YDsKICAgICAgZm9yIChjb25zdCBlbnRyeTIgb2YgYXdhaXQgcmVhZERpcihwYXRoKSkgewogICAgICAgIGlmICghZW50cnkyLmZpbGVuYW1lLmVuZHNXaXRoKCJsbmsiKSkgewogICAgICAgICAgY29udGludWU7CiAgICAgICAgfQogICAgICAgIGNvbnN0IGxua19maWxlID0gYCR7cGF0aH1cXCR7ZW50cnkyLmZpbGVuYW1lfWA7CiAgICAgICAgY29uc3QgbG5rID0gZ2V0TG5rRmlsZShsbmtfZmlsZSk7CiAgICAgICAgcmVjZW50X2ZpbGVzLnB1c2gobG5rKTsKICAgICAgfQogICAgfSBjYXRjaCAoX2Vycm9yKSB7CiAgICAgIGNvbnRpbnVlOwogICAgfQogIH0KICByZXR1cm4gcmVjZW50X2ZpbGVzOwp9Cm1haW4oKTsK&quot;
</code></pre>
<p>macOS colleciton focusing on collecting data to help investigate a macOS
incident.</p>
<pre><code class="language-toml">system = &quot;macos&quot;

[output]
name = &quot;macos_collection&quot;
directory = &quot;./tmp&quot;
format = &quot;jsonl&quot;
compress = true
endpoint_id = &quot;6c51b123-1522-4572-9f2a-0bd5abd81b82&quot;
collection_id = 1
output = &quot;local&quot;

[[artifacts]]
artifact_name = &quot;processes&quot;
[artifacts.processes]
md5 = true
sha1 = false
sha256 = false
metadata = true

[[artifacts]]
artifact_name = &quot;loginitems&quot;

[[artifacts]]
artifact_name = &quot;emond&quot;

[[artifacts]]
artifact_name = &quot;fseventsd&quot;

[[artifacts]]
artifact_name = &quot;launchd&quot;

[[artifacts]]
artifact_name = &quot;files&quot;
[artifacts.files]
start_path = &quot;/&quot;
depth = 90
metadata = true
md5 = true
sha1 = false
sha256 = false
regex_filter = &quot;&quot;

[[artifacts]]
artifact_name = &quot;users&quot;

[[artifacts]]
artifact_name = &quot;groups&quot;

[[artifacts]]
artifact_name = &quot;systeminfo&quot;

[[artifacts]]
artifact_name = &quot;shell_history&quot;

[[artifacts]]
artifact_name = &quot;chromium-history&quot;

[[artifacts]]
artifact_name = &quot;chromium-downloads&quot;

[[artifacts]]
artifact_name = &quot;firefox-history&quot;

[[artifacts]]
artifact_name = &quot;firefox-downloads&quot;

[[artifacts]]
artifact_name = &quot;safari-history&quot;

[[artifacts]]
artifact_name = &quot;safari-downloads&quot;

[[artifacts]]
artifact_name = &quot;cron&quot;

[[artifacts]]
artifact_name = &quot;unifiedlogs&quot;
[artifacts.unifiedlogs]
sources = [&quot;Persist&quot;, &quot;Special&quot;, &quot;Signpost&quot;, &quot;HighVolume&quot;] # Option to specify the log directories (sources)
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="file-listings"><a class="header" href="#file-listings">File Listings</a></h1>
<p>Windows TOML collection looking for all files created in the last 14 days</p>
<pre><code class="language-toml">system = &quot;windows&quot;

[output]
name = &quot;recent_files&quot;
directory = &quot;./tmp&quot;
format = &quot;jsonl&quot;
compress = false
endpoint_id = &quot;abdc&quot;
collection_id = 1
output = &quot;local&quot;
filter_name = &quot;recently_created_files&quot;
# This script will take the search artifact below and filter it to only return files that were created in the past 14 days
filter_script = &quot;Ly8gbWFpbi50cwpmdW5jdGlvbiBtYWluKCkgewogIGNvbnN0IGFyZ3MgPSBTVEFUSUNfQVJHUzsKICBpZiAoYXJncy5sZW5ndGggPT09IDApIHsKICAgIHJldHVybiBbXTsKICB9CiAgY29uc3QgZGF0YSA9IEpTT04ucGFyc2UoYXJnc1swXSk7CiAgY29uc3QgdGltZV9ub3cgPSBuZXcgRGF0ZSgpOwogIGNvbnN0IG1pbGxpc2Vjb25kcyA9IHRpbWVfbm93LmdldFRpbWUoKTsKICBjb25zdCBzZWNvbmRzID0gbWlsbGlzZWNvbmRzIC8gMWUzOwogIGNvbnN0IGZvdXJ0ZWVuX2RheXMgPSAxMjA5NjAwOwogIGNvbnN0IGVhcmxpZXN0X3N0YXJ0ID0gc2Vjb25kcyAtIGZvdXJ0ZWVuX2RheXM7CiAgY29uc3QgZmlsdGVyX2RhdGEgPSBbXTsKICBmb3IgKGNvbnN0IGVudHJ5IG9mIGRhdGEpIHsKICAgIGlmIChlbnRyeS5jcmVhdGVkIDwgZWFybGllc3Rfc3RhcnQpIHsKICAgICAgY29udGludWU7CiAgICB9CiAgICBmaWx0ZXJfZGF0YS5wdXNoKGVudHJ5KTsKICB9CiAgcmV0dXJuIGZpbHRlcl9kYXRhOwp9Cm1haW4oKTsK&quot;

[[artifacts]]
artifact_name = &quot;files&quot; # Name of artifact
filter = true
[artifacts.files]
start_path = &quot;C:\\&quot; # Start of file listing
depth = 100 # How many sub directories to descend
</code></pre>
<p>macOS TOML collection looking for all files created in the last 14 days</p>
<pre><code class="language-toml">system = &quot;macos&quot;

[output]
name = &quot;recent_files&quot;
directory = &quot;./tmp&quot;
format = &quot;jsonl&quot;
compress = false
endpoint_id = &quot;abdc&quot;
collection_id = 1
output = &quot;local&quot;
filter_name = &quot;recently_created_files&quot;
# This script will take the search artifact below and filter it to only return files that were created in the past 14 days
filter_script = &quot;Ly8gbWFpbi50cwpmdW5jdGlvbiBtYWluKCkgewogIGNvbnN0IGFyZ3MgPSBTVEFUSUNfQVJHUzsKICBpZiAoYXJncy5sZW5ndGggPT09IDApIHsKICAgIHJldHVybiBbXTsKICB9CiAgY29uc3QgZGF0YSA9IEpTT04ucGFyc2UoYXJnc1swXSk7CiAgY29uc3QgdGltZV9ub3cgPSBuZXcgRGF0ZSgpOwogIGNvbnN0IG1pbGxpc2Vjb25kcyA9IHRpbWVfbm93LmdldFRpbWUoKTsKICBjb25zdCBzZWNvbmRzID0gbWlsbGlzZWNvbmRzIC8gMWUzOwogIGNvbnN0IGZvdXJ0ZWVuX2RheXMgPSAxMjA5NjAwOwogIGNvbnN0IGVhcmxpZXN0X3N0YXJ0ID0gc2Vjb25kcyAtIGZvdXJ0ZWVuX2RheXM7CiAgY29uc3QgZmlsdGVyX2RhdGEgPSBbXTsKICBmb3IgKGNvbnN0IGVudHJ5IG9mIGRhdGEpIHsKICAgIGlmIChlbnRyeS5jcmVhdGVkIDwgZWFybGllc3Rfc3RhcnQpIHsKICAgICAgY29udGludWU7CiAgICB9CiAgICBmaWx0ZXJfZGF0YS5wdXNoKGVudHJ5KTsKICB9CiAgcmV0dXJuIGZpbHRlcl9kYXRhOwp9Cm1haW4oKTsK&quot;

[[artifacts]]
artifact_name = &quot;files&quot; # Name of artifact
filter = true
[artifacts.files]
start_path = &quot;/&quot; # Start of file listing
depth = 100 # How many sub directories to descend
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="scripts-1"><a class="header" href="#scripts-1">Scripts</a></h1>
<p>A Windows collection script that does tha following:</p>
<ul>
<li>Parses and filters user Registry Run\RunOnce keys that contain the values:
<code>[&quot;cmd.exe&quot;, &quot;powershell&quot;, &quot;temp&quot;, &quot;appdata&quot;, &quot;script&quot;]</code></li>
<li>Parses and filters the System Event Log for service installs that contain the
values: <code>[&quot;.bat&quot;, &quot;powershell&quot;, &quot;cmd.exe&quot;, &quot;COMSPEC&quot;]</code></li>
<li>Parses and filters BITS jobs looking for uncommon BITS jobs</li>
</ul>
<pre><code class="language-toml">system = &quot;windows&quot;

[output]
name = &quot;win_filter&quot;
directory = &quot;./tmp&quot;
format = &quot;json&quot;
compress = false
endpoint_id = &quot;abdc&quot;
collection_id = 1
output = &quot;local&quot;
filter_name = &quot;regs_bits&quot;
# This script will filter for sus Run\RunOnce Reg keys and non-builtin BITS jobs
filter_script = &quot;Ly8gaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL3B1ZmZ5Y2lkL2FydGVtaXMtYXBpL21hc3Rlci9zcmMvd2luZG93cy9ldmVudGxvZ3MudHMKZnVuY3Rpb24gZ2V0RXZlbnRsb2dzKHBhdGgpIHsKICBjb25zdCByZXN1bHRzID0gRGVuby5jb3JlLm9wcy5nZXRfZXZlbnRsb2dzKHBhdGgpOwogIGNvbnN0IGRhdGEgPSBKU09OLnBhcnNlKHJlc3VsdHMpOwogIHJldHVybiBkYXRhOwp9CgovLyBodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vcHVmZnljaWQvYXJ0ZW1pcy1hcGkvbWFzdGVyL3NyYy9lbnZpcm9ubWVudC9lbnYudHMKZnVuY3Rpb24gZ2V0RW52VmFsdWUoa2V5KSB7CiAgY29uc3QgZGF0YSA9IGVudi5lbnZpcm9ubWVudFZhbHVlKGtleSk7CiAgcmV0dXJuIGRhdGE7Cn0KCi8vIG1haW4udHMKZnVuY3Rpb24gZ3JhYkV2ZW50TG9ncygpIHsKICBjb25zdCBkcml2ZSA9IGdldEVudlZhbHVlKCJTeXN0ZW1Ecml2ZSIpOwogIGlmIChkcml2ZSA9PT0gIiIpIHsKICAgIHJldHVybiBbXTsKICB9CiAgY29uc3QgZGF0YSA9IGdldEV2ZW50bG9ncygKICAgIGAke2RyaXZlfVxcV2luZG93c1xcU3lzdGVtMzJcXHdpbmV2dFxcTG9nc1xcU3lzdGVtLmV2dHhgCiAgKTsKICBjb25zdCBzZXJ2aWNlX2luc3RhbGxzID0gW107CiAgY29uc3Qgc3VzX3NlcnZpY2VzID0gWyIuYmF0IiwgInBvd2Vyc2hlbGwiLCAiY21kLmV4ZSIsICJDT01TUEVDIl07CiAgZm9yIChjb25zdCByZWNvcmQgb2YgZGF0YSkgewogICAgaWYgKHJlY29yZC5kYXRhWyJFdmVudCJdWyJTeXN0ZW0iXVsiRXZlbnRJRCJdICE9IDcwNDUgJiYgcmVjb3JkLmRhdGFbIkV2ZW50Il1bIlN5c3RlbSJdWyJFdmVudElEIl1bIiN0ZXh0Il0gIT0gNzA0NSkgewogICAgICBjb250aW51ZTsKICAgIH0KICAgIGlmIChyZWNvcmQuZGF0YVsiRXZlbnQiXVsiRXZlbnREYXRhIl1bIlNlcnZpY2VOYW1lIl0ubGVuZ3RoID09PSAxNiB8fCBzdXNfc2VydmljZXMuc29tZSgKICAgICAgKHZhbHVlKSA9PiByZWNvcmQuZGF0YVsiRXZlbnQiXVsiRXZlbnREYXRhIl1bIkltYWdlUGF0aCJdLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXModmFsdWUpCiAgICApKSB7CiAgICAgIHNlcnZpY2VfaW5zdGFsbHMucHVzaChyZWNvcmQpOwogICAgfQogIH0KICByZXR1cm4gc2VydmljZV9pbnN0YWxsczsKfQpmdW5jdGlvbiBmaWx0ZXJSZWdpc3RyeShkYXRhKSB7CiAgY29uc3QgcmVncyA9IEpTT04ucGFyc2UoZGF0YSk7CiAgY29uc3Qgc3VzX3J1bl9rZXlzID0gWyJjbWQuZXhlIiwgInBvd2Vyc2hlbGwiLCAidGVtcCIsICJhcHBkYXRhIiwgInNjcmlwdCJdOwogIGNvbnN0IHN1c19oaXQgPSB7CiAgICByZWdpc3RyeV9maWxlOiByZWdzLnJlZ2lzdHJ5X2ZpbGUsCiAgICByZWdpc3RyeV9wYXRoOiByZWdzLnJlZ2lzdHJ5X3BhdGgsCiAgICByZWdpc3RyeV9lbnRyaWVzOiBbXQogIH07CiAgZm9yIChjb25zdCByZWNvcmQgb2YgcmVncy5yZWdpc3RyeV9lbnRyaWVzKSB7CiAgICBpZiAocmVjb3JkLm5hbWUgPT09ICJSdW4iIHx8IHJlY29yZC5uYW1lID09PSAiUnVuT25jZSIpIHsKICAgICAgY29uc3QgcmVnX2hpdCA9IHsKICAgICAgICBrZXk6IHJlY29yZC5rZXksCiAgICAgICAgbmFtZTogcmVjb3JkLm5hbWUsCiAgICAgICAgcGF0aDogcmVjb3JkLnBhdGgsCiAgICAgICAgdmFsdWVzOiBbXSwKICAgICAgICBsYXN0X21vZGlmaWVkOiByZWNvcmQubGFzdF9tb2RpZmllZCwKICAgICAgICBkZXB0aDogcmVjb3JkLmRlcHRoCiAgICAgIH07CiAgICAgIGZvciAoY29uc3QgdmFsdWUgb2YgcmVjb3JkLnZhbHVlcykgewogICAgICAgIGlmIChzdXNfcnVuX2tleXMuc29tZSgKICAgICAgICAgIChyZWdfdmFsdWUpID0+IHZhbHVlLmRhdGEudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhyZWdfdmFsdWUpCiAgICAgICAgKSkgewogICAgICAgICAgcmVnX2hpdC52YWx1ZXMucHVzaCh2YWx1ZSk7CiAgICAgICAgfQogICAgICB9CiAgICAgIGlmIChyZWdfaGl0LnZhbHVlcy5sZW5ndGggPT09IDApIHsKICAgICAgICBjb250aW51ZTsKICAgICAgfQogICAgICBzdXNfaGl0LnJlZ2lzdHJ5X2VudHJpZXMucHVzaChyZWdfaGl0KTsKICAgIH0KICB9CiAgcmV0dXJuIHN1c19oaXQ7Cn0KZnVuY3Rpb24gZmlsdGVyQml0cyhkYXRhKSB7CiAgY29uc3QgYml0c19kYXRhID0gSlNPTi5wYXJzZShkYXRhKTsKICBjb25zdCBzdXNfYml0cyA9IHsKICAgIGJpdHM6IFtdLAogICAgY2FydmVkX2ZpbGVzOiBbXSwKICAgIGNhcnZlZF9qb2JzOiBbXQogIH07CiAgY29uc3Qgc3RhbmRhcmRfYml0cyA9IFsKICAgICJtb3ppbGxhIiwKICAgICJvdXRsb29rIiwKICAgICJlZGdlIiwKICAgICJvbmVkcml2ZSIsCiAgICAiZ29vZ2xlIiwKICAgICJzcGVlY2giCiAgXTsKICBmb3IgKGNvbnN0IGJpdCBvZiBiaXRzX2RhdGEuYml0cykgewogICAgaWYgKCFzdGFuZGFyZF9iaXRzLnNvbWUoCiAgICAgICh2YWx1ZSkgPT4gYml0LmZ1bGxfcGF0aC50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKHZhbHVlKQogICAgKSAmJiAhc3RhbmRhcmRfYml0cy5zb21lKCh2YWx1ZSkgPT4gYml0LnVybC50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKHZhbHVlKSkpIHsKICAgICAgc3VzX2JpdHMuYml0cy5wdXNoKGJpdCk7CiAgICB9CiAgfQogIGZvciAoY29uc3QgYml0IG9mIGJpdHNfZGF0YS5jYXJ2ZWRfZmlsZXMpIHsKICAgIGlmICghc3RhbmRhcmRfYml0cy5zb21lKAogICAgICAodmFsdWUpID0+IGJpdC5mdWxsX3BhdGgudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyh2YWx1ZSkKICAgICkgJiYgIXN0YW5kYXJkX2JpdHMuc29tZSgodmFsdWUpID0+IGJpdC51cmwudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyh2YWx1ZSkpKSB7CiAgICAgIHN1c19iaXRzLmNhcnZlZF9maWxlcy5wdXNoKGJpdCk7CiAgICB9CiAgfQogIGZvciAoY29uc3QgYml0IG9mIGJpdHNfZGF0YS5jYXJ2ZWRfam9icykgewogICAgaWYgKCFzdGFuZGFyZF9iaXRzLnNvbWUoCiAgICAgICh2YWx1ZSkgPT4gYml0LnRhcmdldF9wYXRoLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXModmFsdWUpCiAgICApKSB7CiAgICAgIHN1c19iaXRzLmNhcnZlZF9qb2JzLnB1c2goYml0KTsKICAgIH0KICB9CiAgcmV0dXJuIHN1c19iaXRzOwp9CmZ1bmN0aW9uIG1haW4oKSB7CiAgY29uc3QgYXJncyA9IFNUQVRJQ19BUkdTOwogIGlmIChhcmdzLmxlbmd0aCA8IDIpIHsKICAgIHJldHVybiBncmFiRXZlbnRMb2dzKCk7CiAgfQogIGlmIChhcmdzWzFdID09PSAicmVnaXN0cnkiKSB7CiAgICByZXR1cm4gZmlsdGVyUmVnaXN0cnkoYXJnc1swXSk7CiAgfQogIGlmIChhcmdzWzFdID09PSAiYml0cyIpIHsKICAgIHJldHVybiBmaWx0ZXJCaXRzKGFyZ3NbMF0pOwogIH0KICByZXR1cm4gSlNPTi5wYXJzZShhcmdzWzBdKTsKfQptYWluKCk7Cg==&quot;

[[artifacts]]
artifact_name = &quot;bits&quot;
filter = true
[artifacts.bits]
carve = true

[[artifacts]]
artifact_name = &quot;registry&quot;
filter = true
[artifacts.registry]
user_hives = true
system_hives = false

[[artifacts]]
artifact_name = &quot;script&quot;
[artifacts.script]
name = &quot;sus_7045_eids&quot;
# The script below is the same as the filter script. Its coded in a manner that will work as a filter and normal script
script = &quot;Ly8gaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL3B1ZmZ5Y2lkL2FydGVtaXMtYXBpL21hc3Rlci9zcmMvd2luZG93cy9ldmVudGxvZ3MudHMKZnVuY3Rpb24gZ2V0RXZlbnRsb2dzKHBhdGgpIHsKICBjb25zdCByZXN1bHRzID0gRGVuby5jb3JlLm9wcy5nZXRfZXZlbnRsb2dzKHBhdGgpOwogIGNvbnN0IGRhdGEgPSBKU09OLnBhcnNlKHJlc3VsdHMpOwogIHJldHVybiBkYXRhOwp9CgovLyBodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vcHVmZnljaWQvYXJ0ZW1pcy1hcGkvbWFzdGVyL3NyYy9lbnZpcm9ubWVudC9lbnYudHMKZnVuY3Rpb24gZ2V0RW52VmFsdWUoa2V5KSB7CiAgY29uc3QgZGF0YSA9IGVudi5lbnZpcm9ubWVudFZhbHVlKGtleSk7CiAgcmV0dXJuIGRhdGE7Cn0KCi8vIG1haW4udHMKZnVuY3Rpb24gZ3JhYkV2ZW50TG9ncygpIHsKICBjb25zdCBkcml2ZSA9IGdldEVudlZhbHVlKCJTeXN0ZW1Ecml2ZSIpOwogIGlmIChkcml2ZSA9PT0gIiIpIHsKICAgIHJldHVybiBbXTsKICB9CiAgY29uc3QgZGF0YSA9IGdldEV2ZW50bG9ncygKICAgIGAke2RyaXZlfVxcV2luZG93c1xcU3lzdGVtMzJcXHdpbmV2dFxcTG9nc1xcU3lzdGVtLmV2dHhgCiAgKTsKICBjb25zdCBzZXJ2aWNlX2luc3RhbGxzID0gW107CiAgY29uc3Qgc3VzX3NlcnZpY2VzID0gWyIuYmF0IiwgInBvd2Vyc2hlbGwiLCAiY21kLmV4ZSIsICJDT01TUEVDIl07CiAgZm9yIChjb25zdCByZWNvcmQgb2YgZGF0YSkgewogICAgaWYgKHJlY29yZC5kYXRhWyJFdmVudCJdWyJTeXN0ZW0iXVsiRXZlbnRJRCJdICE9IDcwNDUgJiYgcmVjb3JkLmRhdGFbIkV2ZW50Il1bIlN5c3RlbSJdWyJFdmVudElEIl1bIiN0ZXh0Il0gIT0gNzA0NSkgewogICAgICBjb250aW51ZTsKICAgIH0KICAgIGlmIChyZWNvcmQuZGF0YVsiRXZlbnQiXVsiRXZlbnREYXRhIl1bIlNlcnZpY2VOYW1lIl0ubGVuZ3RoID09PSAxNiB8fCBzdXNfc2VydmljZXMuc29tZSgKICAgICAgKHZhbHVlKSA9PiByZWNvcmQuZGF0YVsiRXZlbnQiXVsiRXZlbnREYXRhIl1bIkltYWdlUGF0aCJdLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXModmFsdWUpCiAgICApKSB7CiAgICAgIHNlcnZpY2VfaW5zdGFsbHMucHVzaChyZWNvcmQpOwogICAgfQogIH0KICByZXR1cm4gc2VydmljZV9pbnN0YWxsczsKfQpmdW5jdGlvbiBmaWx0ZXJSZWdpc3RyeShkYXRhKSB7CiAgY29uc3QgcmVncyA9IEpTT04ucGFyc2UoZGF0YSk7CiAgY29uc3Qgc3VzX3J1bl9rZXlzID0gWyJjbWQuZXhlIiwgInBvd2Vyc2hlbGwiLCAidGVtcCIsICJhcHBkYXRhIiwgInNjcmlwdCJdOwogIGNvbnN0IHN1c19oaXQgPSB7CiAgICByZWdpc3RyeV9maWxlOiByZWdzLnJlZ2lzdHJ5X2ZpbGUsCiAgICByZWdpc3RyeV9wYXRoOiByZWdzLnJlZ2lzdHJ5X3BhdGgsCiAgICByZWdpc3RyeV9lbnRyaWVzOiBbXQogIH07CiAgZm9yIChjb25zdCByZWNvcmQgb2YgcmVncy5yZWdpc3RyeV9lbnRyaWVzKSB7CiAgICBpZiAocmVjb3JkLm5hbWUgPT09ICJSdW4iIHx8IHJlY29yZC5uYW1lID09PSAiUnVuT25jZSIpIHsKICAgICAgY29uc3QgcmVnX2hpdCA9IHsKICAgICAgICBrZXk6IHJlY29yZC5rZXksCiAgICAgICAgbmFtZTogcmVjb3JkLm5hbWUsCiAgICAgICAgcGF0aDogcmVjb3JkLnBhdGgsCiAgICAgICAgdmFsdWVzOiBbXSwKICAgICAgICBsYXN0X21vZGlmaWVkOiByZWNvcmQubGFzdF9tb2RpZmllZCwKICAgICAgICBkZXB0aDogcmVjb3JkLmRlcHRoCiAgICAgIH07CiAgICAgIGZvciAoY29uc3QgdmFsdWUgb2YgcmVjb3JkLnZhbHVlcykgewogICAgICAgIGlmIChzdXNfcnVuX2tleXMuc29tZSgKICAgICAgICAgIChyZWdfdmFsdWUpID0+IHZhbHVlLmRhdGEudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhyZWdfdmFsdWUpCiAgICAgICAgKSkgewogICAgICAgICAgcmVnX2hpdC52YWx1ZXMucHVzaCh2YWx1ZSk7CiAgICAgICAgfQogICAgICB9CiAgICAgIGlmIChyZWdfaGl0LnZhbHVlcy5sZW5ndGggPT09IDApIHsKICAgICAgICBjb250aW51ZTsKICAgICAgfQogICAgICBzdXNfaGl0LnJlZ2lzdHJ5X2VudHJpZXMucHVzaChyZWdfaGl0KTsKICAgIH0KICB9CiAgcmV0dXJuIHN1c19oaXQ7Cn0KZnVuY3Rpb24gZmlsdGVyQml0cyhkYXRhKSB7CiAgY29uc3QgYml0c19kYXRhID0gSlNPTi5wYXJzZShkYXRhKTsKICBjb25zdCBzdXNfYml0cyA9IHsKICAgIGJpdHM6IFtdLAogICAgY2FydmVkX2ZpbGVzOiBbXSwKICAgIGNhcnZlZF9qb2JzOiBbXQogIH07CiAgY29uc3Qgc3RhbmRhcmRfYml0cyA9IFsKICAgICJtb3ppbGxhIiwKICAgICJvdXRsb29rIiwKICAgICJlZGdlIiwKICAgICJvbmVkcml2ZSIsCiAgICAiZ29vZ2xlIiwKICAgICJzcGVlY2giCiAgXTsKICBmb3IgKGNvbnN0IGJpdCBvZiBiaXRzX2RhdGEuYml0cykgewogICAgaWYgKCFzdGFuZGFyZF9iaXRzLnNvbWUoCiAgICAgICh2YWx1ZSkgPT4gYml0LmZ1bGxfcGF0aC50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKHZhbHVlKQogICAgKSAmJiAhc3RhbmRhcmRfYml0cy5zb21lKCh2YWx1ZSkgPT4gYml0LnVybC50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKHZhbHVlKSkpIHsKICAgICAgc3VzX2JpdHMuYml0cy5wdXNoKGJpdCk7CiAgICB9CiAgfQogIGZvciAoY29uc3QgYml0IG9mIGJpdHNfZGF0YS5jYXJ2ZWRfZmlsZXMpIHsKICAgIGlmICghc3RhbmRhcmRfYml0cy5zb21lKAogICAgICAodmFsdWUpID0+IGJpdC5mdWxsX3BhdGgudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyh2YWx1ZSkKICAgICkgJiYgIXN0YW5kYXJkX2JpdHMuc29tZSgodmFsdWUpID0+IGJpdC51cmwudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyh2YWx1ZSkpKSB7CiAgICAgIHN1c19iaXRzLmNhcnZlZF9maWxlcy5wdXNoKGJpdCk7CiAgICB9CiAgfQogIGZvciAoY29uc3QgYml0IG9mIGJpdHNfZGF0YS5jYXJ2ZWRfam9icykgewogICAgaWYgKCFzdGFuZGFyZF9iaXRzLnNvbWUoCiAgICAgICh2YWx1ZSkgPT4gYml0LnRhcmdldF9wYXRoLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXModmFsdWUpCiAgICApKSB7CiAgICAgIHN1c19iaXRzLmNhcnZlZF9qb2JzLnB1c2goYml0KTsKICAgIH0KICB9CiAgcmV0dXJuIHN1c19iaXRzOwp9CmZ1bmN0aW9uIG1haW4oKSB7CiAgY29uc3QgYXJncyA9IFNUQVRJQ19BUkdTOwogIGlmIChhcmdzLmxlbmd0aCA8IDIpIHsKICAgIHJldHVybiBncmFiRXZlbnRMb2dzKCk7CiAgfQogIGlmIChhcmdzWzFdID09PSAicmVnaXN0cnkiKSB7CiAgICByZXR1cm4gZmlsdGVyUmVnaXN0cnkoYXJnc1swXSk7CiAgfQogIGlmIChhcmdzWzFdID09PSAiYml0cyIpIHsKICAgIHJldHVybiBmaWx0ZXJCaXRzKGFyZ3NbMF0pOwogIH0KICByZXR1cm4gSlNPTi5wYXJzZShhcmdzWzBdKTsKfQptYWluKCk7Cg==&quot;
</code></pre>
<p>A macOS collection script that does the following:</p>
<ul>
<li>Parses and filters the <code>Persist</code> UnifiedLog files for log messags that contain
<code>sudo</code> or <code>osascript</code></li>
<li>Parses and filters Fseventsd entries for evidence of <code>.dmg</code> files or files in
<code>/tmp</code></li>
<li>Parses and filters an App filelisting to list Applications and their
associated <code>Info.plist</code> content</li>
<li>Parses <code>LoginItems</code> and try to parse the associated persistence binary (if it
exists and is a <code>macho</code> executable)</li>
</ul>
<p>The script is coded in a manner so that it can run as a filter or a normal
script.</p>
<pre><code class="language-toml">system = &quot;macos&quot;

[output]
name = &quot;mac_filter&quot;
directory = &quot;./tmp&quot;
format = &quot;json&quot;
compress = false
endpoint_id = &quot;abdc&quot;
collection_id = 1
output = &quot;local&quot;
filter_name = &quot;unifiedlogs_fsevents_filter&quot;
# This script will filter for unifiedlogs, fseventsd, and files
filter_script = &quot;Ly8gaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL3B1ZmZ5Y2lkL2FydGVtaXMtYXBpL21hc3Rlci9zcmMvbWFjb3MvbG9naW5pdGVtcy50cwpmdW5jdGlvbiBnZXRMb2dpbml0ZW1zKCkgewogIGNvbnN0IGRhdGEgPSBEZW5vLmNvcmUub3BzLmdldF9sb2dpbml0ZW1zKCk7CiAgY29uc3QgaXRlbXMgPSBKU09OLnBhcnNlKGRhdGEpOwogIHJldHVybiBpdGVtczsKfQoKLy8gaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL3B1ZmZ5Y2lkL2FydGVtaXMtYXBpL21hc3Rlci9zcmMvbWFjb3MvbWFjaG8udHMKZnVuY3Rpb24gZ2V0TWFjaG8ocGF0aCkgewogIGNvbnN0IGRhdGEgPSBEZW5vLmNvcmUub3BzLmdldF9tYWNobyhwYXRoKTsKICBpZiAoZGF0YSA9PT0gIiIpIHsKICAgIHJldHVybiBudWxsOwogIH0KICBjb25zdCBtYWNobyA9IEpTT04ucGFyc2UoZGF0YSk7CiAgcmV0dXJuIG1hY2hvOwp9CgovLyBodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vcHVmZnljaWQvYXJ0ZW1pcy1hcGkvbWFzdGVyL3NyYy9tYWNvcy9wbGlzdC50cwpmdW5jdGlvbiBnZXRQbGlzdChwYXRoKSB7CiAgY29uc3QgZGF0YSA9IERlbm8uY29yZS5vcHMuZ2V0X3BsaXN0KHBhdGgpOwogIGlmIChkYXRhID09PSAiIikgewogICAgcmV0dXJuIG51bGw7CiAgfQogIGNvbnN0IHBsaXN0X2RhdGEgPSBKU09OLnBhcnNlKGRhdGEpOwogIHJldHVybiBwbGlzdF9kYXRhOwp9CgovLyBtYWluLnRzCmZ1bmN0aW9uIGdyYWJMb2dpbkl0ZW1zKCkgewogIGNvbnN0IGRhdGEgPSBnZXRMb2dpbml0ZW1zKCk7CiAgY29uc3QgaXRlbXNNYWNobyA9IFtdOwogIGZvciAoY29uc3QgZW50cnkgb2YgZGF0YSkgewogICAgdHJ5IHsKICAgICAgY29uc3QgaXRlbSA9IHsKICAgICAgICBpdGVtczogZW50cnksCiAgICAgICAgbWFjaG86IGdldE1hY2hvKGVudHJ5LnBhdGguam9pbigiLyIpKQogICAgICB9OwogICAgICBpdGVtc01hY2hvLnB1c2goaXRlbSk7CiAgICB9IGNhdGNoIChfZSkgewogICAgICBjb25zdCBpdGVtID0gewogICAgICAgIGl0ZW1zOiBlbnRyeSwKICAgICAgICBtYWNobzogbnVsbAogICAgICB9OwogICAgICBpdGVtc01hY2hvLnB1c2goaXRlbSk7CiAgICB9CiAgfQogIHJldHVybiBpdGVtc01hY2hvOwp9CmZ1bmN0aW9uIGZpbHRlckxvZ3MoZGF0YSkgewogIGNvbnN0IGxvZ3MgPSBbXTsKICBjb25zdCBsb2dEYXRhID0gSlNPTi5wYXJzZShkYXRhKTsKICBmb3IgKGxldCBlbnRyeSA9IDA7IGVudHJ5IDwgbG9nRGF0YS5sZW5ndGg7IGVudHJ5KyspIHsKICAgIGlmICghbG9nRGF0YVtlbnRyeV0ubWVzc2FnZS5pbmNsdWRlcygic3VkbyIpICYmICFsb2dEYXRhW2VudHJ5XS5tZXNzYWdlLmluY2x1ZGVzKCJvc2FzY3JpcHQiKSkgewogICAgICBjb250aW51ZTsKICAgIH0KICAgIGxvZ3MucHVzaChsb2dEYXRhW2VudHJ5XSk7CiAgfQogIHJldHVybiBsb2dzOwp9CmZ1bmN0aW9uIGZpbHRlckV2ZW50cyhkYXRhKSB7CiAgY29uc3QgZXZlbnRzID0gW107CiAgY29uc3QgZXZlbnRzRGF0YSA9IEpTT04ucGFyc2UoZGF0YSk7CiAgZm9yIChjb25zdCBlbnRyeSBvZiBldmVudHNEYXRhKSB7CiAgICBpZiAoIWVudHJ5LnBhdGguaW5jbHVkZXMoIi5kbWciKSAmJiAhZW50cnkucGF0aC5zdGFydHNXaXRoKCIvdG1wIikpIHsKICAgICAgY29udGludWU7CiAgICB9CiAgICBldmVudHMucHVzaChlbnRyeSk7CiAgfQogIHJldHVybiBldmVudHM7Cn0KZnVuY3Rpb24gZmlsdGVyQXBwcyhkYXRhKSB7CiAgY29uc3QgYXBwcyA9IFtdOwogIGNvbnN0IGZpbGVzRGF0YSA9IEpTT04ucGFyc2UoZGF0YSk7CiAgZm9yIChsZXQgZW50cnkgPSAwOyBlbnRyeSA8IGZpbGVzRGF0YS5sZW5ndGg7IGVudHJ5KyspIHsKICAgIGlmIChmaWxlc0RhdGFbZW50cnldLmZ1bGxfcGF0aC5pbmNsdWRlcygiLmFwcCIpICYmIGZpbGVzRGF0YVtlbnRyeV0uZmlsZW5hbWUgIT0gIkluZm8ucGxpc3QiKSB7CiAgICAgIGNvbnRpbnVlOwogICAgfQogICAgY29uc3QgYXBwID0gewogICAgICBhcHBfcGF0aDogZmlsZXNEYXRhW2VudHJ5XS5kaXJlY3RvcnksCiAgICAgIGluZm9fcGxpc3Q6IGZpbGVzRGF0YVtlbnRyeV0uZnVsbF9wYXRoLAogICAgICBwbGlzdDogZ2V0UGxpc3QoZmlsZXNEYXRhW2VudHJ5XS5mdWxsX3BhdGgpCiAgICB9OwogICAgYXBwcy5wdXNoKGFwcCk7CiAgfQogIHJldHVybiBhcHBzOwp9CmZ1bmN0aW9uIG1haW4oKSB7CiAgY29uc3QgYXJncyA9IFNUQVRJQ19BUkdTOwogIGlmIChhcmdzLmxlbmd0aCA8IDIpIHsKICAgIHJldHVybiBncmFiTG9naW5JdGVtcygpOwogIH0KICBpZiAoYXJnc1sxXSA9PT0gInVuaWZpZWRsb2dzIikgewogICAgcmV0dXJuIGZpbHRlckxvZ3MoYXJnc1swXSk7CiAgfQogIGlmIChhcmdzWzFdID09PSAiZnNldmVudHNkIikgewogICAgcmV0dXJuIGZpbHRlckV2ZW50cyhhcmdzWzBdKTsKICB9CiAgaWYgKGFyZ3NbMV0gPT09ICJmaWxlcyIpIHsKICAgIHJldHVybiBmaWx0ZXJBcHBzKGFyZ3NbMF0pOwogIH0KICByZXR1cm4gSlNPTi5wYXJzZShhcmdzWzBdKTsKfQptYWluKCk7Cg==&quot;


[[artifacts]]
artifact_name = &quot;unifiedlogs&quot;
filter = true
[artifacts.unifiedlogs]
sources = [&quot;Persist&quot;]

[[artifacts]]
artifact_name = &quot;fseventsd&quot;
filter = true

[[artifacts]]
artifact_name = &quot;files&quot;
filter = true
[artifacts.files]
start_path = &quot;/System/Volumes/Data/Applications&quot;
depth = 15

[[artifacts]]
artifact_name = &quot;script&quot;
[artifacts.script]
name = &quot;loginitems_macho&quot; # No filtering applied
# The script below is the same as the filter script. Its coded in a manner that will work as a filter and normal script
script = &quot;Ly8gaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL3B1ZmZ5Y2lkL2FydGVtaXMtYXBpL21hc3Rlci9zcmMvbWFjb3MvbG9naW5pdGVtcy50cwpmdW5jdGlvbiBnZXRMb2dpbml0ZW1zKCkgewogIGNvbnN0IGRhdGEgPSBEZW5vLmNvcmUub3BzLmdldF9sb2dpbml0ZW1zKCk7CiAgY29uc3QgaXRlbXMgPSBKU09OLnBhcnNlKGRhdGEpOwogIHJldHVybiBpdGVtczsKfQoKLy8gaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL3B1ZmZ5Y2lkL2FydGVtaXMtYXBpL21hc3Rlci9zcmMvbWFjb3MvbWFjaG8udHMKZnVuY3Rpb24gZ2V0TWFjaG8ocGF0aCkgewogIGNvbnN0IGRhdGEgPSBEZW5vLmNvcmUub3BzLmdldF9tYWNobyhwYXRoKTsKICBpZiAoZGF0YSA9PT0gIiIpIHsKICAgIHJldHVybiBudWxsOwogIH0KICBjb25zdCBtYWNobyA9IEpTT04ucGFyc2UoZGF0YSk7CiAgcmV0dXJuIG1hY2hvOwp9CgovLyBodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vcHVmZnljaWQvYXJ0ZW1pcy1hcGkvbWFzdGVyL3NyYy9tYWNvcy9wbGlzdC50cwpmdW5jdGlvbiBnZXRQbGlzdChwYXRoKSB7CiAgY29uc3QgZGF0YSA9IERlbm8uY29yZS5vcHMuZ2V0X3BsaXN0KHBhdGgpOwogIGlmIChkYXRhID09PSAiIikgewogICAgcmV0dXJuIG51bGw7CiAgfQogIGNvbnN0IHBsaXN0X2RhdGEgPSBKU09OLnBhcnNlKGRhdGEpOwogIHJldHVybiBwbGlzdF9kYXRhOwp9CgovLyBtYWluLnRzCmZ1bmN0aW9uIGdyYWJMb2dpbkl0ZW1zKCkgewogIGNvbnN0IGRhdGEgPSBnZXRMb2dpbml0ZW1zKCk7CiAgY29uc3QgaXRlbXNNYWNobyA9IFtdOwogIGZvciAoY29uc3QgZW50cnkgb2YgZGF0YSkgewogICAgdHJ5IHsKICAgICAgY29uc3QgaXRlbSA9IHsKICAgICAgICBpdGVtczogZW50cnksCiAgICAgICAgbWFjaG86IGdldE1hY2hvKGVudHJ5LnBhdGguam9pbigiLyIpKQogICAgICB9OwogICAgICBpdGVtc01hY2hvLnB1c2goaXRlbSk7CiAgICB9IGNhdGNoIChfZSkgewogICAgICBjb25zdCBpdGVtID0gewogICAgICAgIGl0ZW1zOiBlbnRyeSwKICAgICAgICBtYWNobzogbnVsbAogICAgICB9OwogICAgICBpdGVtc01hY2hvLnB1c2goaXRlbSk7CiAgICB9CiAgfQogIHJldHVybiBpdGVtc01hY2hvOwp9CmZ1bmN0aW9uIGZpbHRlckxvZ3MoZGF0YSkgewogIGNvbnN0IGxvZ3MgPSBbXTsKICBjb25zdCBsb2dEYXRhID0gSlNPTi5wYXJzZShkYXRhKTsKICBmb3IgKGxldCBlbnRyeSA9IDA7IGVudHJ5IDwgbG9nRGF0YS5sZW5ndGg7IGVudHJ5KyspIHsKICAgIGlmICghbG9nRGF0YVtlbnRyeV0ubWVzc2FnZS5pbmNsdWRlcygic3VkbyIpICYmICFsb2dEYXRhW2VudHJ5XS5tZXNzYWdlLmluY2x1ZGVzKCJvc2FzY3JpcHQiKSkgewogICAgICBjb250aW51ZTsKICAgIH0KICAgIGxvZ3MucHVzaChsb2dEYXRhW2VudHJ5XSk7CiAgfQogIHJldHVybiBsb2dzOwp9CmZ1bmN0aW9uIGZpbHRlckV2ZW50cyhkYXRhKSB7CiAgY29uc3QgZXZlbnRzID0gW107CiAgY29uc3QgZXZlbnRzRGF0YSA9IEpTT04ucGFyc2UoZGF0YSk7CiAgZm9yIChjb25zdCBlbnRyeSBvZiBldmVudHNEYXRhKSB7CiAgICBpZiAoIWVudHJ5LnBhdGguaW5jbHVkZXMoIi5kbWciKSAmJiAhZW50cnkucGF0aC5zdGFydHNXaXRoKCIvdG1wIikpIHsKICAgICAgY29udGludWU7CiAgICB9CiAgICBldmVudHMucHVzaChlbnRyeSk7CiAgfQogIHJldHVybiBldmVudHM7Cn0KZnVuY3Rpb24gZmlsdGVyQXBwcyhkYXRhKSB7CiAgY29uc3QgYXBwcyA9IFtdOwogIGNvbnN0IGZpbGVzRGF0YSA9IEpTT04ucGFyc2UoZGF0YSk7CiAgZm9yIChsZXQgZW50cnkgPSAwOyBlbnRyeSA8IGZpbGVzRGF0YS5sZW5ndGg7IGVudHJ5KyspIHsKICAgIGlmIChmaWxlc0RhdGFbZW50cnldLmZ1bGxfcGF0aC5pbmNsdWRlcygiLmFwcCIpICYmIGZpbGVzRGF0YVtlbnRyeV0uZmlsZW5hbWUgIT0gIkluZm8ucGxpc3QiKSB7CiAgICAgIGNvbnRpbnVlOwogICAgfQogICAgY29uc3QgYXBwID0gewogICAgICBhcHBfcGF0aDogZmlsZXNEYXRhW2VudHJ5XS5kaXJlY3RvcnksCiAgICAgIGluZm9fcGxpc3Q6IGZpbGVzRGF0YVtlbnRyeV0uZnVsbF9wYXRoLAogICAgICBwbGlzdDogZ2V0UGxpc3QoZmlsZXNEYXRhW2VudHJ5XS5mdWxsX3BhdGgpCiAgICB9OwogICAgYXBwcy5wdXNoKGFwcCk7CiAgfQogIHJldHVybiBhcHBzOwp9CmZ1bmN0aW9uIG1haW4oKSB7CiAgY29uc3QgYXJncyA9IFNUQVRJQ19BUkdTOwogIGlmIChhcmdzLmxlbmd0aCA8IDIpIHsKICAgIHJldHVybiBncmFiTG9naW5JdGVtcygpOwogIH0KICBpZiAoYXJnc1sxXSA9PT0gInVuaWZpZWRsb2dzIikgewogICAgcmV0dXJuIGZpbHRlckxvZ3MoYXJnc1swXSk7CiAgfQogIGlmIChhcmdzWzFdID09PSAiZnNldmVudHNkIikgewogICAgcmV0dXJuIGZpbHRlckV2ZW50cyhhcmdzWzBdKTsKICB9CiAgaWYgKGFyZ3NbMV0gPT09ICJmaWxlcyIpIHsKICAgIHJldHVybiBmaWx0ZXJBcHBzKGFyZ3NbMF0pOwogIH0KICByZXR1cm4gSlNPTi5wYXJzZShhcmdzWzBdKTsKfQptYWluKCk7Cg==&quot;
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="development-overview"><a class="header" href="#development-overview">Development Overview</a></h1>
<p>The <code>artemis</code> source code is about ~66k lines of Rust code across ~540 files as
of September 2023 (this includes tests), however its organized in a pretty
simple manner.</p>
<p>From the root of the <code>artemis</code> repo:</p>
<ul>
<li><code>/artemis-core</code> workspace containsthe library component of <code>artemis</code>. The bulk
of the code is located here</li>
<li><code>/cli</code> workspace contains the executable component <code>artemis</code>. This is very
small.</li>
<li><code>/server</code> workspace contains the experimental server component of <code>artemis</code>.
Its currently very bare bones</li>
</ul>
<p>From <code>/artemis-core</code> directory:</p>
<ul>
<li><code>/src</code> contains the source code of <code>artemis-core</code>.</li>
<li><code>/tests</code> contains test data and integration tests</li>
<li><code>/tmp</code> output directory for all tests (if you choose to run them)</li>
</ul>
<p>From the <code>artemis-core/src/</code> directory</p>
<ul>
<li><code>/artifacts</code> contains the code related to parsing forensic artifacts. It is
broken down by OS and application artifacts</li>
<li><code>/filesystem</code> contains code to help interact with the filesystem. It contains
helper functions that can be used when adding new artifacts/features. Ex:
reading/hashing files, getting file timestamps, listing files, etc</li>
<li><code>/output</code> contains code related to outputing parsed data</li>
<li><code>/runtime</code> contains code related to the embedded Deno runtime</li>
<li><code>/structs</code> contains code related to how TOML collection files are parsed. It
tells <code>artemis</code> how to interpret TOML collections.</li>
<li><code>/utils</code> contains code related to help parse artifacts and provide other
features to <code>artemis</code>. Ex: Decompress/compress data, get environment
variables, create a Regex expression, extract strings, convert timestamps, etc</li>
<li><code>core.rs</code> contains the entry point to the <code>artemis_core</code> library.</li>
</ul>
<h1 id="adding-new-artifacts"><a class="header" href="#adding-new-artifacts">Adding New Artifacts</a></h1>
<p>To keep the codebase organized the follow should be followed when adding a new
artifact.</p>
<ul>
<li>Artifacts have their own subfolder. Ex: <code>src/artifacts/os/windows/prefetch</code></li>
<li>The subfolder should have the following files at least:
<ul>
<li><code>parser.rs</code> - Contains the <code>pub(crate)</code> accessible functions for the
artifact</li>
<li><code>error.rs</code> - Artifact specific errors</li>
</ul>
</li>
</ul>
<h1 id="timestamps"><a class="header" href="#timestamps">Timestamps</a></h1>
<p>All timestamps <code>artemis</code> outputs are in UNIXEPOCH seconds. The only exceptions
are:</p>
<ul>
<li><code>UnifiedLogs</code> and <code>EventLogs</code> use UNIXEPOCH nanoseconds.</li>
<li><code>Journals</code> use UNIXEPOCH microseconds.</li>
</ul>
<p>If your new artifact has a timestamp, you will need to make sure the timestamp
is in UNIXEPOCH seconds. Though exceptions may be allowed if needed, these
exceptions will only be for the duration (ex: seconds vs nanoseconds).<br />
No other time formats such as Windows FILETIME, FATTIME, Chromium time, etc are
allowed.</p>
<h1 id="artifact-scope"><a class="header" href="#artifact-scope">Artifact Scope</a></h1>
<p>Currently all artifacts that <code>artemis</code> parses are statically coded in the binary
(they are written in Rust). While this ok, it prevents us from dyanamically
upating the parser if the artifact format changes (ex: new Windows release).</p>
<p>Currently the <a href="development/../scripting/deno.html">JS runtime</a> has minimal support for
creating parsers. If you are interested in adding a small parser to <code>artemis</code>,
it could be worth first trying to code it using the JS runtime.<br />
An example JS runtime parser can be found in the
<a href="https://github.com/puffyCid/artemis-api/blob/main/src/macos/alias.ts">artemis API</a>
repo.</p>
<p>However, if you want to implement a new parser for parsing common Windows
artifacts such as <code>Jumplists</code> then that is definitely something that could be
worth including as a static parser.</p>
<p>When in doubt or unsure open an issue!</p>
<h1 id="suggestions"><a class="header" href="#suggestions">Suggestions</a></h1>
<p>If you want add a new artifact but want to see how other artifacts are
implemented, some suggested ones to review are:</p>
<ul>
<li><code>UserAssist</code>: If you want to add a new Registry artifact. The <code>UserAssist</code>
artifact is less than 300 lines (not counting tests). And includes:
<ul>
<li>Parsing binary data</li>
<li>Converting timestamps</li>
<li>Collecting user Registy data</li>
</ul>
</li>
<li><code>FsEvents</code>: If you want to to parse a binary file. The <code>FsEvents</code> is less than
300 lines (not counting tests). And includes:
<ul>
<li>Parsing binary data</li>
<li>Decompressing data</li>
<li>Getting data flags
<br />
Fun fact: <code>FsEvents</code> was the first artifact created for <code>artemis</code>. Its the
oldest code in the project!</li>
</ul>
</li>
</ul>
<h2 id="suggested-helper-functions"><a class="header" href="#suggested-helper-functions">Suggested Helper Functions</a></h2>
<p>The <code>artemis</code> codebase contains a handful of artifacts (ex: <code>Registry</code>) that
expose helper functions that allow other artifacts to reuse parts of that
artifact to help get artifact specific data.</p>
<p>For example the Windows <code>Registry</code> artifact exposes a helper function that other
<code>Registry</code> based artifacts can leverage to help parse the <code>Registry</code>:</p>
<ul>
<li><code>pub(crate) fn get_registry_keys(start_path: &amp;str, regex: &amp;Regex, file_path: &amp;str)</code>
will read a <code>Registry</code> at provide <code>file_path</code> and filter to based on
<code>start_path</code> and <code>regex</code>. If <code>start_path</code> and <code>regex</code> are empty a full
<code>Registry</code> listing is returned. All Regex comparisons are done in lowercase.</li>
</ul>
<p>Some other examples listed below:</p>
<ul>
<li>
<p><code>/filesytem</code> contains code to help interact with the filesystem.</p>
<ul>
<li><code>pub(crate) fn list_files(path: &amp;str)</code> returns list of files</li>
<li><code>pub(crate) fn read_file(path: &amp;str)</code> reads a file</li>
<li><code>pub(crate) fn hash_file(hashes: &amp;Hashes, path: &amp;str)</code> hashes a file based
on select hashes (MD5, SHA1, SHA256)</li>
</ul>
</li>
<li>
<p><code>/filesystem/ntfs</code> contains code to help iteract with the raw NTFS filesystem.
It lets us bypass locked files. This is only available on Windows</p>
<ul>
<li><code>pub(crate) fn raw_read_file(path: &amp;str)</code> reads a file. Will bypass file
locks</li>
<li><code>pub(crate) fn read_attribute(path: &amp;str, attribute: &amp;str)</code> can read an
Alternative Data Stream (ADS)</li>
<li><code>pub(crate) fn get_user_registry_files(drive: &amp;char)</code> returns a Vector that
contains references to all user Registry files (NTUSER.DAT and
UsrClass.dat). It does <strong>not</strong> read the files, it just provides all the data
needed to start reading them.</li>
</ul>
</li>
<li>
<p><code>/src/artifacts/os/macos/plist/property_list.rs</code> contains code help parse
<code>plist</code> files.</p>
<ul>
<li><code>pub(crate) fn parse_plist_file(path: &amp;str)</code> will parse a <code>plist</code> file and
return it as a Serde Value</li>
<li><code>pub(crate) fn parse_plist_file_dict(path: &amp;str)</code> will parse a <code>plist</code> file
and return as Dictionary for further parsing by the caller</li>
</ul>
</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="prerequisites"><a class="header" href="#prerequisites">Prerequisites</a></h1>
<p>There a few required applications you will need in order to build and develop
<code>artemis</code>.</p>
<ol>
<li><code>artemis</code> is written in Rust. So you will need to download and install the
<a href="https://www.rust-lang.org/">Rust</a> programming language</li>
<li>Git</li>
<li><a href="https://rust-analyzer.github.io/">Rust analzyer</a></li>
<li>An IDE or text editor. <a href="https://code.visualstudio.com/">VSCode</a> or
<a href="https://vscodium.com/">VSCodium</a> are great choices.
<a href="https://www.jetbrains.com/idea/">IntelliJ</a> with the Rust plugin also works.</li>
</ol>
<p><code>artemis</code> has been developed on:</p>
<ul>
<li>macOS 12 (Monterey) and higher</li>
<li>Windows 10 and higher</li>
</ul>
<h1 id="building"><a class="header" href="#building">Building</a></h1>
<p>Once you have Rust and Git installed you can build <code>artemis</code>.</p>
<ol>
<li>Clone <code>artemis</code> repo at
<a href="https://github.com/puffycid/artemis">https://github.com/puffycid/artemis</a></li>
<li>Navigate to the source code</li>
<li>Run <code>cargo build</code>. By default cargo builds a <code>debug</code> version of the binary.
If you want to build the <code>release</code> version of the binary run
<code>cargo build --release</code></li>
</ol>
<pre><code class="language-sh"># Download artemis source code
git clone https://github.com/puffycid/artemis
cd artemis

# Build debug version
cargo build
# Build release version
cargo build --release
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="adding-features"><a class="header" href="#adding-features">Adding Features</a></h1>
<p>Before working on a new feature for <code>artemis</code> please make sure you have read the
<a href="https://github.com/puffycid/artemis/blob/main/CONTRIBUTING.md">Contributing</a>
doucment. Most important thing is to first create an issue! Highlevel overview
of adding a new feature:</p>
<ol>
<li>Create an issue. If you want to work on it, make sure to explictly volunteer!</li>
<li>Create a branch on your clone <code>artemis</code> repo</li>
<li>Work on said feature</li>
<li>Ensure tests are made for all functions</li>
<li>If you are adding a new artifact, add an integration test</li>
<li>Run <code>cargo clippy</code>.</li>
<li>Run <code>cargo fmt</code></li>
<li>Open a pull request!</li>
</ol>
<h2 id="other-useful-development-tools"><a class="header" href="#other-useful-development-tools">Other Useful Development Tools</a></h2>
<p>List of useful tools that may aid in development.</p>
<ul>
<li><a href="https://github.com/TimonPost/cargo-unused-features">Unused Features</a></li>
<li><a href="https://github.com/RustSec/rustsec/tree/main/cargo-audit">Audit</a></li>
<li><a href="https://github.com/rust-secure-code/cargo-geiger">Geiger</a></li>
<li><a href="https://github.com/boyter/scc">scc</a></li>
<li><a href="https://github.com/rust-lang/rust-clippy">clippy</a></li>
<li><a href="https://nexte.st/">nextest</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="testing"><a class="header" href="#testing">Testing</a></h1>
<p><code>artemis</code> has a single basic guideline for testing:</p>
<ul>
<li>All functions should ideally have a test</li>
</ul>
<p>For example, if you open a pull request to add a new feature and create three
(3) new functions. Your must have a test for each new function (three tests
total). Even if your functions are coded like:
<code>functionA calls functionB which then call functionC</code>. You must have tests for
each function and not just functionA.</p>
<p>To run tests</p>
<pre><code class="language-sh"># Its recommended to run in release mode for tests. This will speed up the tests
cargo test --release
</code></pre>
<p>If you are unfamilar with creating Rust tests. The Rust
<a href="https://doc.rust-lang.org/book/ch11-03-test-organization.html">book</a> and
<a href="https://doc.rust-lang.org/rust-by-example/testing/unit_testing.html">Rust by example</a>
have great learning resources.</p>
<h2 id="integration-tests"><a class="header" href="#integration-tests">Integration Tests</a></h2>
<p>If you are adding a new forensic aritfact to <code>artemis</code>, including an integration
test for the artifact can also be very useful. Writing an integration is a two
(2) step process:</p>
<ol>
<li>Create a TOML collection file. This should be TOML collection file that
anyone could download and run themselves</li>
<li>Create a <code>artifact_tester.rs</code> file</li>
</ol>
<p>An example <code>prefetch</code> integration test:</p>
<ol>
<li>TOML file created at
<code>&lt;path to repo&gt;/artemis-core/tests/test_data/windows/prefetch.toml</code></li>
</ol>
<pre><code class="language-toml">system = &quot;windows&quot;

[output]
name = &quot;prefetch_collection&quot;
directory = &quot;./tmp&quot;
format = &quot;json&quot;
compress = false
endpoint_id = &quot;6c51b123-1522-4572-9f2a-0bd5abd81b82&quot;
collection_id = 1
output = &quot;local&quot;

[[artifacts]]
artifact_name = &quot;prefetch&quot;
[artifacts.prefetch]
alt_drive = 'C'
</code></pre>
<ol start="2">
<li><code>prefetch_tester.rs</code> created at
<code>&lt;path to repo&gt;/artemis-core/tests/prefetch_tester.rs</code></li>
</ol>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>#[test]
#[cfg(target_os = &quot;windows&quot;)]
fn test_prefetch_parser() {
    use std::path::PathBuf;

    use artemis_core::core::parse_toml_file;
    let mut test_location = PathBuf::from(env!(&quot;CARGO_MANIFEST_DIR&quot;));
    test_location.push(&quot;tests/test_data/windows/prefetch.toml&quot;);

    let results = parse_toml_file(&amp;test_location.display().to_string()).unwrap();
    assert_eq!(results, ())
}
<span class="boring">}</span></code></pre></pre>
<p>Our <code>prefetch_tester.rs</code> file runs the <code>prefetch.toml</code> file through the whole
<code>artemis</code> program.</p>
<h2 id="test-data"><a class="header" href="#test-data">Test Data</a></h2>
<p>If you are adding a new forensic artifact to <code>artemis</code>, if you can include a
sample of the artifact that can be used for tests that would be very helpful.
Some things to keep in mind though:</p>
<ul>
<li>Size. If the artifact is large (10-20MB) then including the sample in the
<code>artemis</code> repo is unecessary.</li>
<li>Licensing. If you can provide the artifact from your own system that is ideal.
However, if you find the sample aritfact in another GitHub repo make sure that
repo's LICENSE is compatible with <code>artemis</code>.</li>
</ul>
<h3 id="hypothetical-scenario"><a class="header" href="#hypothetical-scenario">Hypothetical Scenario</a></h3>
<p>Lets say in a future version of Windows (ex: Windws 14) Microsoft decides to
update the <a href="development/../artifacts/windows/prefetch.html">prefech</a> file format. You want to
add support for this updated format in <code>artemis</code>. The process would be something
like:</p>
<ol>
<li>Create an issue describing what you want to do. Ex:
<code>Issue: Add support for Windows 14 Prefetch file</code></li>
<li>Clone the <code>artemis</code> source code</li>
<li>Create a new branch</li>
<li>Code and add the feature. Since this is related to Windows <code>prefetch</code> you
would probably be working in:
<br />
<code>artemis-core/src/artifacts/os/windows/prefetch/versions/&lt;prefetch version&gt;.rs</code></li>
<li>Add tests for any new functions you add</li>
<li>Add one (1) or more Windows 14 sample <code>prefetch</code> files to:
<br />
<code>artemis-core/tests/test_data/windows/prefetch/win14/</code></li>
<li>Run tests and verify results</li>
<li>Open pull request</li>
</ol>
<div style="break-before: page; page-break-before: always;"></div><h1 id="learning"><a class="header" href="#learning">Learning</a></h1>
<p>Some materials that may help you become a bit more familar with the <code>artemis</code>
code and logic.</p>
<ul>
<li><a href="https://github.com/rust-bakery/nom">Nom</a></li>
<li>Artifact format documentation from the <a href="https://github.com/libyal">libyal</a>
project</li>
<li><a href="https://github.com/denoland/deno">Deno</a>. See <code>runtime</code> and <code>core</code> for
examples on embedding <code>Deno</code></li>
<li>See the <a href="https://deno.com/runtime">Deno API</a> for examples and tutorials on
learning Deno</li>
</ul>
<p>Resources for learning Rust:</p>
<ul>
<li><a href="https://doc.rust-lang.org/rust-by-example/index.html">Rust by example</a></li>
<li>Official Rust <a href="https://doc.rust-lang.org/book/title-page.html">book</a></li>
</ul>
<h1 id="nom"><a class="header" href="#nom">Nom</a></h1>
<p>Nom is a very popular binary parsing library. <code>artemis</code> makes extensive use of
nom for parsing all different kinds of binary files. If nom did not exist
<code>artemis</code> would not exist. If you familarize yourself with nom and how it works
then the <code>artemis</code> code should be much easier to understand.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->


                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">

            </nav>

        </div>




        <script type="text/javascript">
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>

        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->

        <script type="text/javascript">
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>

    </body>
</html>
